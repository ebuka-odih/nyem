import{j as e,m as $,A as Z,u as Ve,a as be,b as ue}from"./vendor-framer-4X7OVNh1.js";import{r as c,u as Se,a as jt,R as je,b as yt}from"./vendor-react-BfM_owaC.js";import{L as vt,S as Nt,P as kt,a as Ne,T as lt,M as ce,X as we,I as St,b as He,A as ct,c as Ct,E as Pt,d as ye,C as pe,e as J,f as ot,g as ge,h as dt,i as ut,j as Et,k as It,l as Ye,m as _t,H as Ce,B as Me,n as Qe,o as he,Z as ne,p as xt,q as mt,r as Ge,s as zt,t as At,u as pt,v as $t,w as De,x as Je,y as Be,z as Ft,D as Lt,F as $e,G as Rt,J as qt,K as Ut,N as Wt,O as ve,Q as Tt,R as Ot,U as Mt,V as Dt,W as Bt,Y as Kt,_ as Vt,$ as Xe,a0 as Fe,a1 as Le,a2 as Ze,a3 as Re,a4 as qe,a5 as Ue,a6 as We,a7 as et,a8 as Ht,a9 as Ke,aa as Yt,ab as Qt,ac as Gt}from"./vendor-icons-Cnh11lZp.js";import{u as ee,a as re,b as X}from"./vendor-query-DeEM7L4V.js";const Jt=()=>{const t="https://api.nyem.online/backend/public/api";if(t.trim()!=="")return console.log("[API Config] Using VITE_API_BASE from environment:",t),t.trim();if(typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"||window.location.hostname==="0.0.0.0")){const n="http://localhost:8000/api";return console.log("[API Config] Development mode detected, using local URL:",n),n}const a="https://api.nyem.online/backend/public/api";return console.log("[API Config] Production mode, using production URL:",a),a},de=Jt();console.log("[API Config] Final API Base URL:",de);console.log("[API Config] Environment check:",{VITE_API_BASE:"https://api.nyem.online/backend/public/api",DEV:!1,MODE:"production",hostname:typeof window<"u"?window.location.hostname:"N/A"});let fe=!1,me=null;function ht(){fe=!1,me=null}function Xt(){const t=document.cookie.split(";");for(let s of t){const[a,n]=s.trim().split("=");if(a==="XSRF-TOKEN")return decodeURIComponent(n)}return null}async function tt(t=!1){if(t&&ht(),fe)return;if(me)return me;const s=new URL(de);if(!(s.hostname==="localhost"||s.hostname==="127.0.0.1"||s.hostname==="0.0.0.0")){console.log("[API] Skipping CSRF cookie fetch for production/cross-domain API"),fe=!0;return}const i=`${de.replace("/api","")}/sanctum/csrf-cookie`;return console.log("[API] Fetching CSRF cookie from:",i),me=fetch(i,{method:"GET",credentials:"include",headers:{Accept:"application/json"}}).then(l=>{l.ok?(console.log("[API] CSRF cookie fetched successfully"),fe=!0):(console.warn("[API] CSRF cookie fetch returned status:",l.status),fe=!1),me=null}).catch(l=>{console.warn("[API] Failed to fetch CSRF cookie:",l),fe=!1,me=null}),me}async function Pe(t,s={},a=!0){const{method:n="GET",body:i,token:l,headers:u={}}=s;["POST","PUT","DELETE","PATCH"].includes(n)&&await tt();const r={Accept:"application/json",...u},f=typeof FormData<"u"&&i instanceof FormData;!f&&i&&(r["Content-Type"]="application/json; charset=utf-8");const N=new URL(de),w=N.hostname==="localhost"||N.hostname==="127.0.0.1"||N.hostname==="0.0.0.0";if(w){const b=Xt();b&&["POST","PUT","DELETE","PATCH"].includes(n)&&(r["X-XSRF-TOKEN"]=b)}if(l?(r.Authorization=`Bearer ${l}`,console.log(`[apiFetch] Using token: ${l.substring(0,10)}...`)):console.log("[apiFetch] No token provided for this request"),!t||t==="undefined"||t==="null")throw console.error("[apiFetch] Invalid path provided:",t),new Error(`Invalid API endpoint path: ${t}. Please check that the endpoint is properly defined in constants/endpoints.ts`);const g=`${de}${t}`;console.log("[apiFetch]",n,g,w?"(localhost - CSRF enabled)":"(production - token auth only)");try{let b;i&&(f?b=i:b=JSON.stringify(i));const k=await fetch(g,{method:n,headers:r,body:b,credentials:w?"include":"omit"});let o={};const j=k.headers.get("content-type");if(j&&j.includes("application/json"))o=await k.json().catch(()=>({}));else{const y=await k.text().catch(()=>"");if(y)try{o=JSON.parse(y)}catch{o={message:y||`Server returned ${k.status}`}}}if(!k.ok){k.status===401&&l&&(console.warn("[apiFetch] Unauthorized - token may be invalid"),localStorage.removeItem("auth_token"),localStorage.removeItem("auth_user"));let y=(o==null?void 0:o.message)||(o==null?void 0:o.error)||`Request failed with status ${k.status}`;if(k.status===419){const C=new URL(de),v=C.hostname==="localhost"||C.hostname==="127.0.0.1"||C.hostname==="0.0.0.0";if(v&&(ht(),a&&["POST","PUT","DELETE","PATCH"].includes(n))){console.log("[apiFetch] 419 error - retrying with fresh CSRF cookie..."),await tt(!0);try{const d=await fetch(g,{method:n,headers:r,body:b,credentials:"include"});if(d.ok){const m=d.headers.get("content-type");let x={};if(m&&m.includes("application/json"))x=await d.json().catch(()=>({}));else{const S=await d.text().catch(()=>"");if(S)try{x=JSON.parse(S)}catch{x={message:S||`Server returned ${d.status}`}}}return console.log("[apiFetch] Retry successful after 419 error"),x}}catch(d){console.warn("[apiFetch] Retry after 419 error failed:",d)}}v?y="CSRF token mismatch (419). This usually means the session expired. Please try again.":y="CSRF token mismatch (419). The production API should use token-based authentication. Please check backend configuration."}else k.status===503?window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?y=`Backend server error (503). Please check: 1) Laravel backend is running (php artisan serve), 2) Database is configured and migrated, 3) Check backend logs for errors. API URL: ${g}`:y="Service temporarily unavailable (503). The backend server may be down or experiencing issues.":k.status===404?y=`API endpoint not found (404). Check that the route exists: ${g}`:k.status===500&&(y=(o==null?void 0:o.message)||(o==null?void 0:o.error)||"Server error (500). Check backend logs for details.");throw new Error(y)}return o}catch(b){if((b==null?void 0:b.message)&&(b.message.includes("Unauthenticated")||b.message.includes("Unauthorized"))&&!l||console.error("[apiFetch][error]",n,g,(b==null?void 0:b.message)||b),b.name==="TypeError"&&b.message==="Failed to fetch"){const o=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1";try{const j=new URL(de).hostname;throw o&&(j==="localhost"||j==="127.0.0.1")?new Error("Cannot connect to backend API. Please ensure: 1) Laravel backend is running (php artisan serve), 2) Backend is accessible at http://localhost:8000, 3) CORS is properly configured in backend/config/cors.php"):new Error(`Network error: Cannot reach API server at ${de}. Please check your internet connection or API server status.`)}catch{throw new Error("Network error: Cannot connect to API server. Please check that the backend is running and accessible.")}}throw b}}function xe(){return localStorage.getItem("auth_token")}function ia(t){localStorage.setItem("auth_token",t)}function la(){localStorage.removeItem("auth_token"),localStorage.removeItem("auth_user")}function Zt(){const t=localStorage.getItem("auth_user");if(!t)return null;try{return JSON.parse(t)}catch{return null}}function es(t){localStorage.setItem("auth_user",JSON.stringify(t))}const W=async(t,s={})=>{const a=xe(),n=await Pe(t,{...s,token:a});return n.data!==void 0?n.data:n.user!==void 0?n.user:n.listings!==void 0?n.listings:n.items!==void 0?n.items:n.requests!==void 0?n.requests:n.conversations!==void 0?n.conversations:n.messages!==void 0?n.messages:n},q={auth:{sendOtp:"/auth/send-otp",sendEmailOtp:"/auth/send-email-otp",verifyOtp:"/auth/verify-otp",verifyPhoneForSeller:"/auth/verify-phone-for-seller",login:"/auth/login",register:"/auth/register",google:"/auth/google",forgotPassword:"/auth/forgot-password",resetPassword:"/auth/reset-password"},profile:{me:"/profile/me",update:"/profile/update",updatePassword:"/profile/update-password",checkUsername:"/profile/check-username",updateOneSignalPlayerId:"/profile/onesignal-player-id",payments:"/profile/payments",getBanks:"/profile/banks",verifyBank:"/profile/verify-bank",show:t=>`/profile/${t}`},items:{feed:"/items/feed",create:"/posts",show:t=>`/items/${t}`,update:t=>`/items/${t}`,delete:t=>`/items/${t}`,trackView:t=>`/items/${t}/view`,trackShare:t=>`/items/${t}/share`},categories:"/categories",locations:"/locations",locationsCities:"/locations/cities",locationsAreas:t=>t?`/locations/cities/${t}/areas`:"/locations/areas",swipes:{create:"/swipes",pendingRequests:"/swipes/pending-requests",wishlist:"/swipes/wishlist"},tradeOffers:{pending:"/trade-offers/pending",respond:t=>`/trade-offers/${t}/respond`},messageRequests:{pending:"/message-requests/pending",respond:t=>`/message-requests/${t}/respond`},matches:{list:"/matches",show:t=>`/matches/${t}`},conversations:{list:"/conversations",start:"/conversations/start",messages:t=>`/conversations/${t}/messages`,matches:t=>`/conversations/${t}/matches`},messages:{create:"/messages"},reports:"/report",block:"/block",location:{update:"/location/update",nearby:"/location/nearby",status:"/location/status"},images:{upload:"/images/upload",uploadMultiple:"/images/upload-multiple",uploadBase64:"/images/upload-base64",uploadMultipleBase64:"/images/upload-multiple-base64"},serviceProviders:{feed:"/service-providers/feed",create:"/service-providers",me:"/service-providers/me"},notifications:{test:"/notifications/test",testMe:"/notifications/test/me"},reviews:{create:"/reviews",list:t=>`/users/${t}/reviews`},follow:{follow:t=>`/users/${t}/follow`,unfollow:t=>`/users/${t}/unfollow`,status:t=>`/users/${t}/follow-status`},escrows:{store:"/escrows",verifyPayment:t=>`/escrows/${t}/verify-payment`,acknowledge:t=>`/escrows/${t}/acknowledge`,complete:t=>`/escrows/${t}/complete`,confirm:t=>`/escrows/${t}/confirm`,dispute:t=>`/escrows/${t}/dispute`}},Ee=()=>{const t=xe();return ee({queryKey:["profile","me"],queryFn:()=>W(q.profile.me),enabled:!!t,select:s=>{var a;return s.user||((a=s.data)==null?void 0:a.user)||s}})},ts=()=>{const t=re();return X({mutationFn:s=>W(q.profile.update,{method:"PUT",body:s}),onSuccess:s=>{var n;const a=s.user||((n=s.data)==null?void 0:n.user)||s;a&&es(a),t.invalidateQueries({queryKey:["profile","me"]})}})},ss=()=>{const t=xe();return ee({queryKey:["profile","payments"],queryFn:()=>W(q.profile.payments),enabled:!!t})},as=()=>{const t=re();return X({mutationFn:s=>W(q.profile.payments,{method:"PUT",body:s}),onSuccess:()=>{t.invalidateQueries({queryKey:["profile","payments"]})}})},rs=()=>{const t=xe();return ee({queryKey:["profile","banks"],queryFn:()=>W(q.profile.getBanks),enabled:!!t,select:s=>s.banks||[]})},ns=()=>X({mutationFn:t=>W(q.profile.verifyBank,{method:"POST",body:t})}),is=()=>X({mutationFn:t=>W(q.profile.updatePassword,{method:"PUT",body:t})}),ft=c.createContext(void 0),ca=({children:t})=>{const{data:s}=Ee(),[a,n]=c.useState(!1),i=c.useRef(null),l=c.useRef(new Map),u=c.useCallback(()=>{var b;if(!(s!=null&&s.id)||((b=i.current)==null?void 0:b.readyState)===WebSocket.OPEN)return;const f=window.location.hostname,w=f==="localhost"||f==="127.0.0.1"||f.includes("192.168")?`ws://${f}:6002`:`wss://${f}/app/ws`;console.log("[WebSocket] Connecting to:",w);const g=new WebSocket(w);g.onopen=()=>{console.log("[WebSocket] Connected"),n(!0),g.send(JSON.stringify({type:"auth",userId:s.id}))},g.onmessage=k=>{try{const o=JSON.parse(k.data);console.log("[WebSocket] Raw Payload Received:",o);const{type:j,data:y}=o;if(j==="message.sent"){const C=y.conversation_id,v=`conversation.${C}`;console.log(`[WebSocket] Looking for subscribers on channel: ${v}`),console.log("[WebSocket] Current channels:",Array.from(l.current.keys()));const d=l.current.get(v);d&&d.size>0?(console.log(`[WebSocket] Notifying ${d.size} subscribers for conversation ${C}`),d.forEach(S=>S(y.message))):console.log(`[WebSocket] No active subscribers for conversation ${C}`);const m=`user.${s.id}`,x=l.current.get(m);x&&(console.log(`[WebSocket] Notifying subscriber on user channel: ${m}`),x.forEach(S=>S(o)))}else j==="auth_success"&&console.log("[WebSocket] Successfully authenticated with server")}catch(o){console.error("[WebSocket] Error processing message:",o)}},g.onclose=()=>{console.log("[WebSocket] Disconnected"),n(!1),i.current=null,setTimeout(u,3e3)},g.onerror=k=>{console.error("[WebSocket] Error:",k),g.close()},i.current=g},[s==null?void 0:s.id]);c.useEffect(()=>(u(),()=>{i.current&&i.current.close()}),[u]);const r=c.useCallback((f,N)=>{var w;return l.current.has(f)||l.current.set(f,new Set),(w=l.current.get(f))==null||w.add(N),()=>{const g=l.current.get(f);g&&(g.delete(N),g.size===0&&l.current.delete(f))}},[]);return e.jsx(ft.Provider,{value:{isConnected:a,subscribe:r},children:t})},gt=()=>{const t=c.useContext(ft);if(!t)throw new Error("useWebSocket must be used within a WebSocketProvider");return t},bt=(t="Shop")=>ee({queryKey:["categories",t],queryFn:()=>W(`${q.categories}?parent=${t}`),select:s=>{var a;return Array.isArray(s)?s:s&&typeof s=="object"?s.categories||((a=s.data)==null?void 0:a.categories)||s.data||[]:[]}}),wt=t=>{var u,r,f;const s=t.user||t.owner||{};let a=[];Array.isArray(t.images)&&t.images.length>0?a=t.images:Array.isArray(t.photos)&&t.photos.length>0?a=t.photos:Array.isArray(t.gallery)&&t.gallery.length>0?a=t.gallery:t.image&&(a=[t.image]);let n="Price on request";if(t.price)if(typeof t.price=="string"&&t.price.includes(","))n=t.price.includes("₦")?t.price:`₦${t.price}`;else{const N=typeof t.price=="string"?parseFloat(t.price.replace(/[₦,]/g,"")):t.price;isNaN(N)?n=`₦${t.price}`:n=`₦${N.toLocaleString("en-US")}`}else t.looking_for&&(n="Trade");let i="Unknown";t.distance_km!==null&&t.distance_km!==void 0?t.distance_km<1?i=`${Math.round(t.distance_km*1e3)}M`:i=`${t.distance_km.toFixed(1)}KM`:t.distance_display&&(i=t.distance_display.toUpperCase());const l=(u=t.owner)!=null&&u.location?t.owner.location:s.area?`${s.area}, ${s.city||t.city||"Unknown"}`:s.city||t.city||"Unknown";return{id:t.id,name:t.title||"Untitled Item",price:n,category:typeof t.category=="object"&&t.category!==null?t.category.name:t.category||"UNCATEGORIZED",description:t.description||"",longDescription:t.description||"",images:a.length>0?a:["https://images.unsplash.com/photo-1542496658-e33a6d0d50f6?w=800"],color:"#f3f4f6",distance:i,vendor:{id:s.id||t.user_id||((r=t.owner)==null?void 0:r.id),name:s.username||s.name||"Unknown Seller",avatar:s.profile_photo||s.image||"https://i.pravatar.cc/150?u=default",location:l,rating:0,reviewCount:0,followers:0,joinedDate:"2024",bio:"",verified:!!s.phone_verified_at,reviews:[]},isSuper:!1,userId:t.user_id||s.id||((f=t.owner)==null?void 0:f.id)||null,stats:{views:t.views||0,likes:t.likes||0,stars:t.stars||t.super_interest||0,super_interest:t.super_interest||t.stars||0,shares:t.shares||0}}},ls=()=>({id:`ad-${Date.now()}`,name:"Small Business Support",description:"Nyem empowers local artisans and micro-businesses. Join our community and shine together!",price:"PROMO",category:"COMMUNITY",images:["https://images.unsplash.com/photo-1542744094-24638eff58bb?w=800"],color:"#830e4c",longDescription:"",distance:"Local",vendor:{name:"Nyem Community",avatar:"https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?w=150",location:"Everywhere",rating:5,reviewCount:1e3,joinedDate:"2024",bio:"Supporting small businesses.",verified:!0,followers:1e4},isAd:!0}),cs=()=>({id:"welcome-card",name:"Welcome to Nyem",description:"Learn how to use Nyem to discover amazing local items.",price:"INFO",category:"ONBOARDING",images:[],color:"#830e4c",longDescription:"",distance:"System",vendor:{name:"Nyem Guide",avatar:"",location:"Local",rating:5,reviewCount:0,joinedDate:"2024",bio:"Your personal guide to Nyem.",verified:!0,followers:1e4},isWelcome:!0}),os=(t,s,a)=>{"Notification"in window&&Notification.permission==="granted"&&new Notification(t,{body:s,icon:a||"https://images.unsplash.com/photo-1614850523296-d8c1af93d400?auto=format&fit=crop&q=80&w=100"})},ds=t=>{const{activeTab:s,activeCategory:a,currentCity:n}=t;return ee({queryKey:["listings","feed",t],queryFn:()=>{const i=[];i.push("type=marketplace"),a!=="All"&&i.push(`category=${encodeURIComponent(a)}`),n==="All Locations"?(i.push("city=all"),i.push("ignore_city=true")):i.push(`city=${encodeURIComponent(n)}`);const l=`${q.items.feed}?${i.join("&")}`;return W(l)},enabled:s==="marketplace",select:i=>i.map(wt)})},us=()=>{const t=re();return X({mutationFn:s=>W(q.swipes.create,{method:"POST",body:s}),onSuccess:()=>{t.invalidateQueries({queryKey:["wishlist"]}),t.invalidateQueries({queryKey:["matches"]}),t.invalidateQueries({queryKey:["message-requests"]})}})},xs=()=>{const t=re();return X({mutationFn:s=>W(q.items.create,{method:"POST",body:s}),onSuccess:()=>{t.invalidateQueries({queryKey:["listings"]})}})},ms=()=>{const t=re();return X({mutationFn:({id:s,data:a})=>W(q.items.update(s),{method:"PUT",body:a}),onSuccess:()=>{t.invalidateQueries({queryKey:["listings"]}),t.invalidateQueries({queryKey:["profile","me"]})}})},ps=()=>{const t=re();return X({mutationFn:s=>W(q.items.delete(s),{method:"DELETE"}),onSuccess:()=>{t.invalidateQueries({queryKey:["listings"]}),t.invalidateQueries({queryKey:["profile","me"]})}})},hs=()=>X({mutationFn:t=>W(q.items.trackView(t),{method:"POST"})}),fs=()=>X({mutationFn:t=>W(q.items.trackShare(t),{method:"POST"})}),st={type:"spring",stiffness:400,damping:40,mass:1},oa=()=>{const[t,s]=c.useState("new"),[a,n]=c.useState(null),i=Se(),[l,u]=c.useState([]),[r,f]=c.useState(""),[N,w]=c.useState(""),[g,b]=c.useState(""),[k,o]=c.useState(""),[j,y]=c.useState(""),[C,v]=c.useState(null),{data:d=[],isLoading:m}=bt("Shop"),{data:x,isLoading:S,refetch:V}=Ee(),B=xs(),F=ms(),E=ps(),R=((x==null?void 0:x.listings)||(x==null?void 0:x.items)||[]).map(p=>({id:p.id,title:p.title||p.name||"Untitled",photos:p.photos||(p.image?[p.image]:[]),price:p.price,status:p.status||"active",category_id:p.category_id,condition:p.condition,description:p.description})),P=c.useRef(null),A=B.isPending||F.isPending,K=[{value:"new",label:"New"},{value:"like_new",label:"Like New"},{value:"used",label:"Used"},{value:"fair",label:"Fair"}],[D,M]=c.useState(!1);c.useEffect(()=>()=>{l.forEach(p=>{p.startsWith("blob:")&&URL.revokeObjectURL(p)})},[l]);const te=async p=>{const U=p.target.files;if(!U||U.length===0)return;if(l.length>=4){v("Maximum 4 images allowed");return}const h=4-l.length,_=Array.from(U).slice(0,h);_.length<U.length?v(`Only ${h} more images allowed. Selected first ${h}.`):v(null);const Q=_.map(G=>URL.createObjectURL(G)),le=l.length;u(G=>[...G,...Q]),P.current&&(P.current.value="");try{M(!0);const G=xe();if(!G){v("Please login to upload images"),M(!1);return}const _e=_.map(async(z,L)=>{const H=le+L,O=Q[L];try{if(z.size>10*1024*1024)throw new Error(`File ${z.name} is too large (max 10MB)`);const Y=new FormData;Y.append("image",z);const oe=await Pe(q.images.upload,{method:"POST",token:G,body:Y});if(!oe.url)throw new Error("Upload failed");u(ze=>{const Ae=[...ze];return Ae[H]===O&&(Ae[H]=oe.url,URL.revokeObjectURL(O)),Ae})}catch(Y){console.error(`Failed to upload image ${L}:`,Y),u(oe=>oe.filter(ze=>ze!==O)),URL.revokeObjectURL(O),v(`Failed to upload ${z.name}: ${Y.message}`)}});await Promise.all(_e)}catch(G){console.error("Batch upload error:",G)}finally{M(!1)}},I=p=>{u(U=>U.filter((h,_)=>_!==p))},T=p=>{n(p),f(p.title),w(p.description||""),u(p.photos||[]),b(p.category_id||""),o(p.condition||""),y(p.price?String(p.price).replace(/[₦,]/g,""):""),s("new"),window.scrollTo({top:0,behavior:"smooth"})},se=()=>{n(null),f(""),w(""),u([]),b(""),o(""),y(""),v(null)},ae=async()=>{if(!(x!=null&&x.city_id)&&!(x!=null&&x.city)){v("Please complete your profile (City & Area) before publishing");return}if(!r.trim()){v("Listing title is required");return}if(l.length===0){v("At least one image is required");return}if(!g){v("Category is required");return}if(!k){v("Condition is required");return}if(!j.trim()||parseFloat(j)<=0){v("Valid price is required");return}try{v(null);const p={title:r.trim(),description:N.trim()||null,category_id:Number(g),condition:k,photos:l,type:"marketplace",price:parseFloat(j)};a?(await F.mutateAsync({id:a.id,data:p}),s("collection"),se()):(await B.mutateAsync(p),s("collection"),se())}catch(p){console.error("Failed to submit listing:",p),v(p.message||"Failed to save listing. Please try again.")}},ie=async p=>{if(confirm("Are you sure you want to delete this listing?"))try{await E.mutateAsync(p)}catch(U){console.error("Failed to delete listing:",U),v(U.message||"Failed to delete listing. Please try again."),alert(U.message||"Failed to delete listing. Please try again.")}};return e.jsxs($.div,{initial:{opacity:0},animate:{opacity:1},className:"w-full flex flex-col gap-6",children:[C&&e.jsx("div",{className:"bg-rose-50 border border-rose-200 text-rose-700 px-4 py-3 rounded-2xl text-sm font-medium",children:C}),e.jsxs("div",{className:"flex bg-neutral-100 p-1 rounded-3xl shrink-0",children:[e.jsxs("button",{onClick:()=>s("collection"),className:`relative flex-1 py-3.5 flex items-center justify-center gap-2 rounded-2xl text-[10px] font-black uppercase tracking-[0.2em] transition-all ${t==="collection"?"bg-white text-[#830e4c] shadow-md":"text-neutral-400 hover:text-neutral-600"}`,children:[e.jsx(vt,{size:16,strokeWidth:t==="collection"?3:2}),"Your Collection"]}),e.jsxs("button",{onClick:()=>{s("new"),a||se()},className:`relative flex-1 py-3.5 flex items-center justify-center gap-2 rounded-2xl text-[10px] font-black uppercase tracking-[0.2em] transition-all ${t==="new"?"bg-white text-[#830e4c] shadow-md":"text-neutral-400 hover:text-neutral-600"}`,children:[e.jsx(Nt,{size:16,strokeWidth:t==="new"?3:2}),a?"Edit Drop":"New Drop"]})]}),e.jsx(Z,{mode:"wait",children:t==="collection"?e.jsxs($.div,{initial:{opacity:0,scale:.98},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.98},transition:st,className:"grid grid-cols-2 gap-4 pb-20",children:[e.jsxs("button",{onClick:()=>s("new"),className:"aspect-square bg-neutral-50 border-2 border-dashed border-neutral-200 rounded-[2.5rem] flex flex-col items-center justify-center gap-3 text-neutral-400 hover:border-[#830e4c33] hover:bg-[#830e4c1a]/30 transition-all group shadow-sm",children:[e.jsx("div",{className:"p-4 bg-white rounded-3xl shadow-sm border border-neutral-100 group-hover:scale-110 group-hover:rotate-90 transition-all duration-500",children:e.jsx(kt,{size:28,className:"text-neutral-400 group-hover:text-[#830e4c]",strokeWidth:3})}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest opacity-60",children:"Add New Drop"})]}),S?e.jsx("div",{className:"col-span-2 flex justify-center items-center py-12",children:e.jsx("div",{className:"w-8 h-8 border-4 border-[#830e4c] border-t-transparent rounded-full animate-spin"})}):R.map(p=>e.jsxs($.div,{layout:!0,className:"group relative aspect-square bg-white rounded-[2.5rem] overflow-hidden shadow-md border border-neutral-100",children:[p.photos&&p.photos.length>0&&e.jsx("img",{src:p.photos[0],className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-110",alt:p.title,onError:U=>{const h=U.target;h.style.display="none"}}),e.jsx("div",{className:"absolute top-4 left-4",children:e.jsx("span",{className:`px-2.5 py-1 rounded-lg text-[8px] font-black uppercase tracking-widest backdrop-blur-md shadow-sm border ${p.status==="active"?"bg-[#830e4c]/90":"bg-emerald-500/90"} text-white border-white/20`,children:p.status==="active"?"Active":p.status})}),e.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-all duration-300 backdrop-blur-[2px] flex flex-col items-center justify-center gap-3 p-4 text-center",children:[e.jsx("h4",{className:"text-white text-xs font-black uppercase tracking-widest truncate w-full px-2",children:p.title}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>T(p),className:"p-3 bg-white text-[#830e4c] rounded-2xl active:scale-90 shadow-xl",children:e.jsx(Ne,{size:18,strokeWidth:2.5})}),e.jsx("button",{onClick:()=>ie(p.id),className:"p-3 bg-rose-500 text-white rounded-2xl active:scale-90 shadow-xl",children:e.jsx(lt,{size:18,strokeWidth:2.5})})]})]})]},p.id)),!S&&R.length===0&&e.jsxs("div",{className:"col-span-2 flex flex-col items-center justify-center py-12 text-center",children:[e.jsx("p",{className:"text-sm font-medium text-neutral-400 mb-2",children:"No listings yet"}),e.jsx("p",{className:"text-xs text-neutral-300",children:"Create your first listing to get started"})]})]},"collection-grid"):e.jsx($.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},transition:st,className:"space-y-8 flex flex-col pb-32",children:!(x!=null&&x.city_id)&&!(x!=null&&x.city)?e.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-[2.5rem] p-7 text-center shadow-xl shadow-amber-900/5 mt-2",children:[e.jsx("div",{className:"w-14 h-14 bg-amber-100 rounded-[1.5rem] flex items-center justify-center mx-auto mb-4",children:e.jsx(ce,{size:24,className:"text-amber-600"})}),e.jsx("h4",{className:"text-sm font-black text-amber-900 uppercase tracking-[0.2em] mb-3 italic",children:"Complete Your Profile"}),e.jsxs("p",{className:"text-[11px] text-amber-700 font-medium leading-relaxed mb-6 px-4",children:["Buyers need to know where you're located! Please set your ",e.jsx("span",{className:"font-black text-amber-900",children:"City & Area"})," in settings before you can publish listings."]}),e.jsx("button",{onClick:()=>i("/profile"),className:"w-full bg-amber-600 text-white py-4 rounded-2xl text-[10px] font-black uppercase tracking-[0.3em] active:scale-95 transition-all shadow-lg shadow-amber-600/20",children:"Navigate to Settings"})]}):e.jsxs(e.Fragment,{children:[a&&e.jsxs("div",{className:"flex items-center justify-between bg-[#830e4c] rounded-[2rem] p-5 shadow-xl border border-white/10 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-4 overflow-hidden",children:[a.photos&&a.photos.length>0&&e.jsx("img",{src:a.photos[0],className:"w-12 h-12 rounded-2xl object-cover border border-white/20 shrink-0",alt:a.title,onError:p=>{const U=p.target;U.style.display="none"}}),e.jsxs("div",{className:"flex flex-col min-w-0",children:[e.jsx("span",{className:"text-[9px] font-black text-white/60 uppercase tracking-[0.2em]",children:"Editing Drop"}),e.jsx("h4",{className:"text-white text-xs font-black uppercase truncate tracking-tight",children:a.title})]})]}),e.jsx("button",{onClick:se,className:"p-2.5 bg-white/10 rounded-xl text-white hover:bg-white/20 transition-all active:scale-90 shrink-0",children:e.jsx(we,{size:18,strokeWidth:3})})]}),e.jsxs("div",{className:"space-y-4 shrink-0",children:[e.jsxs("div",{className:"flex justify-between items-end px-1",children:[e.jsx("label",{className:"text-[11px] font-black text-neutral-900 uppercase tracking-[0.2em]",children:"Product Imagery"}),e.jsxs("span",{className:"text-[9px] font-black text-neutral-400 uppercase tracking-widest",children:[l.length,"/4 Required"]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[l.map((p,U)=>{const h=p.startsWith("blob:");return e.jsxs($.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},className:"relative aspect-square rounded-2xl overflow-hidden border border-neutral-200 shadow-sm group",children:[e.jsx("img",{src:p,className:"w-full h-full object-cover",alt:`Upload ${U+1}`}),h&&e.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-[1px] flex items-center justify-center",children:e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"})}),e.jsx("button",{onClick:()=>{h&&URL.revokeObjectURL(p),I(U)},className:"absolute top-1 right-1 p-1 bg-black/60 text-white rounded-full backdrop-blur-md opacity-0 group-hover:opacity-100 transition-opacity z-10",children:e.jsx(we,{size:10,strokeWidth:3})})]},p)}),l.length<4&&e.jsx("button",{onClick:()=>{var p;return(p=P.current)==null?void 0:p.click()},disabled:D,className:`aspect-square rounded-2xl bg-white border-2 border-dashed border-neutral-200 flex flex-col items-center justify-center text-neutral-400 hover:text-[#830e4c] hover:border-[#830e4c33] hover:bg-[#830e4c1a]/30 transition-all active:scale-95 group shadow-sm ${D?"opacity-50 cursor-not-allowed":""}`,children:D?e.jsx("div",{className:"w-6 h-6 border-2 border-[#830e4c] border-t-transparent rounded-full animate-spin"}):e.jsx(St,{size:20,className:"group-hover:scale-110 transition-transform"})})]}),e.jsx("input",{ref:P,type:"file",accept:"image/*",multiple:!0,onChange:te,className:"hidden"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-neutral-500 uppercase tracking-widest px-1",children:"Listing Title"}),e.jsx("input",{type:"text",value:r,onChange:p=>f(p.target.value),placeholder:"e.g., iPhone 15 Pro Max",className:"w-full bg-white border border-neutral-300 rounded-[1.5rem] px-6 py-5 text-sm font-black text-neutral-900 focus:outline-none focus:border-[#830e4c] focus:ring-4 focus:ring-[#830e4c]/5 transition-all shadow-sm placeholder:text-neutral-200"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-neutral-500 uppercase tracking-widest px-1",children:"Description"}),e.jsx("textarea",{value:N,onChange:p=>w(p.target.value),placeholder:"Tell buyers why they need this...",rows:4,className:"w-full bg-white border border-neutral-300 rounded-[1.5rem] px-6 py-5 text-sm font-medium text-neutral-900 focus:outline-none focus:border-[#830e4c] focus:ring-4 focus:ring-[#830e4c]/5 transition-all shadow-sm placeholder:text-neutral-200 resize-none"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-neutral-500 uppercase tracking-widest px-1",children:"Category"}),e.jsxs("select",{value:g===""?"":String(g),onChange:p=>b(p.target.value?Number(p.target.value):""),disabled:m,className:"w-full bg-white border border-neutral-300 rounded-[1.5rem] px-6 py-5 text-[11px] font-black uppercase tracking-widest text-neutral-900 focus:outline-none focus:border-[#830e4c] focus:ring-4 focus:ring-[#830e4c]/5 transition-all shadow-sm disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("option",{value:"",children:"Select Category"}),Array.isArray(d)&&d.map(p=>e.jsx("option",{value:p.id,children:p.name},p.id))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-neutral-500 uppercase tracking-widest px-1",children:"Condition"}),e.jsxs("select",{value:k,onChange:p=>o(p.target.value),className:"w-full bg-white border border-neutral-300 rounded-[1.5rem] px-6 py-5 text-[11px] font-black uppercase tracking-widest text-neutral-900 focus:outline-none focus:border-[#830e4c] focus:ring-4 focus:ring-[#830e4c]/5 transition-all shadow-sm",children:[e.jsx("option",{value:"",children:"Item Condition"}),K.map(p=>e.jsx("option",{value:p.value,children:p.label},p.value))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-neutral-500 uppercase tracking-widest px-1",children:"Asking Price"}),e.jsxs("div",{className:"flex h-[62px] bg-white border border-neutral-300 rounded-[1.5rem] focus-within:border-[#830e4c] focus-within:ring-4 focus-within:ring-[#830e4c]/5 transition-all overflow-hidden shadow-sm items-stretch",children:[e.jsx("div",{className:"flex items-center justify-center pl-6 pr-3 border-r border-neutral-100 bg-neutral-50/30 shrink-0",children:e.jsx("span",{className:"text-[#830e4c] font-black text-lg",children:"₦"})}),e.jsx("input",{type:"number",value:j,onChange:p=>y(p.target.value),placeholder:"0.00",min:"0",step:"0.01",className:"w-full bg-transparent border-none px-4 py-0 text-sm font-black text-neutral-900 focus:ring-0 focus:outline-none placeholder:text-neutral-200"})]})]})]}),e.jsx("button",{onClick:ae,disabled:A||D,className:"w-full bg-[#830e4c] text-white py-6 rounded-[2rem] font-black uppercase tracking-[0.3em] text-[11px] shadow-xl active:scale-[0.98] transition-all flex items-center justify-center gap-3 shrink-0 disabled:opacity-50 disabled:cursor-not-allowed",children:A?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Submitting..."})]}):D?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Uploading Images..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(He,{size:16,className:"text-white/60"}),a?"Finalize Updates":"Publish to Marketplace"]})})]})},"new-drop-form")})]})},gs=()=>ee({queryKey:["conversations"],queryFn:()=>W(q.conversations.list),select:t=>{var s;return t.conversations||((s=t.data)==null?void 0:s.conversations)||t||[]}}),bs=()=>ee({queryKey:["message-requests"],queryFn:()=>W(q.messageRequests.pending),select:t=>{var s;return t.requests||((s=t.data)==null?void 0:s.requests)||t||[]}}),ws=()=>ee({queryKey:["trade-offers"],queryFn:()=>W(q.tradeOffers.pending),select:t=>{var s;return t.offers||((s=t.data)==null?void 0:s.offers)||t||[]}}),js=()=>{const t=re();return X({mutationFn:({id:s,decision:a})=>W(q.messageRequests.respond(s),{method:"POST",body:{decision:a}}),onSuccess:()=>{t.invalidateQueries({queryKey:["message-requests"]}),t.invalidateQueries({queryKey:["conversations"]})}})},ys=()=>{const t=re();return X({mutationFn:({id:s,decision:a})=>W(q.tradeOffers.respond(s),{method:"POST",body:{decision:a}}),onSuccess:()=>{t.invalidateQueries({queryKey:["trade-offers"]}),t.invalidateQueries({queryKey:["conversations"]}),t.invalidateQueries({queryKey:["matches"]})}})},vs=t=>ee({queryKey:["messages",t],queryFn:()=>W(q.conversations.messages(t)),enabled:!!t}),Ns=()=>{const t=re();return X({mutationFn:s=>W(q.messages.create,{method:"POST",body:s}),onSuccess:(s,a)=>{t.invalidateQueries({queryKey:["messages",a.conversation_id]}),t.invalidateQueries({queryKey:["conversations"]})}})},ks=t=>ee({queryKey:["conversation-listing",t],queryFn:async()=>{var a;const s=await W(q.conversations.matches(t));if(s!=null&&s.matches&&s.matches.length>0){const n=s.matches[0],i=n.my_listing||n.my_item||n.their_listing||n.their_item||n.listing1||n.listing2;if(i)return{id:i.id,title:i.title||"Unknown Listing",photo:((a=i.photos)==null?void 0:a[0])||i.photo||null,price:i.price}}return null},enabled:!!t,staleTime:300*1e3}),Ss=()=>{const t=re();return X({mutationFn:async s=>{const a=xe();if(!a)throw new Error("Authentication required");return await Pe(q.escrows.store,{method:"POST",token:a,body:s})},onSuccess:()=>{t.invalidateQueries({queryKey:["escrows"]})}})},at={type:"spring",stiffness:400,damping:40,mass:1};function Cs(t){return new Date(t).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}const Ps=({chat:t,currentUserId:s,onClose:a,onChatToggle:n})=>{const{data:i=[],isLoading:l,refetch:u}=vs(t.conversation_id),r=Ns(),f=Ss(),[N,w]=c.useState(""),[g,b]=c.useState(!1),[k,o]=c.useState(!1),[j,y]=c.useState(!1),[C,v]=c.useState(!1),[d,m]=c.useState(null),x=re(),{subscribe:S,isConnected:V}=gt(),B=c.useRef(null);c.useEffect(()=>{B.current=new Audio("https://assets.mixkit.co/active_storage/sfx/2354/2354-preview.mp3")},[]),c.useEffect(()=>{if(!t.conversation_id)return;console.log("[ChatView] Subscribing to conversation:",t.conversation_id);const I=S(`conversation.${t.conversation_id}`,T=>{var se;console.log(`[ChatView] WebSocket Callback Triggered for: conversation.${t.conversation_id}`),console.log("[ChatView] Message:",T),x.setQueryData(["messages",t.conversation_id],ae=>{const ie=Array.isArray(ae)?ae:[];return ie.some(U=>U.id&&U.id===T.id||U.message_id&&U.message_id===T.id)?(console.log("[ChatView] Duplicate message ignored"),ie):(console.log("[ChatView] Adding new message to state"),[...ie,T])}),String(T.sender_id)!==String(s)&&((se=B.current)==null||se.play().catch(ae=>console.warn("Sound play failed:",ae)))});return()=>{console.log("[ChatView] Unsubscribing from conversation:",t.conversation_id),I()}},[t.conversation_id,S,x,s]);const F=c.useRef(null),E=c.useRef(null),R=I=>I===s,P=t.other_user;c.useEffect(()=>{u()},[t.conversation_id]),c.useEffect(()=>{F.current&&i.length>0&&(F.current.scrollTop=F.current.scrollHeight)},[i]),c.useEffect(()=>{const I=T=>{E.current&&!E.current.contains(T.target)&&o(!1)};return document.addEventListener("mousedown",I),()=>document.removeEventListener("mousedown",I)},[]);const{data:A}=ks(t.conversation_id);c.useEffect(()=>{console.log("=== ChatView Listing Debug ==="),console.log("chat.listing_context:",t.listing_context),console.log("conversationListing:",A),console.log("Current chatListingInfo:",d);const I=t.listing_context||A;if(I){const T={title:I.title||"Unknown Listing",image:I.photo||null,price:I.price?`₦${Number(I.price).toLocaleString()}`:void 0,priceValue:I.price?Number(I.price):void 0};console.log("Setting new listing info:",T),m(T)}else console.log("No listing data available");console.log("=== End Debug ===")},[t.listing_context,A]);const K=async()=>{if(!(!N.trim()||r.isPending))try{await r.mutateAsync({conversation_id:t.conversation_id,message_text:N.trim(),receiver_id:P.id}),w("")}catch(I){console.error("Failed to send message:",I),alert(I.message||"Failed to send message. Please try again.")}},D=r.isPending,M=()=>{b(!1),o(!1),y(!1),a()},te=async()=>{if(!(d!=null&&d.priceValue)){alert("Price information not available");return}v(!0);try{const I=await f.mutateAsync({seller_id:P.id,amount:d.priceValue,description:`Purchase of ${d.title}`});console.log("Escrow created:",I),alert(`Escrow created! In production, you would be redirected to Paystack to complete payment of ₦${d.priceValue.toLocaleString()}`),y(!1)}catch(I){console.error("Failed to create escrow:",I),alert(I.message||"Failed to initiate secure checkout. Please try again.")}finally{v(!1)}};return e.jsxs($.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},transition:at,className:"fixed inset-0 bg-white z-[300] flex flex-col",children:[e.jsxs("header",{className:"shrink-0 bg-white border-b border-neutral-100 px-4 flex items-center justify-between",style:{paddingTop:"max(16px, env(safe-area-inset-top))",paddingBottom:"16px"},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:M,className:"p-2 -ml-1 text-[#830e4c] active:scale-95 transition-all",children:e.jsx(ct,{size:24,strokeWidth:2.5})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"relative",children:e.jsx("img",{src:P.profile_photo||`https://i.pravatar.cc/150?u=${P.id}`,className:"w-10 h-10 rounded-full object-cover border border-neutral-100",onError:I=>{const T=I.target;T.src=`https://i.pravatar.cc/150?u=${P.id}`}})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h3",{className:"text-sm font-black text-neutral-900 tracking-tight leading-none",children:P.name||P.username}),e.jsx("span",{className:"text-[10px] font-bold text-neutral-400 mt-1 uppercase tracking-widest",children:"Active recently"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-1 relative",ref:E,children:[e.jsx("button",{className:"p-2 text-neutral-400 hover:text-[#830e4c] transition-colors active:scale-90",children:e.jsx(Ct,{size:20})}),e.jsx("button",{onClick:()=>o(!k),className:`p-2 transition-all active:scale-90 ${k?"text-[#830e4c]":"text-neutral-400 hover:text-[#830e4c]"}`,children:e.jsx(Pt,{size:20})}),e.jsx(Z,{children:k&&e.jsxs($.div,{initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},className:"absolute top-full right-0 mt-2 w-56 bg-white border border-neutral-100 rounded-2xl shadow-2xl z-50 p-2 overflow-hidden",children:[e.jsxs("button",{onClick:()=>{b(!g),o(!1)},className:`w-full flex items-center gap-3 p-3 rounded-xl transition-all border-2 ${g?"bg-[#830e4c] border-[#830e4c] text-white shadow-lg":"bg-white border-neutral-50 hover:border-[#830e4c33] text-neutral-700 active:scale-95"}`,children:[e.jsx("div",{className:`p-1.5 rounded-lg transition-colors ${g?"bg-white/20 text-white":"bg-neutral-100 text-neutral-400"}`,children:e.jsx(ye,{size:18,strokeWidth:2.5})}),e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{className:`text-[11px] font-black uppercase tracking-widest leading-none ${g?"text-white":"text-neutral-900"}`,children:g?"Escrow Enabled":"Use Escrow"}),e.jsx("span",{className:`text-[8px] font-bold mt-1 uppercase tracking-wider ${g?"text-white/40":"text-neutral-400"}`,children:"Secure Protection"})]}),g?e.jsx(pe,{size:14,className:"ml-auto text-white",strokeWidth:4}):e.jsx(J,{size:14,className:"ml-auto text-neutral-200"})]}),e.jsx("div",{className:"h-px bg-neutral-50 my-1 mx-2"}),e.jsxs("button",{className:"w-full flex items-center gap-3 p-3 rounded-xl hover:bg-rose-50 text-rose-500 transition-all active:scale-95",children:[e.jsx("div",{className:"p-1.5 rounded-lg bg-rose-100/50 text-rose-500",children:e.jsx(ot,{size:16,strokeWidth:2.5})}),e.jsx("span",{className:"text-xs font-black uppercase tracking-widest",children:"Report Deal"})]})]})})]})]}),d&&e.jsxs("div",{className:"bg-white px-5 py-4 flex items-center justify-between border-b border-neutral-50 shadow-[0_4px_12px_rgba(0,0,0,0,02)] z-[5]",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[d.image&&e.jsx("img",{src:d.image,className:"w-12 h-12 rounded-[14px] object-cover border border-neutral-100 shadow-sm",onError:I=>{const T=I.target;T.style.display="none"}}),e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsx("span",{className:"text-[10px] font-black text-neutral-300 uppercase tracking-[0.1em]",children:"Regarding Item"}),e.jsx("span",{className:"text-[14px] font-black text-[#830e4c] truncate max-w-[180px] tracking-tight leading-tight",children:d.title})]})]}),e.jsx("button",{className:"px-5 py-2.5 bg-white border border-neutral-100 rounded-full text-[10px] font-black uppercase tracking-widest text-[#830e4c] shadow-sm active:scale-95 transition-all",children:"View Post"})]}),e.jsx(Z,{children:g&&(d==null?void 0:d.price)&&e.jsx($.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden bg-white border-b border-[#830e4c33]",children:e.jsx("div",{className:"p-4",children:e.jsxs("div",{onClick:()=>y(!0),className:"bg-[#830e4c] rounded-[1.5rem] p-4 flex items-center justify-between shadow-lg shadow-[#830e4c1a] cursor-pointer active:scale-[0.98] transition-all hover:bg-[#931e5c]",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-2xl bg-white/20 backdrop-blur-md flex items-center justify-center text-white",children:e.jsx(ge,{size:20,strokeWidth:2.5})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h4",{className:"text-xs font-black text-white uppercase tracking-widest leading-none",children:"Complete Secure Purchase"}),e.jsx("p",{className:"text-[9px] font-bold text-white/50 mt-1.5 uppercase tracking-wider",children:"Tap to checkout using Escrow"})]})]}),e.jsx("div",{className:"bg-white/10 p-2 rounded-xl text-white",children:e.jsx(J,{size:18,strokeWidth:3})})]})})})}),e.jsx("div",{ref:F,className:"flex-1 overflow-y-auto p-4 space-y-5 bg-white no-scrollbar",children:l?e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsx("div",{className:"w-8 h-8 border-4 border-[#830e4c] border-t-transparent rounded-full animate-spin"})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex justify-center mb-8 mt-4",children:e.jsx("span",{className:"px-8 py-2.5 bg-[#830e4c0d] rounded-full text-[10px] font-black text-[#830e4c] uppercase tracking-[0.15em] shadow-sm border border-[#830e4c10]",children:"Deal Conversation"})}),e.jsx(Z,{initial:!1,children:i.map(I=>{const T=R(I.sender_id);return e.jsx($.div,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},transition:at,className:`flex ${T?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:"flex flex-col max-w-[82%] gap-1",children:[e.jsx("div",{className:`px-5 py-3 rounded-[1.5rem] text-sm font-medium shadow-sm border ${T?"bg-[#830e4c] text-white border-[#830e4c] rounded-br-none":"bg-neutral-50 text-neutral-900 border-neutral-100 rounded-bl-none"}`,children:I.message_text}),e.jsxs("div",{className:`flex items-center gap-1.5 px-1 ${T?"justify-end":"justify-start"}`,children:[e.jsx("span",{className:"text-[8px] font-black text-neutral-300 uppercase tracking-widest",children:Cs(I.created_at)}),T&&e.jsx(dt,{size:10,className:"text-[#830e4c]"})]})]})},I.id)})}),i.length===0&&e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsx("p",{className:"text-sm font-medium text-neutral-400",children:"No messages yet. Start the conversation!"})})]})}),e.jsx(Z,{children:j&&(d==null?void 0:d.price)&&e.jsxs(e.Fragment,{children:[e.jsx($.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>y(!1),className:"absolute inset-0 bg-black/60 backdrop-blur-sm z-[400]"}),e.jsxs($.div,{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:200},className:"absolute bottom-0 left-0 right-0 bg-white rounded-t-[2.5rem] z-[410] p-6 pb-12 shadow-2xl",children:[e.jsx("div",{className:"w-12 h-1.5 bg-neutral-200 rounded-full mx-auto mb-8"}),e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl bg-[#830e4c1a] flex items-center justify-center text-[#830e4c]",children:e.jsx(ut,{size:32,strokeWidth:1.5})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-neutral-900 tracking-tighter uppercase leading-none",children:"Checkout Securely"}),e.jsx("p",{className:"text-xs font-bold text-[#830e4c] mt-2 uppercase tracking-widest",children:"Protected by Nyem Escrow"})]})]}),e.jsxs("div",{className:"space-y-4 bg-neutral-50 p-6 rounded-[2rem] border border-neutral-100 mb-8",children:[e.jsxs("div",{className:"flex justify-between items-center pb-4 border-b border-neutral-200",children:[e.jsx("span",{className:"text-sm font-black text-neutral-400 uppercase tracking-widest",children:"Item Price"}),e.jsx("span",{className:"text-base font-black text-neutral-900",children:d.price})]}),e.jsxs("div",{className:"flex justify-between items-center pb-4 border-b border-neutral-200",children:[e.jsx("span",{className:"text-sm font-black text-neutral-400 uppercase tracking-widest",children:"Escrow Fee"}),e.jsx("span",{className:"text-base font-black text-emerald-600",children:"FREE"})]}),e.jsxs("div",{className:"flex justify-between items-center pt-2",children:[e.jsx("span",{className:"text-base font-black text-neutral-900 uppercase tracking-widest",children:"Total Payable"}),e.jsx("span",{className:"text-2xl font-black text-[#830e4c]",children:d.price})]})]}),e.jsx("button",{onClick:te,disabled:C,className:"w-full bg-[#830e4c] text-white py-5 rounded-2xl font-black uppercase tracking-[0.2em] text-[11px] shadow-2xl active:scale-95 transition-all flex items-center justify-center gap-3 disabled:opacity-50 disabled:cursor-not-allowed",children:C?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Creating Escrow..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(ge,{size:16,strokeWidth:2.5}),"Confirm & Pay Securely"]})}),e.jsx("button",{onClick:()=>y(!1),className:"w-full py-4 text-[10px] font-black text-neutral-300 uppercase tracking-[0.2em] mt-2",children:"Go Back to Chat"})]})]})}),e.jsx("div",{className:"shrink-0 p-4 pb-10 bg-white border-t border-neutral-50",children:e.jsxs("div",{className:"flex items-center gap-2 bg-neutral-50 p-1.5 rounded-[2rem] border border-neutral-100 focus-within:border-[#830e4c]/30 focus-within:bg-white transition-all",children:[e.jsx("button",{className:"p-2.5 text-neutral-400 hover:text-[#830e4c] active:scale-95 transition-all",children:e.jsx(Et,{size:18})}),e.jsx("input",{type:"text",value:N,onChange:I=>w(I.target.value),onKeyDown:I=>I.key==="Enter"&&!I.shiftKey&&K(),placeholder:"Message...",disabled:D,className:"flex-1 bg-transparent border-none py-2 text-sm font-medium text-neutral-900 focus:ring-0 focus:outline-none placeholder:text-neutral-300 disabled:opacity-50"}),e.jsx("button",{className:"p-2.5 text-neutral-400 hover:text-[#830e4c] active:scale-95 transition-all",children:e.jsx(It,{size:18})}),e.jsx("button",{onClick:K,disabled:!N.trim()||D,className:`p-2.5 rounded-full transition-all active:scale-95 ${N.trim()&&!D?"bg-[#830e4c] text-white shadow-lg":"bg-neutral-200 text-neutral-400"}`,children:e.jsx(He,{size:16})})]})})]})},Es={type:"spring",stiffness:400,damping:40,mass:1};function Is(t){const s=new Date(t),a=new Date,n=Math.floor((a.getTime()-s.getTime())/1e3);if(n<60)return"Just now";const i=Math.floor(n/60);if(i<60)return`${i}m ago`;const l=Math.floor(i/60);if(l<24)return`${l}h ago`;const u=Math.floor(l/24);return u<7?`${u}d ago`:s.toLocaleDateString("en-US",{month:"short",day:"numeric",year:s.getFullYear()!==a.getFullYear()?"numeric":void 0})}const _s=({chats:t,currentUserId:s,onChatClick:a})=>e.jsxs($.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:Es,className:"space-y-1",children:[t.map(n=>{var l;const i=n.other_user;return n.last_message&&n.last_message.sender_id,e.jsxs($.div,{layout:!0,onClick:()=>a(n),className:"flex items-center gap-4 p-4 hover:bg-[#830e4c1a]/20 rounded-[2rem] transition-colors cursor-pointer group",children:[e.jsx("div",{className:"relative flex-shrink-0",children:e.jsx("img",{src:i.profile_photo||`https://i.pravatar.cc/150?u=${i.id}`,className:"w-16 h-16 rounded-[1.5rem] object-cover border border-neutral-100",onError:u=>{const r=u.target;r.src=`https://i.pravatar.cc/150?u=${i.id}`}})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("h4",{className:"text-base font-black text-neutral-900 truncate tracking-tight",children:i.name||i.username}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-neutral-300",children:n.updated_at?Is(n.updated_at):"Recently"})]}),e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsx("p",{className:"text-sm line-clamp-1 pr-4 text-neutral-400 font-medium",children:((l=n.last_message)==null?void 0:l.message_text)||"No messages yet"}),e.jsx(dt,{size:14,className:"text-neutral-200 flex-shrink-0"})]})]})]},n.id)}),t.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-24 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-neutral-50 rounded-full flex items-center justify-center mb-4",children:e.jsx(Ye,{size:24,className:"text-neutral-200"})}),e.jsx("h4",{className:"text-sm font-black text-neutral-900 uppercase",children:"No active chats"}),e.jsx("p",{className:"text-[10px] font-bold text-neutral-400 uppercase tracking-widest mt-1",children:"Accept requests to start a deal"})]})]}),Te={type:"spring",stiffness:400,damping:40,mass:1};function zs(t){const s=new Date(t),a=new Date,n=Math.floor((a.getTime()-s.getTime())/1e3);if(n<60)return"Just now";const i=Math.floor(n/60);if(i<60)return`${i}m ago`;const l=Math.floor(i/60);if(l<24)return`${l}h ago`;const u=Math.floor(l/24);return u<7?`${u}d ago`:s.toLocaleDateString("en-US",{month:"short",day:"numeric",year:s.getFullYear()!==a.getFullYear()?"numeric":void 0})}const As=({requests:t,tradeOffers:s,onRequestAccepted:a,onRequestDeclined:n,onChatOpen:i})=>{const[l,u]=c.useState(null),[r,f]=c.useState(""),N=js(),w=ys(),g=async(o,j)=>{try{j==="request"?await N.mutateAsync({id:o,decision:"decline"}):await w.mutateAsync({id:o,decision:"decline"}),n==null||n(o)}catch(y){console.error("Failed to decline:",y),alert("Failed to decline. Please try again.")}},b=async(o,j)=>{var y,C,v,d,m,x;try{const S=j==="request"?await N.mutateAsync({id:o,decision:"accept"}):await w.mutateAsync({id:o,decision:"accept"});if(u(null),f(""),(C=(y=S==null?void 0:S.data)==null?void 0:y.conversation)!=null&&C.id||(v=S==null?void 0:S.conversation)!=null&&v.id){const V=((m=(d=S==null?void 0:S.data)==null?void 0:d.conversation)==null?void 0:m.id)||((x=S==null?void 0:S.conversation)==null?void 0:x.id);i==null||i(V)}a()}catch(S){console.error("Failed to accept:",S),alert("Failed to accept. Please try again."),u(null)}},k=[...t.map(o=>({...o,type:"request"})),...s.map(o=>({...o,type:"trade"}))].sort((o,j)=>new Date(j.created_at).getTime()-new Date(o.created_at).getTime());return e.jsxs($.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:Te,className:"space-y-4",children:[k.map(o=>{const j=o.type==="trade",y=o.from_user,C=j?o.target_item:o.listing||o.item,v=j?o.offered_item:null;return e.jsxs($.div,{layout:!0,initial:{opacity:0,scale:.98},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.98},transition:Te,className:`bg-white border rounded-[2rem] p-5 flex flex-col gap-4 shadow-sm transition-all ${l===o.id?"border-[#830e4c] ring-4 ring-[#830e4c1a]":"border-neutral-100"}`,children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative flex-shrink-0",children:[e.jsx("img",{src:y.photo||`https://i.pravatar.cc/150?u=${y.id}`,className:"w-14 h-14 rounded-2xl object-cover border border-neutral-100",onError:d=>{const m=d.target;m.src=`https://i.pravatar.cc/150?u=${y.id}`}}),e.jsx("div",{className:`absolute -bottom-1 -right-1 w-6 h-6 rounded-full flex items-center justify-center border-2 border-white text-white ${j?"bg-amber-500":"bg-indigo-500"}`,children:j?e.jsx(_t,{size:10,strokeWidth:3}):e.jsx(Ye,{size:10,strokeWidth:3})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"text-base font-black text-neutral-900 truncate tracking-tight",children:y.name||y.username}),e.jsx("span",{className:"text-[10px] font-bold text-neutral-300 tracking-widest uppercase",children:zs(o.created_at)})]}),e.jsxs("p",{className:"text-xs font-medium text-neutral-400 truncate",children:[j?"Proposed a trade for your ":"Interested in your ",e.jsx("span",{className:"font-bold text-neutral-800",children:(C==null?void 0:C.title)||"Listing"})]})]}),(C==null?void 0:C.photo)&&e.jsx("img",{src:C.photo,className:"w-14 h-14 rounded-2xl object-cover border border-neutral-50 grayscale-[0.3]",onError:d=>{const m=d.target;m.style.display="none"}})]}),j&&v&&e.jsxs("div",{className:"bg-amber-50/50 p-4 rounded-2xl border border-amber-100 flex items-center gap-4",children:[e.jsx("img",{src:v.photo,className:"w-12 h-12 rounded-xl object-cover border border-amber-200",onError:d=>{const m=d.target;m.style.display="none"}}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-amber-600 uppercase tracking-widest leading-none mb-1",children:"Offered Item"}),e.jsx("p",{className:"text-sm font-bold text-neutral-900",children:v.title})]})]}),o.message_text&&e.jsxs("div",{className:"bg-neutral-50 p-4 rounded-2xl border border-neutral-100 italic text-xs text-neutral-600 font-medium leading-relaxed",children:['"',o.message_text,'"']}),e.jsx(Z,{children:l===o.id?e.jsxs($.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},transition:Te,className:"space-y-3 pt-1",children:[e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{autoFocus:!0,value:r,onChange:d=>f(d.target.value),placeholder:j?"Accept this trade...":"Add a friendly reply...",className:"w-full bg-white border border-neutral-200 rounded-2xl px-4 py-4 text-sm font-medium text-neutral-900 focus:outline-none focus:border-[#830e4c] transition-all resize-none min-h-[110px] placeholder:text-neutral-300"}),e.jsx("button",{onClick:()=>b(o.id,o.type),className:"absolute bottom-3 right-3 p-3 bg-[#830e4c] text-white rounded-xl shadow-lg active:scale-95 transition-all",children:e.jsx(He,{size:18})})]}),e.jsx("button",{onClick:()=>u(null),className:"w-full py-2 text-[10px] font-black uppercase tracking-widest text-neutral-300 hover:text-[#830e4c] transition-colors",children:"Cancel"})]}):e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>g(o.id,o.type),className:"flex-1 bg-white hover:bg-rose-50 hover:text-rose-500 text-neutral-400 py-3.5 rounded-2xl flex items-center justify-center gap-2 transition-all active:scale-95 border border-neutral-100 hover:border-rose-100",children:[e.jsx(we,{size:16,strokeWidth:3}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Decline"})]}),e.jsxs("button",{onClick:()=>u(o.id),className:`flex-[2] text-white py-3.5 rounded-2xl flex items-center justify-center gap-2 shadow-lg active:scale-95 transition-all border ${j?"bg-amber-600 border-amber-600":"bg-[#830e4c] border-[#830e4c]"}`,children:[e.jsx(pe,{size:16,strokeWidth:3,className:"text-white/60"}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:j?"Accept Trade":"Accept Request"})]})]})})]},o.id)}),k.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-neutral-50 rounded-full flex items-center justify-center mb-6",children:e.jsx(Ce,{size:24,className:"text-neutral-200"})}),e.jsx("h4",{className:"text-sm font-black text-neutral-900 uppercase",children:"Inbox Clean"}),e.jsx("p",{className:"text-[10px] font-bold text-neutral-400 uppercase tracking-widest mt-1",children:"No new requests or trade offers"})]})]})},$s=({isOpen:t,onClose:s,onSuccess:a})=>{const[n,i]=c.useState(!1),[l,u]=c.useState(null),[r,f]=c.useState("prompt"),N=async()=>{var g,b,k,o,j,y;try{i(!0),u(null),f("processing");const C=xe();if(!C){u("Please login first"),i(!1),f("prompt");return}if(!("Notification"in window)){u("Your browser does not support notifications"),i(!1),f("prompt");return}let v=Notification.permission;if(v==="default"&&(v=await Notification.requestPermission()),v!=="granted"){u("Notification permission was denied. Please enable it in your browser settings."),i(!1),f("prompt");return}let d=null;if(window.OneSignalReady?d=await window.OneSignalReady:window.OneSignal?d=window.OneSignal:window.OneSignalDeferred&&(d=await new Promise(m=>{window.OneSignalDeferred.push(x=>{m(x)})})),!d){u("OneSignal is not loaded. Please refresh the page and try again."),i(!1),f("prompt");return}try{(g=d.User)!=null&&g.PushSubscription?!(d.User.PushSubscription.optedIn??!1)&&d.User.PushSubscription.optIn&&await d.User.PushSubscription.optIn():d.Notifications&&typeof d.Notifications.requestPermission=="function"&&await d.Notifications.requestPermission(),await new Promise(x=>setTimeout(x,1e3));let m=null;if((k=(b=d.User)==null?void 0:b.PushSubscription)!=null&&k.id?m=d.User.PushSubscription.id:typeof d.getUserId=="function"?m=await d.getUserId():(o=d.User)!=null&&o.id&&(m=d.User.id),m||(await new Promise(x=>setTimeout(x,2e3)),(y=(j=d.User)==null?void 0:j.PushSubscription)!=null&&y.id?m=d.User.PushSubscription.id:typeof d.getUserId=="function"&&(m=await d.getUserId())),!m){u("Unable to get notification ID. Please try refreshing the page."),i(!1),f("prompt");return}try{await Pe(q.profile.updateOneSignalPlayerId,{method:"POST",token:C,body:{onesignal_player_id:m}})}catch(x){console.warn("Failed to register player ID (may already be registered):",x)}f("success"),setTimeout(()=>{a(m),s()},1500)}catch(m){console.error("OneSignal subscription error:",m),u("Failed to enable notifications: "+((m==null?void 0:m.message)||"Unknown error")),i(!1),f("prompt")}}catch(C){console.error("Notification permission error:",C),u((C==null?void 0:C.message)||"Failed to enable notifications. Please try again."),i(!1),f("prompt")}},w=()=>{s()};return t?e.jsx(Z,{children:e.jsx($.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[500] flex items-center justify-center p-4",onClick:g=>{g.target===g.currentTarget&&r!=="processing"&&w()},children:e.jsx($.div,{initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},className:"bg-white rounded-[2.5rem] p-8 max-w-md w-full shadow-2xl",children:r==="success"?e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-2xl flex items-center justify-center mx-auto mb-6",children:e.jsx(pe,{size:32,className:"text-emerald-600",strokeWidth:2.5})}),e.jsx("h2",{className:"text-2xl font-black text-neutral-900 tracking-tight mb-3",children:"Notifications Enabled! 🎉"}),e.jsx("p",{className:"text-sm text-neutral-600 leading-relaxed",children:"You'll now receive push notifications from Nyem."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("div",{className:"w-16 h-16 bg-indigo-100 rounded-2xl flex items-center justify-center",children:e.jsx(Me,{size:32,className:"text-indigo-600",strokeWidth:2.5})}),r!=="processing"&&e.jsx("button",{onClick:w,className:"p-2 text-neutral-400 hover:text-neutral-900 transition-colors",children:e.jsx(we,{size:20})})]}),e.jsx("h2",{className:"text-2xl font-black text-neutral-900 tracking-tight mb-3",children:"Enable Push Notifications"}),e.jsx("p",{className:"text-sm text-neutral-600 leading-relaxed mb-6",children:"Get notified about new matches, messages, and important updates! We'll ask for your permission to send notifications."}),l&&e.jsx("div",{className:"bg-rose-50 border border-rose-200 text-rose-700 px-4 py-3 rounded-xl text-sm mb-4",children:l}),r==="processing"?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"w-8 h-8 border-4 border-indigo-600 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:N,disabled:n,className:"w-full bg-indigo-600 text-white py-4 rounded-full font-black uppercase tracking-widest text-xs shadow-xl active:scale-95 transition-all flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(Me,{size:16}),"Enable Notifications"]}),e.jsx("button",{onClick:w,disabled:n,className:"w-full bg-white border-2 border-neutral-200 text-neutral-600 py-4 rounded-full font-black uppercase tracking-widest text-xs active:scale-95 transition-all hover:border-neutral-400 disabled:opacity-50",children:"Maybe Later"})]})]})})})}):null},Fs={type:"spring",stiffness:400,damping:40,mass:1},da=({onChatToggle:t})=>{const{id:s}=jt(),a=Se(),[n,i]=c.useState("chats"),{data:l=[],isLoading:u,refetch:r}=gs(),{data:f=[],isLoading:N,refetch:w}=bs(),{data:g=[],isLoading:b,refetch:k}=ws(),[o,j]=c.useState(null),[y,C]=c.useState(!1),v=c.useRef(null),{data:d}=Ee();c.useEffect(()=>{d!=null&&d.id&&(v.current=d.id)},[d]);const m=re(),{subscribe:x}=gt();c.useEffect(()=>{if(!(d!=null&&d.id))return;const A=x(`user.${d.id}`,K=>{console.log("[MatchesPage] WebSocket event received:",K),m.invalidateQueries({queryKey:["conversations"]})});return()=>A()},[d==null?void 0:d.id,x,m]),c.useEffect(()=>{if(s&&l.length>0&&!o){const A=l.find(K=>K.conversation_id===s||K.id===s);A&&(j(A),t==null||t(!0))}},[s,l,o,t]);const S=u||N,V=async()=>{await r(),await w(),await k(),i("chats")},B=A=>{w()},F=A=>{j(A),t==null||t(!0)},E=()=>{j(null),t==null||t(!1),s&&a("/matches"),r()},R=A=>{const K=l.find(D=>D.conversation_id===A||D.id===A);K?F(K):r().then(()=>{const D=l.find(M=>M.conversation_id===A||M.id===A);D&&F(D)})},P=async A=>{r()};return o?e.jsx(Ps,{chat:o,currentUserId:v.current,onClose:E,onChatToggle:t}):e.jsxs($.div,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},transition:Fs,className:"w-full max-w-2xl mx-auto flex flex-col pb-40",children:[e.jsxs("div",{className:"flex px-4 gap-4 mb-6 mt-2",children:[e.jsx("button",{onClick:()=>i("chats"),className:`relative px-8 py-2.5 rounded-full text-xs font-black uppercase tracking-widest transition-all ${n==="chats"?"bg-[#830e4c] text-white shadow-lg":"bg-white text-neutral-400 border border-neutral-100"}`,children:"Chats"}),e.jsxs("button",{onClick:()=>i("requests"),className:`relative px-8 py-2.5 rounded-full text-xs font-black uppercase tracking-widest transition-all ${n==="requests"?"bg-[#830e4c] text-white shadow-lg":"bg-white text-neutral-400 border border-neutral-100"}`,children:["Requests",f.length+g.length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-[#830e4c] text-white text-[9px] flex items-center justify-center rounded-full border-2 border-white font-black",children:f.length+g.length})]})]}),e.jsx($s,{isOpen:y,onClose:()=>C(!1),onSuccess:P}),e.jsx("div",{className:"px-4",children:S?e.jsx("div",{className:"flex justify-center items-center py-24",children:e.jsx("div",{className:"w-8 h-8 border-4 border-[#830e4c] border-t-transparent rounded-full animate-spin"})}):e.jsx(Z,{mode:"wait",children:n==="chats"?e.jsx(_s,{chats:l,currentUserId:v.current,onChatClick:F},"chats-list"):e.jsx(As,{requests:f,tradeOffers:g,onRequestAccepted:V,onRequestDeclined:B,onChatOpen:R},"requests-list")})})]})},Ls=()=>ee({queryKey:["locations","cities"],queryFn:()=>W(q.locationsCities),select:t=>{var s;return t.cities||((s=t.data)==null?void 0:s.cities)||t}}),Rs=t=>ee({queryKey:["locations","areas",t],queryFn:()=>W(q.locationsAreas(t)),enabled:!!t,select:s=>{var a;return s.areas||((a=s.data)==null?void 0:a.areas)||s}}),rt={type:"spring",stiffness:400,damping:40,mass:1},ke=({active:t,onClick:s})=>e.jsx("button",{onClick:a=>{a.stopPropagation(),s()},className:`w-12 h-6 rounded-full relative flex items-center px-1 transition-colors duration-300 ${t?"bg-[#830e4c]":"bg-neutral-200"}`,children:e.jsx($.div,{animate:{x:t?24:0},transition:{type:"spring",stiffness:500,damping:30},className:"w-4 h-4 bg-white rounded-full shadow-md"})}),qs=()=>{var E,R;const{data:t,isLoading:s}=ss(),{data:a=[],isLoading:n}=rs(),i=ns(),l=as(),[u,r]=c.useState(!1),[f,N]=c.useState(""),[w,g]=c.useState(""),[b,k]=c.useState(""),[o,j]=c.useState(null),[y,C]=c.useState(!1),[v,d]=c.useState(!1),[m,x]=c.useState(!1);c.useEffect(()=>{t&&(r(t.escrow_enabled),t.bank_details?(g(t.bank_details.account_number||""),k(t.bank_details.account_name||""),t.bank_details.account_number||x(!0)):x(!0))},[t]);const S=je.useMemo(()=>{const P=a.find(A=>A.code===f);return P?P.name:""},[f,a]);c.useEffect(()=>{var P;if((P=t==null?void 0:t.bank_details)!=null&&P.bank_name&&a.length>0&&!f){const A=a.find(K=>K.name===t.bank_details.bank_name);A&&(N(A.code),d(!0))}},[t,a,f]);const V=async()=>{if(!(!f||w.length<10)){C(!0),j(null),k(""),d(!1);try{const P=await i.mutateAsync({account_number:w,bank_code:f});k(P.account_name),d(!0)}catch{j("Could not verify account. Please check details."),d(!1)}finally{C(!1)}}},B=async()=>{var P,A;if(u&&!v){j("Please verify your bank account before enabling escrow.");return}try{await l.mutateAsync({escrow_enabled:u,bank_name:S||((P=t==null?void 0:t.bank_details)==null?void 0:P.bank_name),account_number:w,account_name:b||((A=t==null?void 0:t.bank_details)==null?void 0:A.account_name)}),x(!1)}catch(K){console.error(K)}};if(s)return e.jsx("div",{className:"p-8 text-center text-neutral-400 text-xs font-black uppercase tracking-widest",children:"Loading settings..."});const F=((E=t==null?void 0:t.bank_details)==null?void 0:E.account_number)&&((R=t==null?void 0:t.bank_details)==null?void 0:R.bank_name);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Escrow Status"}),e.jsxs("div",{onClick:()=>v&&r(!u),className:`p-6 rounded-[2.5rem] border-2 transition-all cursor-pointer ${u?"bg-emerald-50 border-emerald-500 shadow-xl shadow-emerald-100":"bg-white border-neutral-100 shadow-sm"} ${v?"":"opacity-50 cursor-not-allowed"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:`p-3 rounded-2xl ${u?"bg-emerald-500 text-white":"bg-neutral-100 text-neutral-400"}`,children:e.jsx(Lt,{size:24,strokeWidth:2.5})}),e.jsx(ke,{active:u,onClick:()=>v&&r(!u)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h4",{className:`text-base font-black uppercase tracking-tight ${u?"text-emerald-900":"text-neutral-900"}`,children:u?"Escrow Protection Active":"Escrow Protection Disabled"}),e.jsx("p",{className:`text-[10px] font-bold uppercase tracking-widest leading-relaxed ${u?"text-emerald-600":"text-neutral-400"}`,children:u?"Your deals are secured by Nyem Escrow. Funds are held until buyers confirm delivery.":"Activate escrow to build trust and protect your transactions from disputes. You must add a verified bank account first."})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between px-1",children:[e.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest",children:"Withdrawal Destination"}),!m&&F&&e.jsxs("button",{onClick:()=>x(!0),className:"text-[10px] font-black text-[#830e4c] uppercase tracking-widest flex items-center gap-1.5",children:[e.jsx(Ne,{size:12,strokeWidth:2.5})," Edit Details"]}),m&&F&&e.jsx("button",{onClick:()=>x(!1),className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest",children:"Cancel"})]}),!m&&F?e.jsxs("div",{className:"bg-white border border-neutral-100 rounded-[2.5rem] p-8 shadow-sm relative overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-[0.03] pointer-events-none group-hover:scale-110 transition-transform duration-500",children:e.jsx($e,{size:120})}),e.jsxs("div",{className:"space-y-6 relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-neutral-50 rounded-2xl flex items-center justify-center text-[#830e4c]",children:e.jsx($e,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] font-black text-neutral-400 uppercase tracking-[0.2em] mb-0.5",children:"Bank Name"}),e.jsx("h4",{className:"text-base font-black text-neutral-900 uppercase tracking-tight",children:t.bank_details.bank_name})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] font-black text-neutral-400 uppercase tracking-[0.2em] mb-1",children:"Account Number"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl font-black text-neutral-900 tracking-[0.1em]",children:t.bank_details.account_number}),e.jsx(xt,{size:18,className:"text-emerald-500"})]})]}),e.jsxs("div",{className:"pt-4 border-t border-neutral-50",children:[e.jsx("p",{className:"text-[9px] font-black text-neutral-400 uppercase tracking-[0.2em] mb-1",children:"Verified Account Name"}),e.jsx("h5",{className:"text-sm font-black text-neutral-900 uppercase",children:t.bank_details.account_name})]})]})]})]}):e.jsxs("div",{className:"bg-white border border-neutral-100 rounded-[2.5rem] p-6 shadow-sm space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest flex items-center gap-2",children:[e.jsx($e,{size:12})," Bank Name"]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:f,onChange:P=>{N(P.target.value),d(!1)},className:"w-full bg-neutral-50 border border-neutral-100 rounded-xl px-4 py-3 text-sm font-bold text-neutral-900 focus:outline-none focus:border-[#830e4c] transition-all appearance-none",disabled:n,children:[e.jsx("option",{value:"",children:"Select Bank"}),a.map(P=>e.jsx("option",{value:P.code,children:P.name},P.code))]}),e.jsx(De,{className:"absolute right-4 top-1/2 -translate-y-1/2 text-neutral-300 pointer-events-none",size:16})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest flex items-center gap-2",children:[e.jsx(mt,{size:12})," Account Number"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:w,onChange:P=>{g(P.target.value.replace(/\D/g,"")),d(!1)},maxLength:10,placeholder:"0123456789",className:"flex-1 bg-neutral-50 border border-neutral-100 rounded-xl px-4 py-3 text-sm font-bold text-neutral-900 focus:outline-none focus:border-[#830e4c] transition-all placeholder:text-neutral-300 tracking-widest"}),e.jsx("button",{onClick:V,disabled:!f||w.length<10||y,className:"bg-neutral-900 text-white px-6 rounded-xl text-[10px] font-black uppercase tracking-widest disabled:opacity-50 disabled:cursor-not-allowed",children:y?"...":"Verify"})]})]}),(b||o)&&e.jsx("div",{className:`p-4 rounded-2xl ${o?"bg-red-50 text-red-600":"bg-emerald-50 text-emerald-700"} flex items-center gap-3`,children:o?e.jsxs(e.Fragment,{children:[e.jsx(ot,{size:18}),e.jsx("span",{className:"text-xs font-bold",children:o})]}):e.jsxs(e.Fragment,{children:[e.jsx(pt,{size:18}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] font-black uppercase tracking-widest opacity-70",children:"Verified Name"}),e.jsx("p",{className:"text-sm font-black uppercase",children:b})]})]})}),m&&e.jsxs("button",{onClick:B,disabled:l.isPending||!v,className:"w-full bg-[#830e4c] text-white py-6 rounded-[2rem] font-black uppercase tracking-[0.25em] text-[11px] shadow-xl active:scale-95 transition-all flex items-center justify-center gap-3 disabled:opacity-50 disabled:cursor-not-allowed mt-4",children:[e.jsx(Rt,{size:16,strokeWidth:2.5}),l.isPending?"Saving...":"Save Payment Settings"]})]})]})]})},Us=()=>{const t=is(),[s,a]=c.useState(""),[n,i]=c.useState(""),[l,u]=c.useState(""),[r,f]=c.useState(!1),[N,w]=c.useState(!1),[g,b]=c.useState(null),k=async o=>{if(o.preventDefault(),b(null),n!==l){b({type:"error",message:"New passwords do not match"});return}try{await t.mutateAsync({current_password:s,new_password:n,new_password_confirmation:l}),b({type:"success",message:"Password updated successfully"}),a(""),i(""),u("")}catch(j){b({type:"error",message:j.message||"Failed to update password"})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Change Password"}),e.jsxs("form",{onSubmit:k,className:"bg-white border border-neutral-100 rounded-[2rem] p-6 space-y-5 shadow-sm",children:[g&&e.jsx("div",{className:`p-4 rounded-xl text-xs font-bold ${g.type==="success"?"bg-emerald-50 text-emerald-700":"bg-red-50 text-red-700"}`,children:g.message}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest flex items-center gap-2",children:[e.jsx(ge,{size:12})," Current Password"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:r?"text":"password",value:s,onChange:o=>a(o.target.value),className:"w-full bg-neutral-50 border border-neutral-100 rounded-xl px-4 py-3 text-sm font-bold text-neutral-900 focus:outline-none focus:border-[#830e4c] transition-all",required:!0}),e.jsx("button",{type:"button",onClick:()=>f(!r),className:"absolute right-3 top-1/2 -translate-y-1/2 text-neutral-300",children:r?e.jsx(Je,{size:16}):e.jsx(Be,{size:16})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest flex items-center gap-2",children:[e.jsx(ge,{size:12})," New Password"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:N?"text":"password",value:n,onChange:o=>i(o.target.value),className:"w-full bg-neutral-50 border border-neutral-100 rounded-xl px-4 py-3 text-sm font-bold text-neutral-900 focus:outline-none focus:border-[#830e4c] transition-all",required:!0,minLength:6}),e.jsx("button",{type:"button",onClick:()=>w(!N),className:"absolute right-3 top-1/2 -translate-y-1/2 text-neutral-300",children:N?e.jsx(Je,{size:16}):e.jsx(Be,{size:16})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest flex items-center gap-2",children:[e.jsx(ge,{size:12})," Confirm New Password"]}),e.jsx("input",{type:"password",value:l,onChange:o=>u(o.target.value),className:"w-full bg-neutral-50 border border-neutral-100 rounded-xl px-4 py-3 text-sm font-bold text-neutral-900 focus:outline-none focus:border-[#830e4c] transition-all",required:!0})]}),e.jsx("button",{type:"submit",disabled:t.isPending,className:"w-full bg-[#830e4c] text-white py-4 rounded-xl font-black uppercase tracking-widest text-[10px] shadow-lg active:scale-95 transition-all disabled:opacity-50",children:t.isPending?"Updating...":"Update Password"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Security Options"}),e.jsxs("div",{className:"bg-white border border-neutral-100 rounded-[2rem] p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between opacity-40",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-neutral-100 text-neutral-400 rounded-2xl",children:e.jsx(Ft,{size:22})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-black text-neutral-900 tracking-tight",children:"Two-Factor Auth"}),e.jsx("p",{className:"text-[9px] font-black text-neutral-300 uppercase tracking-widest mt-1",children:"Coming Soon"})]})]}),e.jsx(ke,{active:!1,onClick:()=>{}})]}),e.jsx("div",{className:"h-px bg-neutral-50"}),e.jsxs("div",{className:"flex items-center justify-between opacity-40",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-neutral-100 text-neutral-400 rounded-2xl",children:e.jsx(ge,{size:22})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-black text-neutral-900 tracking-tight",children:"Biometric Login"}),e.jsx("p",{className:"text-[9px] font-black text-neutral-300 uppercase tracking-widest mt-1",children:"Coming Soon"})]})]}),e.jsx(ke,{active:!1,onClick:()=>{}})]})]})]})]})},ua=({forceSettingsTab:t,onSignOut:s,onNavigateToUpload:a})=>{var ie,p,U;const[n,i]=c.useState("drops"),[l,u]=c.useState("main"),{data:r,isLoading:f,refetch:N}=Ee(),w=ts(),{data:g=[],isLoading:b}=Ls(),k=c.useRef(null),[o,j]=c.useState({push:!0}),[y,C]=c.useState(""),[v,d]=c.useState(""),[m,x]=c.useState(""),[S,V]=c.useState(""),[B,F]=c.useState(null),[E,R]=c.useState(null),{data:P=[],isLoading:A}=Rs(v),K=w.isPending,D=je.useMemo(()=>r?(r.items||r.listings||[]).filter(_=>_.status==="active").slice(0,5).map(_=>{const le=(_.photos||[])[0]||'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="300" height="300"%3E%3Crect fill="%23f3f4f6" width="300" height="300"/%3E%3Ctext fill="%239ca3af" font-family="sans-serif" font-size="16" x="50%25" y="50%25" text-anchor="middle" dy=".3em"%3ENo Image%3C/text%3E%3C/svg%3E';let G="Price not set";return _.price&&(typeof _.price=="string"?G=_.price.includes("₦")?_.price:`₦${_.price}`:G=`₦${parseFloat(_.price).toLocaleString()}`),{id:_.id,name:_.title||"Untitled Item",price:G,image:le,views:_.views_count||_.views||0,status:_.status==="active"?"Active":"Sold"}}):[],[r]);c.useEffect(()=>{t&&(i("settings"),u("main"))},[t]),c.useEffect(()=>{r&&l==="edit"&&(C(r.name||r.username||""),d(r.city_id||""),x(r.area_id||""),V(r.bio||""),F(r.profile_photo||null))},[r,l]);const M=()=>{var h;(h=k.current)==null||h.click()},te=h=>{var Q;const _=(Q=h.target.files)==null?void 0:Q[0];if(_){if(_.size>2*1024*1024){R("Image must be less than 2MB");return}if(!_.type.startsWith("image/")){R("Please select a valid image file");return}const le=new FileReader;le.onloadend=()=>{F(le.result),R(null)},le.onerror=()=>{R("Failed to read image file")},le.readAsDataURL(_)}k.current&&(k.current.value="")},I=[{label:"Deals",value:"24",icon:Qe},{label:"Rating",value:"4.9",icon:he},{label:"Drops",value:((ie=r==null?void 0:r.items_count)==null?void 0:ie.toString())||"0",icon:ne}],T=[{id:"edit",label:"Edit Profile",icon:Ne,color:"text-[#830e4c]"},{id:"notifications",label:"Notification Settings",icon:Me,color:"text-[#830e4c]"},{id:"payments",label:"Escrow & Payments",icon:mt,color:"text-emerald-600"},{id:"security",label:"Security & Password",icon:ye,color:"text-neutral-900"},{id:"history",label:"Trade History",icon:Ge,color:"text-neutral-900"}],se=async()=>{if(R(null),!y.trim()){R("Display name is required");return}if(!v){R("City is required");return}try{const h={name:y.trim(),city_id:typeof v=="number"?v:parseInt(v),bio:S||void 0};m&&m!==""&&!isNaN(Number(m))?h.area_id=typeof m=="number"?m:parseInt(m):h.area_id=null,B&&B!==(r==null?void 0:r.profile_photo)&&B.startsWith("data:image/")&&(h.profile_photo=B),await w.mutateAsync(h),u("main")}catch(h){R(h.message||"Failed to update profile. Please try again."),console.error("Update profile error:",h)}},ae=()=>{switch(l){case"edit":return e.jsxs("div",{className:"space-y-6",children:[E&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:E}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{ref:k,type:"file",accept:"image/*",onChange:te,className:"hidden"}),e.jsx("div",{className:"w-28 h-28 rounded-[2.5rem] bg-[#830e4c1a] border-4 border-white shadow-xl overflow-hidden",children:B?e.jsx("img",{src:B,className:"w-full h-full object-cover",alt:"Profile",onError:h=>{const _=h.target;_.src=`https://i.pravatar.cc/300?u=${(r==null?void 0:r.id)||(r==null?void 0:r.email)||"user"}`}}):r!=null&&r.profile_photo?e.jsx("img",{src:r.profile_photo,className:"w-full h-full object-cover",alt:"Profile",onError:h=>{const _=h.target;_.src=`https://i.pravatar.cc/300?u=${r.id||r.email||"user"}`}}):e.jsx("img",{src:`https://i.pravatar.cc/300?u=${(r==null?void 0:r.id)||(r==null?void 0:r.email)||(r==null?void 0:r.username)||"user"}`,className:"w-full h-full object-cover",alt:"Profile"})}),e.jsx("button",{type:"button",className:"absolute -bottom-1 -right-1 bg-[#830e4c] text-white p-2.5 rounded-2xl shadow-lg border border-white active:scale-90 transition-all",onClick:M,children:e.jsx($t,{size:16,strokeWidth:2.5})})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-neutral-500 uppercase tracking-widest px-1",children:"Display Name *"}),e.jsx("input",{type:"text",value:y,onChange:h=>C(h.target.value),placeholder:"Your display name",className:"w-full bg-white border border-neutral-200 rounded-[1.5rem] px-6 py-5 text-sm font-black text-neutral-900 focus:outline-none focus:border-[#830e4c] transition-all shadow-sm placeholder:text-neutral-200"}),e.jsx("p",{className:"text-[9px] font-bold text-neutral-400 uppercase tracking-widest px-1",children:"This is how your name appears to others"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-[10px] font-black text-neutral-500 uppercase tracking-widest px-1 flex items-center gap-2",children:[e.jsx(ce,{size:12}),"City *"]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:v,onChange:h=>d(h.target.value?parseInt(h.target.value):""),disabled:b,className:"w-full bg-white border border-neutral-200 rounded-[1.5rem] px-6 py-5 text-sm font-black text-neutral-900 focus:outline-none focus:border-indigo-600 transition-all shadow-sm appearance-none cursor-pointer disabled:opacity-50",children:[e.jsx("option",{value:"",children:"Select your city"}),g.map(h=>e.jsx("option",{value:h.id,children:h.name},h.id))]}),e.jsx(De,{className:"absolute right-6 top-1/2 -translate-y-1/2 text-neutral-300 pointer-events-none",size:18})]}),b&&e.jsx("p",{className:"text-[9px] font-bold text-neutral-400 uppercase tracking-widest px-1",children:"Loading cities..."})]}),v&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-[10px] font-black text-neutral-500 uppercase tracking-widest px-1 flex items-center gap-2",children:[e.jsx(ce,{size:12}),"Area ",P.length>0?"(Optional)":""]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:m,onChange:h=>x(h.target.value?parseInt(h.target.value):""),disabled:A||P.length===0,className:"w-full bg-white border border-neutral-200 rounded-[1.5rem] px-6 py-5 text-sm font-black text-neutral-900 focus:outline-none focus:border-[#830e4c] transition-all shadow-sm appearance-none cursor-pointer disabled:opacity-50",children:[e.jsx("option",{value:"",children:"Select your area (optional)"}),P.map(h=>e.jsx("option",{value:h.id,children:h.name},h.id))]}),e.jsx(De,{className:"absolute right-6 top-1/2 -translate-y-1/2 text-neutral-300 pointer-events-none",size:18})]}),A&&e.jsx("p",{className:"text-[9px] font-bold text-neutral-400 uppercase tracking-widest px-1",children:"Loading areas..."}),!A&&P.length===0&&v&&e.jsx("p",{className:"text-[9px] font-bold text-neutral-400 uppercase tracking-widest px-1",children:"No areas available for this city"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-neutral-500 uppercase tracking-widest px-1",children:"Bio"}),e.jsx("textarea",{value:S,onChange:h=>V(h.target.value),placeholder:"Tell us about yourself...",className:"w-full bg-white border border-neutral-200 rounded-[1.5rem] px-6 py-5 text-sm font-black text-neutral-900 focus:outline-none focus:border-[#830e4c] transition-all shadow-sm resize-none min-h-[120px] placeholder:text-neutral-200"})]}),e.jsx("button",{onClick:se,disabled:K,className:"w-full bg-[#830e4c] text-white py-6 rounded-[2rem] font-black uppercase tracking-[0.25em] text-[11px] shadow-xl active:scale-95 transition-all flex items-center justify-center gap-3 disabled:opacity-50 disabled:cursor-not-allowed",children:K?"Saving...":"Save Changes"})]});case"notifications":return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-white border border-neutral-100 rounded-[2rem] p-6 space-y-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h4",{className:"text-sm font-black text-neutral-900 uppercase tracking-tight",children:"Push Notifications"}),e.jsx("p",{className:"text-[10px] font-bold text-neutral-400 uppercase tracking-widest mt-1",children:"Chat messages and system alerts"})]}),e.jsx(ke,{active:o.push,onClick:()=>j({...o,push:!o.push})})]})}),e.jsxs("div",{className:"p-5 bg-[#830e4c1a] rounded-3xl border border-[#830e4c33] flex gap-4 items-start",children:[e.jsx(ne,{size:18,className:"text-[#830e4c] shrink-0 mt-0.5"}),e.jsx("p",{className:"text-[10px] font-bold text-[#830e4c] uppercase tracking-widest leading-relaxed",children:"Stay updated on the latest drops in your area by enabling location-based alerts in your phone settings."})]})]});case"payments":return e.jsx(qs,{});case"security":return e.jsx(Us,{});case"history":return e.jsxs("div",{className:"space-y-4",children:[[{id:"1",item:"Nike Air Max",price:"₦125,000",date:"Oct 12, 2023",type:"PURCHASE",img:"https://images.unsplash.com/photo-1542291026-7eec264c27ff?auto=format&fit=crop&q=80&w=100"},{id:"2",item:"Sony WH-1000XM5",price:"₦340,000",date:"Sep 28, 2023",type:"SALE",img:"https://images.unsplash.com/photo-1505740420928-5e560c06d30e?auto=format&fit=crop&q=80&w=100"},{id:"3",item:"Coffee Grinder",price:"₦45,000",date:"Sep 15, 2023",type:"PURCHASE",img:"https://images.unsplash.com/photo-1544350285-1811bc3bb970?auto=format&fit=crop&q=80&w=100"}].map(h=>e.jsxs("div",{className:"bg-white border border-neutral-100 rounded-[2.5rem] p-4 flex items-center gap-4 hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl overflow-hidden border border-neutral-100 shrink-0",children:e.jsx("img",{src:h.img,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:`text-[8px] font-black px-2 py-0.5 rounded-full w-fit mb-1 ${h.type==="SALE"?"bg-[#830e4c1a] text-[#830e4c]":"bg-emerald-50 text-emerald-600"}`,children:h.type}),e.jsx("h4",{className:"text-sm font-black text-neutral-900 tracking-tight uppercase truncate",children:h.item})]}),e.jsx("span",{className:"text-xs font-black text-neutral-900",children:h.price})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-1.5",children:[e.jsxs("p",{className:"text-[9px] font-bold text-neutral-300 uppercase tracking-widest flex items-center gap-1",children:[e.jsx(At,{size:10})," ",h.date]}),e.jsxs("span",{className:"text-[9px] font-black text-emerald-600 uppercase tracking-widest flex items-center gap-1",children:[e.jsx(pt,{size:10})," Completed"]})]})]}),e.jsx("button",{className:"p-2 text-neutral-200 hover:text-neutral-900 transition-colors",children:e.jsx(J,{size:18,strokeWidth:3})})]},h.id)),e.jsxs("button",{className:"w-full py-5 text-[10px] font-black text-neutral-300 uppercase tracking-[0.25em] mt-4 flex items-center justify-center gap-2",children:[e.jsx(Ge,{size:14})," Request Transaction Export"]})]});default:return null}};return f&&!r?e.jsxs($.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:rt,className:"w-full max-w-2xl mx-auto flex flex-col items-center justify-center pb-48 px-4 min-h-[400px]",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-[#830e4c] border-t-transparent rounded-full animate-spin"}),e.jsx("p",{className:"mt-4 text-sm font-black text-neutral-400 uppercase tracking-widest",children:"Loading profile..."})]}):e.jsx($.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:rt,className:"w-full max-w-2xl mx-auto flex flex-col pb-48 px-4",children:e.jsx(Z,{mode:"wait",children:l==="main"?e.jsxs($.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},className:"w-full",children:[e.jsxs("div",{className:"flex flex-col items-center pt-8 pb-10",children:[e.jsxs("div",{className:"relative mb-6",children:[e.jsx("div",{className:"w-28 h-28 rounded-[2.5rem] bg-[#830e4c1a] border-4 border-white shadow-xl overflow-hidden",children:r!=null&&r.profile_photo?e.jsx("img",{src:r.profile_photo,className:"w-full h-full object-cover",alt:"Profile",onError:h=>{const _=h.target;_.src=`https://i.pravatar.cc/300?u=${r.id||r.email||"user"}`}}):e.jsx("img",{src:`https://i.pravatar.cc/300?u=${(r==null?void 0:r.id)||(r==null?void 0:r.email)||(r==null?void 0:r.username)||"user"}`,className:"w-full h-full object-cover",alt:"Profile"})}),e.jsx("button",{className:"absolute -bottom-1 -right-1 bg-white p-2.5 rounded-2xl shadow-lg border border-neutral-100 text-[#830e4c] active:scale-90 transition-all",children:e.jsx(Ne,{size:16,strokeWidth:2.5})})]}),e.jsxs("div",{className:"text-center space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("h2",{className:"text-2xl font-black text-neutral-900 tracking-tighter uppercase italic",children:f?"Loading...":(r==null?void 0:r.name)||(r==null?void 0:r.username)||"User"}),(r==null?void 0:r.email_verified_at)&&e.jsx(xt,{size:20,className:"text-[#29B3F0]",fill:"currentColor"})]}),e.jsxs("p",{className:"text-xs font-black text-neutral-400 uppercase tracking-[0.2em] flex items-center justify-center gap-1.5",children:[e.jsx(ce,{size:12})," ",((p=r==null?void 0:r.cityLocation)==null?void 0:p.name)||(r==null?void 0:r.city)||"Location not set"]}),(r==null?void 0:r.bio)&&e.jsx("p",{className:"text-xs font-medium text-neutral-500 mt-2 max-w-xs",children:r.bio})]})]}),e.jsx("div",{className:"grid grid-cols-3 gap-3 mb-8",children:I.map(h=>e.jsxs("div",{className:"bg-white border border-neutral-100 rounded-3xl p-4 flex flex-col items-center text-center",children:[e.jsx(h.icon,{size:18,className:"text-neutral-400 mb-2"}),e.jsx("span",{className:"text-lg font-black text-neutral-900 leading-none",children:h.value}),e.jsx("span",{className:"text-[8px] font-black text-neutral-300 uppercase tracking-widest mt-1.5",children:h.label})]},h.label))}),e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsx("button",{onClick:()=>i("drops"),className:`relative px-8 py-2.5 rounded-full text-xs font-black uppercase tracking-widest transition-all ${n==="drops"?"bg-[#830e4c] text-white shadow-lg":"bg-white text-neutral-400 border border-neutral-100"}`,children:"My Listings"}),e.jsx("button",{onClick:()=>i("settings"),className:`relative px-8 py-2.5 rounded-full text-xs font-black uppercase tracking-widest transition-all ${n==="settings"?"bg-[#830e4c] text-white shadow-lg":"bg-white text-neutral-400 border border-neutral-100"}`,children:"Account"})]}),e.jsx(Z,{mode:"wait",children:n==="drops"?e.jsx($.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},className:"space-y-3",children:D.length>0?e.jsxs(e.Fragment,{children:[D.map(h=>e.jsxs("div",{className:"bg-white border border-neutral-100 rounded-[2rem] p-3 flex items-center gap-4 group",children:[e.jsx("div",{className:"w-20 h-20 rounded-2xl overflow-hidden border border-neutral-100",children:e.jsx("img",{src:h.image,className:"w-full h-full object-cover",alt:h.name,onError:_=>{const Q=_.target;Q.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="300" height="300"%3E%3Crect fill="%23f3f4f6" width="300" height="300"/%3E%3Ctext fill="%239ca3af" font-family="sans-serif" font-size="16" x="50%25" y="50%25" text-anchor="middle" dy=".3em"%3ENo Image%3C/text%3E%3C/svg%3E'}})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[e.jsx("span",{className:`text-[8px] font-black uppercase tracking-widest px-2 py-0.5 rounded-full ${h.status==="Active"?"bg-[#830e4c1a] text-[#830e4c]":"bg-neutral-100 text-neutral-400"}`,children:h.status}),e.jsxs("span",{className:"text-[8px] font-black text-neutral-300 uppercase tracking-widest",children:[h.views," Views"]})]}),e.jsx("h4",{className:"text-sm font-black text-neutral-900 truncate tracking-tight",children:h.name}),e.jsx("p",{className:"text-xs font-black text-[#830e4c] mt-0.5",children:h.price})]}),e.jsx("button",{className:"p-3 text-neutral-300 hover:text-neutral-900 transition-colors",children:e.jsx(J,{size:20,strokeWidth:3})})]},h.id)),e.jsxs("button",{onClick:()=>{a&&a()},className:"w-full py-6 border-2 border-dashed border-neutral-100 rounded-[2rem] flex flex-col items-center justify-center gap-2 text-neutral-300 hover:border-[#830e4c1a] hover:text-[#830e4c] transition-all group",children:[e.jsx(ne,{size:24,className:"group-hover:scale-110 transition-transform"}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Post a new drop"})]})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 space-y-4",children:[e.jsx("div",{className:"w-20 h-20 rounded-full bg-neutral-50 flex items-center justify-center border border-neutral-100",children:e.jsx(Qe,{size:32,className:"text-neutral-300"})}),e.jsxs("div",{className:"text-center space-y-1",children:[e.jsx("h4",{className:"text-base font-black text-neutral-900 uppercase tracking-tighter",children:"No drops yet"}),e.jsx("p",{className:"text-[10px] font-bold text-neutral-400 uppercase tracking-widest",children:"Start sharing your items with the community!"})]}),e.jsxs("button",{onClick:()=>{a&&a()},className:"w-full py-6 border-2 border-dashed border-neutral-100 rounded-[2rem] flex flex-col items-center justify-center gap-2 text-neutral-300 hover:border-[#830e4c1a] hover:text-[#830e4c] transition-all group",children:[e.jsx(ne,{size:24,className:"group-hover:scale-110 transition-transform"}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Post a new drop"})]})]})},"drops-list"):e.jsxs($.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},className:"space-y-2 pb-24",children:[T.map(h=>e.jsxs("button",{onClick:()=>u(h.id),className:"w-full flex items-center justify-between p-4 bg-white border border-neutral-100 rounded-[1.5rem] hover:bg-neutral-50 active:scale-[0.99] transition-all",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-2.5 bg-neutral-50 rounded-xl ${h.color}`,children:e.jsx(h.icon,{size:20,strokeWidth:2.5})}),e.jsx("span",{className:"text-sm font-black text-neutral-900 tracking-tight",children:h.label})]}),e.jsx(J,{size:18,className:"text-neutral-200",strokeWidth:3})]},h.label)),e.jsx("button",{onClick:()=>{s&&s()},className:"w-full flex items-center justify-between p-4 bg-rose-50 border border-rose-100 rounded-[1.5rem] mt-6 hover:bg-rose-100 active:scale-[0.98] transition-all",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2.5 bg-white rounded-xl text-rose-500 shadow-sm",children:e.jsx(zt,{size:20,strokeWidth:2.5})}),e.jsx("span",{className:"text-sm font-black text-rose-600 tracking-tight",children:"Sign Out"})]})})]},"settings-list")})]},"main-profile"):e.jsxs($.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:-10},className:"w-full",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-8 pt-4",children:[e.jsx("button",{onClick:()=>u("main"),className:"p-3 bg-neutral-100 rounded-2xl text-neutral-900 active:scale-90 transition-all",children:e.jsx(ct,{size:20,strokeWidth:3})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[9px] font-black text-[#830e4c] uppercase tracking-[0.2em] leading-none mb-1",children:"Account Setting"}),e.jsx("h3",{className:"text-xl font-black text-neutral-900 tracking-tighter uppercase italic",children:((U=T.find(h=>h.id===l))==null?void 0:U.label)||"Settings"})]})]}),e.jsx("div",{className:"pb-32",children:ae()})]},"sub-page")})})},Oe=$.div,Ws=({product:t,onSwipe:s,isTop:a,index:n,triggerDirection:i,onShowDetail:l})=>{const u=Ve(),r=Se(),f=be(0),N=be(0),w=ue(f,[-200,200],[-10,10]),g=ue(f,[-150,0,150],[.5,1,.5]),[b,k]=c.useState(0),o=c.useRef(null),j=c.useRef(null),y=c.useRef(!1),C=Zt(),v=C&&t.userId&&String(C.id)===String(t.userId),d=t.stats||{};je.useEffect(()=>{if(a)i?i==="right"?u.start({x:800,opacity:0,transition:{duration:.2,ease:"easeOut"}}).then(()=>s("right")):i==="left"?u.start({x:-800,opacity:0,transition:{duration:.2,ease:"easeOut"}}).then(()=>s("left")):i==="up"&&u.start({y:-1e3,opacity:0,transition:{duration:.2,ease:"easeOut"}}).then(()=>s("up")):u.start({scale:1,x:0,y:0,opacity:1,transition:{type:"spring",stiffness:500,damping:30}});else{const F=Math.min(n*8,16),E=1-Math.min(n*.04,.08);u.start({scale:E,y:F,x:0,opacity:n>2?0:1-n*.15,transition:{type:"spring",stiffness:500,damping:35}})}},[a,n,i,u,s]);const m=(F,E)=>{a&&(j.current={x:E.point.x,y:E.point.y},y.current=!1)},x=(F,E)=>{if(!a||!j.current)return;const R=Math.abs(E.point.x-j.current.x),P=Math.abs(E.point.y-j.current.y);if(R>10&&R>P*1.3)y.current||(y.current=!0,o.current&&(o.current.style.overflowY="hidden")),f.set(E.offset.x);else if(P>R)return},S=(F,E)=>{if(!a)return;if(o.current&&(o.current.style.overflowY="auto",o.current.style.touchAction=""),!y.current){j.current=null,y.current=!1,u.start({x:0,y:0,rotate:0,transition:{type:"spring",stiffness:500,damping:30}});return}const R=Math.abs(E.offset.x),P=Math.abs(E.velocity.x);R>100&&E.offset.x>0||P>500&&E.offset.x>0?u.start({x:800,opacity:0,transition:{duration:.2,ease:"easeOut"}}).then(()=>{f.set(0),N.set(0),s("right")}):R>100&&E.offset.x<0||P>500&&E.offset.x<0?u.start({x:-800,opacity:0,transition:{duration:.2,ease:"easeOut"}}).then(()=>{f.set(0),N.set(0),s("left")}):u.start({x:0,y:0,rotate:0,transition:{type:"spring",stiffness:500,damping:30}}),j.current=null,y.current=!1},V=F=>{F.stopPropagation(),k(E=>(E+1)%t.images.length)},B=F=>{F.stopPropagation(),k(E=>(E-1+t.images.length)%t.images.length)};return e.jsx(Oe,{animate:u,style:{x:f,y:N,rotate:w,opacity:a?g:void 0,zIndex:a?50:50-n,position:"absolute",width:"100%",height:"100%",willChange:"transform"},drag:a?"x":!1,dragElastic:.1,dragConstraints:{left:-300,right:300},dragPropagation:!1,onDragStart:m,onDrag:x,onDragEnd:S,className:`${a?"cursor-grab active:cursor-grabbing":"pointer-events-none"}`,children:e.jsxs("div",{className:"relative w-full h-full bg-white rounded-[2.2rem] shadow-[0_10px_30px_rgba(0,0,0,0.08)] overflow-hidden flex flex-col border border-neutral-100/50",children:[e.jsxs("div",{ref:o,className:"flex-1 overflow-y-auto no-scrollbar pb-40",children:[e.jsxs("div",{className:"relative w-full aspect-[4/5] bg-neutral-100 group overflow-hidden",children:[e.jsx("img",{src:t.images[b],className:"w-full h-full object-cover pointer-events-none"},b),e.jsx("div",{className:"absolute top-2 left-4 right-4 flex gap-1 z-20",children:t.images.map((F,E)=>e.jsx("div",{className:`h-1 flex-1 rounded-full transition-all duration-300 ${E===b?"bg-white shadow-[0_1px_2px_rgba(0,0,0,0.2)]":"bg-white/30"}`},E))}),e.jsxs("div",{className:"absolute inset-0 flex z-10",children:[e.jsx("div",{className:"w-1/2 h-full cursor-pointer",onClick:B}),e.jsx("div",{className:"w-1/2 h-full cursor-pointer",onClick:V})]}),e.jsx("div",{className:"absolute inset-x-0 bottom-0 h-1/2 bg-gradient-to-t from-black/80 via-black/20 to-transparent pointer-events-none"}),e.jsxs("div",{className:"absolute top-6 left-6 right-6 flex justify-between items-start pointer-events-none z-20",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[t.vendor.verified&&e.jsx("div",{className:"bg-[#29B3F0] p-1 rounded-full text-white shadow-lg border border-white/20",children:e.jsx(ye,{size:14,fill:"currentColor"})}),v&&e.jsxs("div",{className:"flex items-center gap-2 bg-black/40 backdrop-blur-md px-3 py-1.5 rounded-full border border-white/20",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Be,{size:12,className:"text-white"}),e.jsx("span",{className:"text-[10px] font-black text-white",children:d.views||0})]}),e.jsx("div",{className:"w-px h-3 bg-white/30"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ce,{size:12,className:"text-white",fill:"currentColor"}),e.jsx("span",{className:"text-[10px] font-black text-white",children:d.likes||0})]}),e.jsx("div",{className:"w-px h-3 bg-white/30"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(he,{size:12,className:"text-white",fill:"currentColor"}),e.jsx("span",{className:"text-[10px] font-black text-white",children:d.super_interest||d.stars||0})]})]})]}),e.jsx("button",{className:"text-white opacity-80 active:scale-90 transition-transform pointer-events-auto",children:e.jsx(qt,{size:24,strokeWidth:3})})]}),e.jsxs("div",{className:"absolute bottom-6 left-6 right-6 pointer-events-none z-20 space-y-3",children:[e.jsx("h2",{className:"text-2xl font-black text-white uppercase italic tracking-tighter leading-tight drop-shadow-[0_4px_8px_rgba(0,0,0,0.6)]",children:t.name}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"bg-white/90 backdrop-blur-md px-3 py-1.5 rounded-xl border border-white/20 shadow-xl flex items-center gap-2",children:[e.jsx(ne,{size:14,className:"text-[#830e4c]",fill:"currentColor"}),e.jsx("span",{className:"text-[10px] font-black text-neutral-900 uppercase tracking-widest italic",children:"Best Seller"})]})})]})]}),e.jsxs("div",{className:"p-6 space-y-8",children:[e.jsxs("div",{className:"bg-neutral-50 rounded-3xl p-5 border border-neutral-100 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-[#830e4c1a] flex items-center justify-center text-[#830e4c]",children:e.jsx(ne,{size:20,fill:"currentColor"})}),e.jsx("h4",{className:"text-sm font-black text-neutral-900 uppercase tracking-tight",children:"Price Inquiry"})]}),e.jsx("span",{className:"text-xl font-black text-[#830e4c] tracking-tighter",children:t.price})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h5",{className:"text-[10px] font-black text-neutral-300 uppercase tracking-[0.2em]",children:"The Story"}),e.jsx("p",{className:"text-lg font-black text-neutral-900 leading-tight",children:t.description})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h5",{className:"text-[10px] font-black text-neutral-300 uppercase tracking-[0.2em]",children:"Item Gallery"}),e.jsxs("span",{className:"text-[9px] font-black text-neutral-400 uppercase tracking-widest",children:[t.images.length," Photos"]})]}),e.jsx("div",{className:"flex gap-3 overflow-x-auto no-scrollbar pb-2",children:t.images.map((F,E)=>e.jsx("button",{onClick:R=>{R.stopPropagation(),k(E)},className:`relative w-28 h-36 rounded-2xl overflow-hidden flex-shrink-0 border-2 transition-all ${E===b?"border-[#830e4c] scale-105 shadow-md":"border-transparent opacity-60"}`,children:e.jsx("img",{src:F,className:"w-full h-full object-cover"})},E))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h5",{className:"text-[10px] font-black text-neutral-300 uppercase tracking-[0.2em]",children:"Category & Style"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("div",{className:"bg-rose-50 px-4 py-2.5 rounded-full flex items-center gap-2 border border-rose-100",children:[e.jsx(he,{size:12,className:"text-[#830e4c]",fill:"currentColor"}),e.jsx("span",{className:"text-[11px] font-black text-[#830e4c] uppercase tracking-widest",children:t.category})]}),e.jsxs("div",{className:"bg-indigo-50 px-4 py-2.5 rounded-full flex items-center gap-2 border border-indigo-100",children:[e.jsx(ye,{size:12,className:"text-indigo-500"}),e.jsx("span",{className:"text-[11px] font-black text-indigo-700 uppercase tracking-widest",children:"Inspected"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h5",{className:"text-[10px] font-black text-neutral-300 uppercase tracking-[0.2em]",children:"Current location"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ce,{size:16,className:"text-[#830e4c]"}),e.jsx("p",{className:"text-lg font-black text-neutral-900 tracking-tight",children:t.distance&&t.distance!=="Unknown"&&t.distance!=="UNKNOWN"?`${t.distance} away • ${t.vendor.location}`:t.vendor.location})]})]}),e.jsx("div",{className:"pt-4",children:e.jsxs("button",{onClick:F=>{F.stopPropagation();const E=t.vendor.id||t.userId;E&&r(`/seller/${E}`)},className:"w-full bg-neutral-50 rounded-[4rem] p-4 flex items-center gap-5 border border-neutral-100 shadow-sm transition-all active:scale-[0.98]",children:[e.jsxs("div",{className:"shrink-0 relative",children:[e.jsx("img",{src:t.vendor.avatar,className:"w-16 h-16 rounded-[1.5rem] object-cover shadow-md border-2 border-white"}),e.jsx("div",{className:"absolute -bottom-1 -right-1 bg-[#29B3F0] p-1 rounded-full text-white shadow-lg border border-white",children:e.jsx(ye,{size:10,fill:"currentColor"})})]}),e.jsxs("div",{className:"flex-1 text-left flex flex-col gap-1",children:[e.jsx("h4",{className:"text-base font-black text-neutral-900 uppercase tracking-tight",children:t.vendor.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{size:14,fill:"#FFD700",className:"text-[#FFD700]"}),e.jsx("span",{className:"text-xs font-black text-neutral-900",children:t.vendor.rating>0?t.vendor.rating.toFixed(1):"0.0"}),e.jsxs("span",{className:"text-[9px] font-black text-neutral-300 uppercase tracking-widest",children:[t.vendor.reviewCount," REVIEWS"]})]})]}),e.jsx(J,{size:20,className:"text-neutral-300 mr-2"})]})})]})]}),e.jsx(Oe,{style:{opacity:ue(f,[-100,-50],[1,0])},className:"absolute top-24 right-10 border-4 border-rose-500 text-rose-500 font-black text-4xl px-4 py-2 rounded-xl rotate-12 pointer-events-none z-[110]",children:"PASS"}),e.jsx(Oe,{style:{opacity:ue(f,[50,100],[0,1])},className:"absolute top-24 left-10 border-4 border-emerald-500 text-emerald-500 font-black text-4xl px-4 py-2 rounded-xl -rotate-12 pointer-events-none z-[110]",children:"LIKE"})]})})},nt=$.div,Ts=({onSwipe:t,isTop:s,index:a,onAction:n,triggerDirection:i})=>{const l=Ve(),u=be(0),r=be(0),f=ue(u,[-200,200],[-10,10]),N=ue(u,[-150,0,150],[.5,1,.5]);je.useEffect(()=>{if(s)i?i==="right"?l.start({x:800,opacity:0,transition:{duration:.3}}).then(()=>t("right")):i==="left"?l.start({x:-800,opacity:0,transition:{duration:.3}}).then(()=>t("left")):i==="up"&&l.start({y:-1e3,opacity:0,transition:{duration:.3}}).then(()=>t("up")):l.start({scale:1,x:0,y:0,opacity:1,transition:{type:"spring",stiffness:300,damping:25}});else{const g=Math.min(a*8,16),b=1-Math.min(a*.04,.08);l.start({scale:b,y:g,x:0,opacity:a>2?0:1-a*.15,transition:{type:"spring",stiffness:300,damping:30}})}},[s,a,i,l,t]);const w=(g,b)=>{if(!s)return;const k=Math.abs(b.offset.x);Math.abs(b.offset.y);const o=Math.abs(b.velocity.x),j=Math.abs(b.velocity.y);if(k>100||o>500){const y=b.offset.x>0?"right":"left";l.start({x:b.offset.x>0?800:-800,opacity:0,transition:{duration:.3}}).then(()=>t(y))}else b.offset.y<-150||j>500?l.start({y:-1e3,opacity:0,transition:{duration:.3}}).then(()=>t("up")):l.start({x:0,y:0,rotate:0,transition:{type:"spring",stiffness:300,damping:25}})};return e.jsx(nt,{animate:l,style:{x:u,y:r,rotate:f,opacity:s?N:void 0,zIndex:s?50:50-a,position:"absolute",width:"100%",height:"100%",willChange:"transform"},drag:s?"x":!1,dragElastic:.2,dragConstraints:{left:-300,right:300},onDragEnd:w,className:`touch-pan-y ${s?"cursor-grab active:cursor-grabbing":"pointer-events-none"}`,children:e.jsxs("div",{className:"relative w-full h-full bg-[#830e4c] rounded-[2.2rem] shadow-[0_20px_50px_rgba(131,14,76,0.3)] overflow-hidden flex flex-col border border-white/10",children:[e.jsx("div",{className:"absolute top-[-10%] right-[-10%] w-64 h-64 bg-white/10 rounded-full blur-3xl animate-pulse"}),e.jsx("div",{className:"absolute bottom-[-10%] left-[-10%] w-80 h-80 bg-black/20 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute inset-0 opacity-[0.03] pointer-events-none",style:{backgroundImage:"radial-gradient(circle at 2px 2px, white 1px, transparent 0)",backgroundSize:"24px 24px"}}),e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-8 text-center relative z-10",children:[e.jsxs("div",{className:"relative mb-8",children:[e.jsx(nt,{initial:{scale:.8,rotate:-10},animate:{scale:1,rotate:0},transition:{type:"spring",repeat:1/0,repeatType:"reverse",duration:2},className:"w-24 h-24 bg-white rounded-[2.5rem] flex items-center justify-center shadow-2xl border-4 border-[#830e4c]/20",children:e.jsx(Ut,{size:48,className:"text-[#830e4c]",strokeWidth:1.5})}),e.jsx("div",{className:"absolute -top-1 -right-1 bg-emerald-500 text-white p-2 rounded-xl shadow-lg z-20",children:e.jsx(Wt,{size:16,strokeWidth:3})})]}),e.jsxs("div",{className:"space-y-6 max-w-[300px]",children:[e.jsxs("h2",{className:"text-[2.8rem] font-black text-white uppercase italic tracking-tighter leading-[0.85]",children:["Own a ",e.jsx("br",{})," BUSINESS?"]}),e.jsxs("p",{className:"text-[12px] font-black text-white uppercase tracking-[0.15em] leading-relaxed max-w-[240px] mx-auto",children:["REACH THOUSANDS OF LOCAL BUYERS ",e.jsx("br",{})," IN YOUR COMMUNITY INSTANTLY."]})]}),e.jsxs("div",{className:"mt-14 w-full px-2",children:[e.jsxs("button",{onClick:g=>{g.stopPropagation(),n==null||n()},className:"w-full bg-white text-[#830e4c] py-5 rounded-[2rem] font-black uppercase tracking-[0.2em] text-[12px] shadow-2xl active:scale-95 transition-all flex items-center justify-center gap-3",children:["START DROPPING",e.jsx(ne,{size:16,fill:"currentColor"})]}),e.jsxs("div",{className:"flex items-center justify-center gap-8 mt-6",children:[e.jsxs("div",{className:"flex items-center gap-2 opacity-80",children:[e.jsx(ve,{size:14,className:"text-white"}),e.jsx("span",{className:"text-[9px] font-black text-white uppercase tracking-widest",children:"FREE LISTING"})]}),e.jsxs("div",{className:"flex items-center gap-2 opacity-80",children:[e.jsx(ut,{size:14,className:"text-white"}),e.jsx("span",{className:"text-[9px] font-black text-white uppercase tracking-widest",children:"VERIFIED TAGS"})]})]})]})]}),e.jsxs("div",{className:"bg-black/10 backdrop-blur-sm py-4 px-8 flex items-center justify-between border-t border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 bg-white/10 rounded-lg flex items-center justify-center",children:e.jsx(ne,{size:12,className:"text-white",fill:"currentColor"})}),e.jsx("span",{className:"text-[9px] font-black text-white/60 uppercase tracking-widest",children:"Nyem For Business"})]}),e.jsx(Tt,{size:16,className:"text-white/20"})]})]})})},Os=$.div,Ms=({onSwipe:t,isTop:s,index:a,triggerDirection:n})=>{const i=Ve(),l=be(0),u=be(0),r=ue(l,[-200,200],[-10,10]),f=ue(l,[-150,0,150],[.5,1,.5]);je.useEffect(()=>{if(s)n?n==="right"?i.start({x:800,opacity:0,transition:{duration:.3}}).then(()=>t("right")):n==="left"?i.start({x:-800,opacity:0,transition:{duration:.3}}).then(()=>t("left")):n==="up"&&i.start({y:-1e3,opacity:0,transition:{duration:.3}}).then(()=>t("up")):i.start({scale:1,x:0,y:0,opacity:1,transition:{type:"spring",stiffness:300,damping:25}});else{const w=Math.min(a*8,16),g=1-Math.min(a*.04,.08);i.start({scale:g,y:w,x:0,opacity:a>2?0:1-a*.15,transition:{type:"spring",stiffness:300,damping:30}})}},[s,a,n,i,t]);const N=(w,g)=>{s&&(g.offset.x>100?i.start({x:800,opacity:0}).then(()=>t("right")):g.offset.x<-100?i.start({x:-800,opacity:0}).then(()=>t("left")):g.offset.y<-150?i.start({y:-1e3,opacity:0}).then(()=>t("up")):i.start({x:0,y:0,rotate:0}))};return e.jsx(Os,{animate:i,style:{x:l,y:u,rotate:r,opacity:s?f:void 0,zIndex:s?50:50-a,position:"absolute",width:"100%",height:"100%",willChange:"transform"},drag:!!s,dragConstraints:{left:0,right:0,top:0,bottom:0},onDragEnd:N,className:`touch-pan-y ${s?"cursor-grab active:cursor-grabbing":"pointer-events-none"}`,children:e.jsxs("div",{className:"relative w-full h-full bg-white rounded-[2.8rem] shadow-[0_30px_70px_rgba(0,0,0,0.08)] overflow-hidden flex flex-col border border-neutral-100/50",children:[e.jsx("div",{className:"absolute top-[-20%] left-[-20%] w-full h-full bg-[#830e4c]/5 rounded-full blur-[100px] animate-pulse"}),e.jsx("div",{className:"absolute bottom-[-20%] right-[-20%] w-full h-full bg-indigo-500/5 rounded-full blur-[100px]"}),e.jsxs("div",{className:"flex-1 flex flex-col p-7 sm:p-9 relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-3.5 mb-8",children:[e.jsx("div",{className:"w-11 h-11 bg-[#830e4c] rounded-xl flex items-center justify-center text-white shadow-xl shadow-[#830e4c]/20",children:e.jsx(ne,{size:22,fill:"currentColor"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h2",{className:"text-2xl font-black text-neutral-900 tracking-tight uppercase italic leading-none",children:"Welcome"}),e.jsx("p",{className:"text-[10px] font-black text-[#830e4c] uppercase tracking-[0.2em] mt-1.5 opacity-80",children:"To Nyem Marketplace"})]})]}),e.jsxs("div",{className:"space-y-8 flex-1",children:[e.jsxs("h1",{className:"text-[38px] font-black text-neutral-900 tracking-tighter uppercase italic leading-[0.85]",children:["Let's get you ",e.jsx("br",{})," ",e.jsx("span",{className:"text-[#830e4c]",children:"Started."})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-7",children:[e.jsx("div",{className:"w-11 h-11 rounded-full bg-rose-50 flex items-center justify-center text-rose-500 shrink-0 border border-rose-100 shadow-sm",children:e.jsx(we,{size:22,strokeWidth:3})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h4",{className:"text-[13px] font-black text-neutral-900 uppercase tracking-tight",children:"Swipe Left"}),e.jsx("p",{className:"text-[11px] font-bold text-neutral-400 uppercase tracking-[0.1em] mt-0.5",children:"To pass on items you don't like"})]})]}),e.jsxs("div",{className:"flex items-center gap-7",children:[e.jsx("div",{className:"w-11 h-11 rounded-full bg-[#830e4c]/5 flex items-center justify-center text-[#830e4c] shrink-0 border border-[#830e4c]/10 shadow-sm",children:e.jsx(Ce,{size:20,fill:"currentColor",strokeWidth:0})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h4",{className:"text-[13px] font-black text-neutral-900 uppercase tracking-tight",children:"Swipe Right"}),e.jsx("p",{className:"text-[11px] font-bold text-neutral-400 uppercase tracking-[0.1em] mt-0.5",children:"LIKE AND SAVE ITEM TO WISHLIST"})]})]}),e.jsxs("div",{className:"flex items-center gap-7",children:[e.jsx("div",{className:"w-11 h-11 rounded-full bg-[#830e4c]/5 flex items-center justify-center text-[#830e4c] shrink-0 border border-[#830e4c]/10 shadow-sm",children:e.jsx(he,{size:20,fill:"currentColor",strokeWidth:0})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h4",{className:"text-[13px] font-black text-neutral-900 uppercase tracking-tight",children:"Swipe Up"}),e.jsx("p",{className:"text-[11px] font-bold text-neutral-400 uppercase tracking-[0.1em] mt-0.5",children:"To notify seller immediately"})]})]})]})]}),e.jsx("div",{className:"flex-1"}),e.jsxs("div",{className:"mt-auto space-y-6 pb-12",children:[e.jsxs("div",{className:"bg-neutral-50/80 backdrop-blur-sm rounded-3xl p-5 flex items-center justify-between border border-neutral-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-11 h-11 rounded-full bg-white flex items-center justify-center text-[#830e4c] shadow-md animate-bounce",children:e.jsx(Ot,{size:20,fill:"currentColor",className:"rotate-[25deg]"})}),e.jsx("span",{className:"text-[11px] font-black text-neutral-400 uppercase tracking-[0.2em]",children:"Try it now"})]}),e.jsxs("div",{className:"flex items-center gap-1.5 text-[#830e4c]",children:[e.jsx(J,{size:20,strokeWidth:4}),e.jsx(J,{size:20,strokeWidth:4,className:"opacity-40"}),e.jsx(J,{size:20,strokeWidth:4,className:"opacity-10"})]})]}),e.jsx("div",{className:"flex items-center justify-between px-2",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ve,{size:13,className:"text-[#830e4c]"}),e.jsx("span",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest italic opacity-80",children:"Happy Discovering"})]})})]})]})]})})},Ds=$.div,Bs=({type:t})=>{const s=t==="services",a=s?Mt:Dt;return e.jsxs(Ds,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"w-full h-full flex flex-col items-center justify-center text-center p-8 bg-neutral-50 rounded-[2.5rem] border border-neutral-100 shadow-inner",children:[e.jsxs("div",{className:"relative mb-8",children:[e.jsx("div",{className:"w-24 h-24 bg-white rounded-[2rem] flex items-center justify-center shadow-sm border border-neutral-100 relative z-10",children:e.jsx(a,{size:40,className:"text-[#830e4c]",strokeWidth:1.5})}),e.jsx("div",{className:"absolute inset-0 bg-[#830e4c1a] rounded-[2rem] blur-2xl opacity-20 -z-10 scale-125"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-2xl font-black text-neutral-900 tracking-tighter uppercase leading-none",children:s?"Professional Services":"Smart Bartering"}),e.jsx("p",{className:"text-neutral-400 text-[10px] font-black uppercase tracking-widest max-w-[200px] mx-auto leading-relaxed",children:s?"Hire experts or offer your skills. Coming very soon.":"Trade items directly with neighbors. Coming very soon."})]}),e.jsx("div",{className:"mt-10 flex flex-col items-center gap-4",children:e.jsx("span",{className:"px-5 py-2.5 bg-[#830e4c] text-white text-[9px] font-black uppercase tracking-[0.2em] rounded-full shadow-lg shadow-[#830e4c1a]",children:"Stay Tuned"})})]})},Ks=({rating:t})=>e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(he,{size:16,fill:"#FFD700",className:"text-[#FFD700]"}),e.jsx("span",{className:"text-sm font-black text-neutral-900 leading-none",children:t.toFixed(1)})]}),Ie=({isOpen:t,onClose:s,title:a,children:n,showBack:i,onBack:l,fullHeight:u})=>e.jsx(Z,{children:t&&e.jsxs(e.Fragment,{children:[e.jsx($.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[200]",onClick:s}),e.jsxs($.div,{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:200},className:`fixed bottom-0 left-0 right-0 bg-white rounded-t-[2.5rem] z-[210] p-6 pb-12 shadow-2xl ${u?"h-[92vh]":"max-h-[85vh]"} overflow-y-auto no-scrollbar max-w-[768px] mx-auto`,children:[e.jsx("div",{className:"w-10 h-1 bg-neutral-200 rounded-full mx-auto mb-6"}),e.jsxs("div",{className:"flex justify-between items-center mb-8 px-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[i&&e.jsx("button",{onClick:l,className:"p-2.5 bg-neutral-100 rounded-full text-neutral-900 active:scale-90 transition-all shadow-sm",children:e.jsx(Bt,{size:20,strokeWidth:2.5})}),e.jsx("h3",{className:"text-xl font-black text-neutral-900 tracking-tighter uppercase leading-none",children:a})]}),e.jsx("button",{onClick:s,className:"p-2.5 bg-neutral-100 rounded-full text-neutral-400 active:scale-90 transition-all shadow-sm",children:e.jsx(we,{size:20,strokeWidth:2.5})})]}),e.jsx("div",{className:"px-1 no-scrollbar",children:n})]})]})}),Vs=({product:t,onClose:s,onShare:a,onSellerClick:n,onSendRequest:i,hasValidToken:l,onLogin:u})=>{const[r,f]=c.useState(0);return t?e.jsx(Ie,{isOpen:!!t,onClose:s,title:"Item Details",fullHeight:!0,children:e.jsxs("div",{className:"flex flex-col gap-6 pb-32 no-scrollbar max-w-[390px] mx-auto",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx($.div,{initial:{opacity:.8},animate:{opacity:1},className:"w-full aspect-square rounded-[2rem] overflow-hidden bg-neutral-100 border border-neutral-100 shadow-sm",children:e.jsx("img",{src:t.images[r],className:"w-full h-full object-cover"})},t.images[r]),e.jsx("div",{className:"flex gap-3 overflow-x-auto no-scrollbar pb-2 px-1",children:t.images.map((N,w)=>e.jsx("button",{onClick:()=>f(w),className:`flex-shrink-0 w-16 h-16 rounded-2xl overflow-hidden border-2 transition-all ${r===w?"border-[#830e4c] scale-105 shadow-md shadow-[#830e4c]/20":"border-transparent opacity-50 hover:opacity-100"}`,children:e.jsx("img",{src:N,className:"w-full h-full object-cover"})},w))})]}),e.jsxs("div",{className:"px-1 space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("span",{className:"text-[10px] font-black text-[#830e4c] uppercase tracking-[0.2em] bg-[#830e4c1a] px-3 py-1.5 rounded-xl border border-[#830e4c33]",children:t.category})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-[2.2rem] font-black text-neutral-900 tracking-tighter leading-[0.9] uppercase italic w-full",children:t.name}),e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("span",{className:"text-3xl font-black text-[#830e4c] tracking-tighter",children:t.price}),e.jsx("div",{className:"w-1 h-1 rounded-full bg-neutral-200"}),e.jsx("span",{className:"text-[9px] font-black text-neutral-400 uppercase tracking-widest italic",children:"Negotiable"})]}),e.jsx("button",{onClick:()=>a(t),className:"p-3.5 bg-neutral-900 text-white rounded-2xl active:scale-90 transition-all hover:bg-neutral-800",children:e.jsx(Kt,{size:18,strokeWidth:2.5})})]})]})]}),e.jsx("div",{className:"h-px bg-neutral-100 w-full"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-[10px] font-black text-neutral-300 uppercase tracking-[0.25em]",children:"The Description"}),e.jsx("p",{className:"text-neutral-600 text-sm font-medium leading-relaxed",children:t.longDescription})]}),e.jsxs("div",{className:"space-y-4 pt-4",children:[e.jsx("h4",{className:"text-[10px] font-black text-neutral-300 uppercase tracking-[0.25em]",children:"Owner of Item"}),e.jsxs("div",{onClick:()=>n(t.vendor),className:"bg-white rounded-[3rem] p-5 flex items-center justify-between shadow-[0_12px_40px_rgba(0,0,0,0.04)] border border-neutral-50 cursor-pointer active:scale-[0.98] transition-all hover:bg-neutral-50 group",children:[e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsxs("div",{className:"relative shrink-0",children:[e.jsx("div",{className:"w-20 h-20 rounded-full overflow-hidden border-[6px] border-white shadow-lg ring-1 ring-neutral-100",children:e.jsx("img",{src:t.vendor.avatar,className:"w-full h-full object-cover"})}),e.jsx("div",{className:"absolute bottom-1 right-1 bg-white p-1 rounded-full shadow-md border border-neutral-100",children:e.jsx("div",{className:"w-3.5 h-3.5 bg-[#29B3F0] rounded-full shadow-inner"})})]}),e.jsxs("div",{className:"flex flex-col gap-2 min-w-0",children:[e.jsx("h4",{className:"text-xl font-black text-neutral-900 uppercase tracking-tighter italic leading-none truncate",children:t.vendor.name}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(Ks,{rating:t.vendor.rating}),e.jsxs("div",{className:"flex items-center gap-1 text-neutral-400",children:[e.jsx(ce,{size:10,strokeWidth:3}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-tight",children:t.distance&&t.distance!=="Unknown"&&t.distance!=="UNKNOWN"?`${t.distance} ${t.vendor.location}`:t.vendor.location})]})]})]})]}),e.jsx("div",{className:"w-14 h-14 bg-neutral-50/50 rounded-[1.5rem] flex items-center justify-center text-neutral-300 group-hover:text-neutral-900 group-hover:bg-white group-hover:shadow-lg transition-all border border-neutral-100/50 shrink-0",children:e.jsx(J,{size:28,strokeWidth:3})})]})]})]}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 p-6 bg-gradient-to-t from-white via-white/95 to-transparent pt-12 z-[250]",children:e.jsxs("button",{onClick:()=>{l?i():u()},className:"w-full max-w-[360px] mx-auto bg-[#830e4c] text-white py-6 rounded-[2.2rem] font-black uppercase text-[11px] tracking-[0.4em] shadow-[0_20px_60px_rgba(131,14,76,0.25)] active:scale-95 transition-all flex items-center justify-center gap-3 italic",children:[e.jsx(Vt,{size:18,strokeWidth:3,className:"text-white/60"}),"SEND REQUEST TO SELLER"]})})]})}):null},Hs=({isOpen:t,onClose:s,likedItems:a,onItemClick:n,onRemove:i})=>e.jsx(Ie,{isOpen:t,onClose:s,title:"Your Wishlist",fullHeight:!0,children:e.jsx("div",{className:"space-y-4 pb-10",children:a.length>0?a.map(l=>e.jsxs("div",{className:"flex items-center gap-4 p-3 bg-neutral-50 rounded-2xl border border-neutral-100 group",children:[e.jsx("div",{className:"w-20 h-20 rounded-xl overflow-hidden flex-shrink-0 border border-neutral-200",children:e.jsx("img",{src:l.images[0],className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-0.5",children:[l.isSuper&&e.jsx(ne,{size:10,className:"text-[#29B3F0]",fill:"currentColor"}),e.jsx("span",{className:"text-[8px] font-black text-[#830e4c] uppercase tracking-widest",children:l.category})]}),e.jsx("h4",{className:"text-sm font-black text-neutral-900 truncate tracking-tight",children:l.name}),e.jsx("p",{className:"text-xs font-black text-[#830e4c] mt-0.5",children:l.price}),e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsx("button",{onClick:()=>{n(l),s()},className:"text-[9px] font-black uppercase tracking-widest text-neutral-400 hover:text-neutral-900 transition-colors",children:"Details"}),e.jsxs("button",{onClick:()=>i(l.id),className:"text-[9px] font-black uppercase tracking-widest text-rose-500 flex items-center gap-1",children:[e.jsx(lt,{size:10})," Remove"]})]})]}),e.jsx("button",{onClick:()=>{s(),n(l)},className:"p-3 bg-white rounded-xl shadow-sm border border-neutral-100 text-neutral-900 active:scale-90 transition-all",children:e.jsx(Ye,{size:18,strokeWidth:2.5})})]},l.id)):e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center space-y-4",children:[e.jsx("div",{className:"w-20 h-20 bg-neutral-50 rounded-full flex items-center justify-center border border-neutral-100",children:e.jsx(Ce,{size:32,className:"text-neutral-200"})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h4",{className:"text-base font-black text-neutral-900 uppercase tracking-tighter",children:"No items yet"}),e.jsx("p",{className:"text-[10px] font-bold text-neutral-400 uppercase tracking-widest",children:"Swipe right on items you want to buy!"})]})]})})}),Ys=t=>{const s=t.toLowerCase().trim(),a={all:Ke,accessories:he,electronics:Ht,fashion:et,clothing:et,"home & decor":We,home:We,decor:We,"sports & fitness":Ue,sports:Ue,fitness:Ue,"beauty & care":ve,beauty:ve,care:ve,"toys & games":qe,toys:qe,games:qe,"books & media":Re,books:Re,media:Re,automotive:Ze,vehicles:Ze,"garden & outdoor":Le,garden:Le,outdoor:Le,"health & wellness":Fe,health:Fe,wellness:Fe,"pet supplies":Xe,pets:Xe};if(a[s])return a[s];for(const[n,i]of Object.entries(a))if(s.includes(n)||n.includes(s))return i;return Ke},Qs=t=>{switch(t){case"marketplace":return"Shop";case"services":return"Services";case"barter":return"Swap";default:return"Shop"}},Gs=({isOpen:t,onClose:s,activeCategory:a,onCategorySelect:n,activeTab:i})=>{const l=Qs(i),{data:u=[],isLoading:r,error:f}=bt(l),N=je.useMemo(()=>[{id:0,name:"All"},...u],[u]);return e.jsx(Ie,{isOpen:t,onClose:s,title:"DISCOVERY FILTER",children:r?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(Yt,{size:32,className:"text-[#830e4c] animate-spin mb-4"}),e.jsx("p",{className:"text-sm font-bold text-neutral-400 uppercase tracking-wider",children:"Loading Categories..."})]}):f?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx("p",{className:"text-sm font-bold text-red-500 uppercase tracking-wider mb-2",children:"Failed to load categories"}),e.jsx("p",{className:"text-xs text-neutral-400 text-center",children:"Please try again later"})]}):e.jsx("div",{className:"space-y-2",children:N.map(w=>{const g=Ys(w.name);return e.jsxs("button",{onClick:()=>{n(w.name),s()},className:`w-full flex items-center justify-between p-3.5 rounded-2xl transition-all border-2 active:scale-[0.98] ${a===w.name?"bg-[#830e4c] border-[#830e4c] shadow-md text-white":"bg-white border-neutral-50 hover:border-neutral-100"}`,children:[e.jsxs("div",{className:"flex items-center gap-3.5",children:[e.jsx("div",{className:`w-11 h-11 rounded-xl flex items-center justify-center transition-all ${a===w.name?"bg-white/20 text-white":"bg-neutral-50 text-neutral-400"}`,children:e.jsx(g,{size:20})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h4",{className:`text-base font-black tracking-tight leading-tight uppercase italic ${a===w.name?"text-white":"text-neutral-900"}`,children:w.name}),e.jsx("p",{className:`text-[8px] font-black uppercase tracking-[0.15em] mt-0.5 ${a===w.name?"text-white/70":"text-neutral-300"}`,children:"EXPLORE COLLECTION"})]})]}),e.jsx("div",{className:"flex items-center justify-center",children:a===w.name?e.jsx("div",{className:"w-7 h-7 bg-white rounded-full flex items-center justify-center shadow-sm",children:e.jsx(pe,{size:14,strokeWidth:4,className:"text-[#830e4c]"})}):e.jsx(J,{size:18,className:"text-neutral-200"})})]},w.id||w.name)})})})},Js=[{city:"All Locations"},{city:"Abuja"},{city:"Lagos"},{city:"Port Harcourt"},{city:"Enugu"},{city:"Asaba"},{city:"Kano"},{city:"Ibadan"}],Xs=({isOpen:t,onClose:s,currentCity:a,cities:n,onCitySelect:i})=>e.jsx(Ie,{isOpen:t,onClose:s,title:"SELECT CITY",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:()=>{i("All Locations"),s()},className:`w-full flex items-center justify-between p-3.5 rounded-2xl transition-all border-2 active:scale-[0.98] ${a==="All Locations"?"bg-[#830e4c1a] border-[#830e4c] shadow-sm":"bg-white border-neutral-50 hover:border-neutral-100"}`,children:[e.jsxs("div",{className:"flex items-center gap-3.5",children:[e.jsx("div",{className:`w-11 h-11 rounded-xl flex items-center justify-center transition-all ${a==="All Locations"?"bg-[#830e4c] text-white":"bg-neutral-50 text-neutral-400"}`,children:e.jsx(Ke,{size:20})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h4",{className:`text-base font-black tracking-tight leading-tight uppercase italic ${a==="All Locations"?"text-[#830e4c]":"text-neutral-900"}`,children:"All Locations"}),e.jsx("p",{className:"text-[8px] font-black text-neutral-300 uppercase tracking-[0.15em] mt-0.5",children:"NATIONWIDE COVERAGE"})]})]}),e.jsx("div",{className:"flex items-center justify-center",children:a==="All Locations"?e.jsx("div",{className:"w-7 h-7 bg-[#830e4c] rounded-full flex items-center justify-center shadow-sm",children:e.jsx(pe,{size:14,strokeWidth:4,className:"text-white"})}):e.jsx(J,{size:18,className:"text-neutral-200"})})]},"all"),n&&n.length>0?n.map(l=>e.jsxs("button",{onClick:()=>{i(l.name),s()},className:`w-full flex items-center justify-between p-3.5 rounded-2xl transition-all border-2 active:scale-[0.98] ${a===l.name?"bg-[#830e4c1a] border-[#830e4c] shadow-sm":"bg-white border-neutral-50 hover:border-neutral-100"}`,children:[e.jsxs("div",{className:"flex items-center gap-3.5",children:[e.jsx("div",{className:`w-11 h-11 rounded-xl flex items-center justify-center transition-all ${a===l.name?"bg-[#830e4c] text-white":"bg-neutral-50 text-neutral-400"}`,children:e.jsx(ce,{size:20})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h4",{className:`text-base font-black tracking-tight leading-tight uppercase italic ${a===l.name?"text-[#830e4c]":"text-neutral-900"}`,children:l.name}),e.jsx("p",{className:"text-[8px] font-black text-neutral-300 uppercase tracking-[0.15em] mt-0.5",children:"CITY-WIDE SEARCH"})]})]}),e.jsx("div",{className:"flex items-center justify-center",children:a===l.name?e.jsx("div",{className:"w-7 h-7 bg-[#830e4c] rounded-full flex items-center justify-center shadow-sm",children:e.jsx(pe,{size:14,strokeWidth:4,className:"text-white"})}):e.jsx(J,{size:18,className:"text-neutral-200"})})]},l.id)):Js.filter(l=>l.city!=="All Locations").map(l=>e.jsxs("button",{onClick:()=>{i(l.city),s()},className:`w-full flex items-center justify-between p-3.5 rounded-2xl transition-all border-2 active:scale-[0.98] ${a===l.city?"bg-[#830e4c1a] border-[#830e4c] shadow-sm":"bg-white border-neutral-50 hover:border-neutral-100"}`,children:[e.jsxs("div",{className:"flex items-center gap-3.5",children:[e.jsx("div",{className:`w-11 h-11 rounded-xl flex items-center justify-center transition-all ${a===l.city?"bg-[#830e4c] text-white":"bg-neutral-50 text-neutral-400"}`,children:e.jsx(ce,{size:20})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h4",{className:`text-base font-black tracking-tight leading-tight uppercase italic ${a===l.city?"text-[#830e4c]":"text-neutral-900"}`,children:l.city}),e.jsx("p",{className:"text-[8px] font-black text-neutral-300 uppercase tracking-[0.15em] mt-0.5",children:"CITY-WIDE SEARCH"})]})]}),e.jsx("div",{className:"flex items-center justify-center",children:a===l.city?e.jsx("div",{className:"w-7 h-7 bg-[#830e4c] rounded-full flex items-center justify-center shadow-sm",children:e.jsx(pe,{size:14,strokeWidth:4,className:"text-white"})}):e.jsx(J,{size:18,className:"text-neutral-200"})})]},l.city))]})}),it=(t,s,a)=>`discover_state_${t}_${s}_${a}`,Zs=(t,s,a)=>{const n=it(t,s,a),i=(()=>{try{const m=localStorage.getItem(n);if(m){const x=JSON.parse(m),S=Date.now()-x.timestamp>1440*60*1e3,V=x.filters.activeTab===t&&x.filters.activeCategory===s&&x.filters.currentCity===a;if(!S&&V&&x.items.length>0)return x}}catch(m){console.warn("Failed to restore discover state:",m)}return null})(),[l,u]=c.useState((i==null?void 0:i.items)||[]),[r,f]=c.useState((i==null?void 0:i.history)||[]),[N,w]=c.useState((i==null?void 0:i.swipeCount)||0),[g,b]=c.useState(0),k=c.useRef({activeTab:t,activeCategory:s,currentCity:a}),o=c.useRef(!!i);c.useEffect(()=>{const m={items:l,history:r,swipeCount:N,timestamp:Date.now(),filters:{activeTab:t,activeCategory:s,currentCity:a}};try{localStorage.setItem(n,JSON.stringify(m))}catch(x){console.warn("Failed to persist discover state:",x)}},[l,r,N,t,s,a,n]),c.useEffect(()=>{const m=k.current;if(m.activeTab!==t||m.activeCategory!==s||m.currentCity!==a){try{const S=it(m.activeTab,m.activeCategory,m.currentCity);localStorage.removeItem(S)}catch(S){console.warn("Failed to clear old discover state:",S)}u([]),f([]),w(0),o.current=!1,k.current={activeTab:t,activeCategory:s,currentCity:a}}},[t,s,a]);const{data:j,isLoading:y,refetch:C}=ds({activeTab:t,activeCategory:s,currentCity:a});c.useEffect(()=>{if(j&&j.length>0&&l.length===0&&!o.current){let m=[...j];localStorage.getItem("has_seen_welcome_card")==="true"||m.push(cs()),u(m)}},[j,l.length,g]);const v=c.useCallback(()=>{if(r.length===0)return;const m=r[r.length-1];u(x=>[...x,m]),f(x=>x.slice(0,-1))},[r]),d=c.useCallback(m=>{if(m.isAd||m.isWelcome){m.isWelcome&&localStorage.setItem("has_seen_welcome_card","true"),u(S=>S.slice(0,-1));return}const x=N+1;w(x),f(S=>[...S,m]),u(S=>{const V=S.slice(0,-1);return x%3===0&&V.length>0?[...V,ls()]:V})},[N]);return{items:l,setItems:u,history:r,setHistory:f,loadingItems:y,swipeCount:N,setSwipeCount:w,fetchItems:c.useCallback(()=>(o.current=!1,b(m=>m+1),C()),[C]),undoLast:v,removeItem:d}},ea=()=>ee({queryKey:["wishlist"],queryFn:()=>W(q.swipes.wishlist),select:t=>t.items||[],enabled:!!localStorage.getItem("auth_token")}),ta=()=>{const{data:t=[],refetch:s}=ea();return{likedItems:t,fetchWishlist:s,removeFromWishlist:async n=>{}}},xa=({activeTab:t,activeCategory:s,setActiveCategory:a,currentCity:n,setCurrentCity:i,cities:l,likedItems:u,onWishlistClick:r,onNavigateToUpload:f,hasValidToken:N,onLogin:w,triggerDir:g,setTriggerDir:b,showFilterDialog:k,setShowFilterDialog:o,showLocationDialog:j,setShowLocationDialog:y,showWishlist:C,setShowWishlist:v,onItemsChange:d,onModalStateChange:m})=>{const{items:x,history:S,loadingItems:V,fetchItems:B,undoLast:F,removeItem:E}=Zs(t,s,n),{fetchWishlist:R,removeFromWishlist:P}=ta(),A=hs(),K=fs(),D=c.useRef(new Set),[M,te]=c.useState(null),I=Se();c.useEffect(()=>{M&&!M.isAd&&!M.isWelcome&&(D.current.has(M.id)||(A.mutate(M.id),D.current.add(M.id)))},[M,A]),c.useEffect(()=>{const z=x[x.length-1];if(z&&!z.isAd&&!z.isWelcome&&!D.current.has(z.id)){const L=setTimeout(()=>{A.mutate(z.id),D.current.add(z.id)},1500);return()=>clearTimeout(L)}},[x,A]);const[T,se]=c.useState(!1),[ae,ie]=c.useState(null),p=c.useRef(new Set),U=us();c.useEffect(()=>{d&&d(x,S,F)},[x,S,F,d]),c.useEffect(()=>{m&&m(!!M)},[M,m]),c.useEffect(()=>{x.length===0&&B()},[B,x.length]),c.useEffect(()=>{xe()&&R()},[R]);const h=yt();c.useEffect(()=>{const L=new URLSearchParams(h.search).get("item");L&&(async()=>{try{const O=x.find(Y=>String(Y.id)===String(L));if(O)te(O);else{const Y=await W(q.items.show(L));if(Y&&Y.data){const oe=wt(Y.data);te(oe)}}}catch(O){console.error("Failed to load shared item",O)}})()},[h.search,x]);const _=x.length-1,Q=c.useCallback(async(z,L)=>{const H=L||x[_];if(!H)return;const O=()=>{E(H),b(null)};if(H.isAd||H.isWelcome){O();return}const Y=localStorage.getItem("auth_token")!==null;if(z==="left"){O();return}if(!Y){w(),b(null);return}if(z==="right"||z==="up")try{await U.mutateAsync({target_listing_id:H.id,direction:z==="up"?"up":"right"})}catch(oe){console.error("Failed to send swipe:",oe)}z==="up"&&(ie(H),se(!0),p.current.has(H.id)||(os("Request Sent!",`You've sent a Super Interest for "${H.name}".`,H.images[0]),p.current.add(H.id)),setTimeout(()=>se(!1),3500),setTimeout(()=>R(),500)),O()},[x,_,E,R,w,b]);c.useEffect(()=>{g&&x.length>0&&_>=0&&x[_]&&Q(g)},[g]);const le=async(z=null)=>{const L=z||x[_]||M;if(!L)return;!L.isAd&&!L.isWelcome&&K.mutate(L.id);const H=`${window.location.origin}/discover?item=${L.id}`;if(window.focus(),navigator.share)try{await navigator.share({title:L.name,text:`Check out this ${L.name} on Nyem! It's going for ${L.price}.`,url:H});return}catch(O){if(O.name==="AbortError")return}try{await navigator.clipboard.writeText(H),alert("Item link copied to clipboard!")}catch{const Y=document.createElement("input");document.body.appendChild(Y),Y.value=H,Y.select(),document.execCommand("copy"),document.body.removeChild(Y),alert("Item link copied!")}},G=()=>{s==="All"&&n==="All Locations"?B():(a("All"),i("All Locations"))},_e=z=>{const L=z.id||z.userId;L&&I(`/seller/${L}`)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center justify-center pt-0 pb-2 shrink-0",children:e.jsxs("div",{className:"flex items-center gap-2 px-4 py-1.5 bg-white rounded-full border border-neutral-100 shadow-sm mb-1",children:[e.jsx(ce,{size:10,className:"text-[#830e4c]"}),e.jsxs("span",{className:"text-[9px] font-bold text-neutral-400 uppercase tracking-widest",children:["Discovery in ",e.jsx("span",{className:"text-[#830e4c] font-black italic",children:n}),s!=="All"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mx-1 text-neutral-300",children:"•"}),e.jsx("span",{className:"text-[#830e4c] font-black italic",children:s})]})]})]})}),e.jsx("div",{className:"relative flex-1 w-full mt-1 mb-[2px]",children:e.jsx(Z,{mode:"popLayout",children:t==="marketplace"?V?e.jsxs($.div,{initial:{opacity:0},animate:{opacity:1},className:"h-full flex flex-col items-center justify-center text-center px-8",children:[e.jsx("div",{className:"w-20 h-20 bg-neutral-50 rounded-full flex items-center justify-center mb-6 border border-neutral-100 shadow-inner animate-pulse",children:e.jsx(Qt,{size:32,className:"text-[#830e4c]"})}),e.jsx("h3",{className:"text-xl font-black text-neutral-900 uppercase tracking-tighter",children:"Loading drops..."}),e.jsx("p",{className:"text-[10px] font-bold text-neutral-400 uppercase tracking-[0.2em] mt-2",children:"Discovering amazing items"})]}):x.length>0?x.slice(-4).map((z,L,H)=>{const O=H.length-1;return z.isWelcome?e.jsx(Ms,{index:O-L,isTop:L===O,onSwipe:Q,triggerDirection:L===O?g:null},z.id):z.isAd?e.jsx(Ts,{index:O-L,isTop:L===O,onSwipe:Q,onAction:f,triggerDirection:L===O?g:null},z.id):e.jsx(Ws,{product:z,index:O-L,isTop:L===O,onSwipe:Q,triggerDirection:L===O?g:null,onShowDetail:Y=>{te(Y)}},`${z.id}-${x.length}`)}):e.jsxs($.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"h-full flex flex-col items-center justify-center text-center px-8",children:[e.jsx("div",{className:"w-20 h-20 bg-neutral-50 rounded-full flex items-center justify-center mb-6 border border-neutral-100 shadow-inner",children:e.jsx(Gt,{size:32,className:"text-neutral-300"})}),e.jsx("h3",{className:"text-xl font-black text-neutral-900 uppercase tracking-tighter",children:"End of the line"}),e.jsx("p",{className:"text-[10px] font-bold text-neutral-400 uppercase tracking-[0.2em] mt-2 mb-8",children:"No more drops to show right now"}),e.jsx("button",{onClick:G,className:"px-10 py-5 bg-[#830e4c] hover:bg-[#830e4c]/90 text-white text-[10px] font-black uppercase tracking-[0.2em] rounded-2xl shadow-xl active:scale-95 transition-all",children:"Refresh Drops"})]}):e.jsx("div",{className:"h-full flex items-center justify-center px-2",children:e.jsx(Bs,{type:t==="services"?"services":"barter"})})})}),e.jsx(Vs,{product:M,onClose:()=>te(null),onShare:le,onSellerClick:_e,onSendRequest:()=>{M&&(Q("up",M),te(null))},hasValidToken:N,onLogin:w}),e.jsx(Hs,{isOpen:C,onClose:()=>v(!1),likedItems:u,onItemClick:z=>{v(!1),te(z)},onRemove:P}),e.jsx(Gs,{isOpen:k,onClose:()=>o(!1),activeCategory:s,onCategorySelect:z=>{a(z),o(!1)},activeTab:t}),e.jsx(Xs,{isOpen:j,onClose:()=>y(!1),currentCity:n,cities:l,onCitySelect:z=>{i(z),y(!1)}}),e.jsx(Z,{children:T&&ae&&e.jsxs($.div,{initial:{opacity:0,y:50,x:"-50%",scale:.9},animate:{opacity:1,y:0,x:"-50%",scale:1},exit:{opacity:0,y:40,x:"-50%",scale:.9},className:"fixed bottom-36 left-1/2 -translate-x-1/2 w-[85%] max-w-[340px] bg-white/20 backdrop-blur-[40px] px-5 py-4 rounded-[2.5rem] flex items-center gap-4 z-[200] shadow-[0_25px_60px_-12px_rgba(0,0,0,0.12)] border border-white/40 ring-1 ring-black/5",children:[e.jsx("div",{className:"w-12 h-12 rounded-2xl overflow-hidden shadow-md flex-shrink-0 border border-white/50",children:e.jsx("img",{src:ae.images[0],className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex flex-col flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[e.jsx(ne,{size:10,className:"text-[#29B3F0]",fill:"currentColor"}),e.jsx("span",{className:"text-[9px] font-black uppercase tracking-[0.2em] text-[#29B3F0] leading-none",children:"Super Interest Sent!"})]}),e.jsxs("span",{className:"text-[11px] font-black uppercase tracking-tight text-neutral-900 truncate",children:["Request sent for ",ae.name]})]})]})})]})};export{xa as D,q as E,da as M,ua as P,oa as U,ca as W,Pe as a,es as b,Ee as c,W as f,xe as g,la as r,ia as s,wt as t,ta as u};
