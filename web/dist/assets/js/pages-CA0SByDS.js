import{j as e,m as V,A as xe,u as $t,a as We,b as Ie}from"./vendor-framer-BUk_mL6S.js";import{g as Mr,r as j,u as Ye,a as Wr,b as Br,R as Fe,c as Hr}from"./vendor-react-mETsQ2lE.js";import{L as Vr,S as Kr,P as Xr,a as at,T as _s,M as Pe,X as Be,I as Jr,b as Dt,A as Cs,c as Qr,E as Yr,d as Qe,C as Ue,e as be,f as Ps,g as Me,h as Es,i as Ts,j as Gr,k as Zr,l as Mt,m as ei,H as Ge,B as qt,n as St,o as Ee,Z as je,p as Is,q as ot,r as As,s as _t,t as ti,u as ps,v as Ls,w as si,x as Ut,y as fs,z as ni,D as ri,F as Ct,G as ii,J as ai,K as Wt,N as Rs,O as oi,Q as Je,R as ci,U as li,V as di,W as ui,Y as hi,_ as pi,$ as fi,a0 as ms,a1 as Pt,a2 as Et,a3 as xs,a4 as Tt,a5 as It,a6 as At,a7 as Lt,a8 as gs,a9 as mi,aa as Ft,ab as xi,ac as gi,ad as bi}from"./vendor-icons-Duy5fzZO.js";import{u as ge,a as ve,b as fe}from"./vendor-query-BDtb7VjF.js";class Bt{constructor(){this.notificationCreatedEvent=".Illuminate\\Notifications\\Events\\BroadcastNotificationCreated"}listenForWhisper(i,o){return this.listen(".client-"+i,o)}notification(i){return this.listen(this.notificationCreatedEvent,i)}stopListeningForNotification(i){return this.stopListening(this.notificationCreatedEvent,i)}stopListeningForWhisper(i,o){return this.stopListening(".client-"+i,o)}}class zs{constructor(i){this.namespace=i}format(i){return[".","\\"].includes(i.charAt(0))?i.substring(1):(this.namespace&&(i=this.namespace+"."+i),i.replace(/\./g,"\\"))}setNamespace(i){this.namespace=i}}function vi(r){try{new r}catch(i){if(i instanceof Error&&i.message.includes("is not a constructor"))return!1}return!0}class Ht extends Bt{constructor(i,o,d){super(),this.name=o,this.pusher=i,this.options=d,this.eventFormatter=new zs(this.options.namespace),this.subscribe()}subscribe(){this.subscription=this.pusher.subscribe(this.name)}unsubscribe(){this.pusher.unsubscribe(this.name)}listen(i,o){return this.on(this.eventFormatter.format(i),o),this}listenToAll(i){return this.subscription.bind_global((o,d)=>{if(o.startsWith("pusher:"))return;let u=String(this.options.namespace??"").replace(/\./g,"\\"),h=o.startsWith(u)?o.substring(u.length+1):"."+o;i(h,d)}),this}stopListening(i,o){return o?this.subscription.unbind(this.eventFormatter.format(i),o):this.subscription.unbind(this.eventFormatter.format(i)),this}stopListeningToAll(i){return i?this.subscription.unbind_global(i):this.subscription.unbind_global(),this}subscribed(i){return this.on("pusher:subscription_succeeded",()=>{i()}),this}error(i){return this.on("pusher:subscription_error",o=>{i(o)}),this}on(i,o){return this.subscription.bind(i,o),this}}class Os extends Ht{whisper(i,o){return this.pusher.channels.channels[this.name].trigger(`client-${i}`,o),this}}class wi extends Ht{whisper(i,o){return this.pusher.channels.channels[this.name].trigger(`client-${i}`,o),this}}class yi extends Os{here(i){return this.on("pusher:subscription_succeeded",o=>{i(Object.keys(o.members).map(d=>o.members[d]))}),this}joining(i){return this.on("pusher:member_added",o=>{i(o.info)}),this}whisper(i,o){return this.pusher.channels.channels[this.name].trigger(`client-${i}`,o),this}leaving(i){return this.on("pusher:member_removed",o=>{i(o.info)}),this}}class qs extends Bt{constructor(i,o,d){super(),this.events={},this.listeners={},this.name=o,this.socket=i,this.options=d,this.eventFormatter=new zs(this.options.namespace),this.subscribe()}subscribe(){this.socket.emit("subscribe",{channel:this.name,auth:this.options.auth||{}})}unsubscribe(){this.unbind(),this.socket.emit("unsubscribe",{channel:this.name,auth:this.options.auth||{}})}listen(i,o){return this.on(this.eventFormatter.format(i),o),this}stopListening(i,o){return this.unbindEvent(this.eventFormatter.format(i),o),this}subscribed(i){return this.on("connect",o=>{i(o)}),this}error(i){return this}on(i,o){return this.listeners[i]=this.listeners[i]||[],this.events[i]||(this.events[i]=(d,u)=>{this.name===d&&this.listeners[i]&&this.listeners[i].forEach(h=>h(u))},this.socket.on(i,this.events[i])),this.listeners[i].push(o),this}unbind(){Object.keys(this.events).forEach(i=>{this.unbindEvent(i)})}unbindEvent(i,o){this.listeners[i]=this.listeners[i]||[],o&&(this.listeners[i]=this.listeners[i].filter(d=>d!==o)),(!o||this.listeners[i].length===0)&&(this.events[i]&&(this.socket.removeListener(i,this.events[i]),delete this.events[i]),delete this.listeners[i])}}class Us extends qs{whisper(i,o){return this.socket.emit("client event",{channel:this.name,event:`client-${i}`,data:o}),this}}class ji extends Us{here(i){return this.on("presence:subscribed",o=>{i(o.map(d=>d.user_info))}),this}joining(i){return this.on("presence:joining",o=>i(o.user_info)),this}whisper(i,o){return this.socket.emit("client event",{channel:this.name,event:`client-${i}`,data:o}),this}leaving(i){return this.on("presence:leaving",o=>i(o.user_info)),this}}class ct extends Bt{subscribe(){}unsubscribe(){}listen(i,o){return this}listenToAll(i){return this}stopListening(i,o){return this}subscribed(i){return this}error(i){return this}on(i,o){return this}}class Fs extends ct{whisper(i,o){return this}}class ki extends ct{whisper(i,o){return this}}class Ni extends Fs{here(i){return this}joining(i){return this}whisper(i,o){return this}leaving(i){return this}}const $s=class Ds{constructor(i){this.setOptions(i),this.connect()}setOptions(i){this.options={...Ds._defaultOptions,...i,broadcaster:i.broadcaster};let o=this.csrfToken();o&&(this.options.auth.headers["X-CSRF-TOKEN"]=o,this.options.userAuthentication.headers["X-CSRF-TOKEN"]=o),o=this.options.bearerToken,o&&(this.options.auth.headers.Authorization="Bearer "+o,this.options.userAuthentication.headers.Authorization="Bearer "+o)}csrfToken(){var i,o;return typeof window<"u"&&(i=window.Laravel)!=null&&i.csrfToken?window.Laravel.csrfToken:this.options.csrfToken?this.options.csrfToken:typeof document<"u"&&typeof document.querySelector=="function"?((o=document.querySelector('meta[name="csrf-token"]'))==null?void 0:o.getAttribute("content"))??null:null}};$s._defaultOptions={auth:{headers:{}},authEndpoint:"/broadcasting/auth",userAuthentication:{endpoint:"/broadcasting/user-auth",headers:{}},csrfToken:null,bearerToken:null,host:null,key:null,namespace:"App.Events"};let Vt=$s;class it extends Vt{constructor(){super(...arguments),this.channels={}}connect(){if(typeof this.options.client<"u")this.pusher=this.options.client;else if(this.options.Pusher)this.pusher=new this.options.Pusher(this.options.key,this.options);else if(typeof window<"u"&&typeof window.Pusher<"u")this.pusher=new window.Pusher(this.options.key,this.options);else throw new Error("Pusher client not found. Should be globally available or passed via options.client")}signin(){this.pusher.signin()}listen(i,o,d){return this.channel(i).listen(o,d)}channel(i){return this.channels[i]||(this.channels[i]=new Ht(this.pusher,i,this.options)),this.channels[i]}privateChannel(i){return this.channels["private-"+i]||(this.channels["private-"+i]=new Os(this.pusher,"private-"+i,this.options)),this.channels["private-"+i]}encryptedPrivateChannel(i){return this.channels["private-encrypted-"+i]||(this.channels["private-encrypted-"+i]=new wi(this.pusher,"private-encrypted-"+i,this.options)),this.channels["private-encrypted-"+i]}presenceChannel(i){return this.channels["presence-"+i]||(this.channels["presence-"+i]=new yi(this.pusher,"presence-"+i,this.options)),this.channels["presence-"+i]}leave(i){[i,"private-"+i,"private-encrypted-"+i,"presence-"+i].forEach(o=>{this.leaveChannel(o)})}leaveChannel(i){this.channels[i]&&(this.channels[i].unsubscribe(),delete this.channels[i])}socketId(){return this.pusher.connection.socket_id}connectionStatus(){const i=this.pusher.connection.state;switch(i){case"connected":case"connecting":return i;case"failed":case"unavailable":return"failed";default:return"disconnected"}}onConnectionChange(i){const o=()=>{i(this.connectionStatus())},d=["state_change","connected","disconnected"];return d.forEach(u=>{this.pusher.connection.bind(u,o)}),()=>{d.forEach(u=>{this.pusher.connection.unbind(u,o)})}}disconnect(){this.pusher.disconnect()}}class Si extends Vt{constructor(){super(...arguments),this.channels={}}connect(){let i=this.getSocketIO();this.socket=i(this.options.host??void 0,this.options),this.socket.io.on("reconnect",()=>{Object.values(this.channels).forEach(o=>{o.subscribe()})})}getSocketIO(){if(typeof this.options.client<"u")return this.options.client;if(typeof window<"u"&&typeof window.io<"u")return window.io;throw new Error("Socket.io client not found. Should be globally available or passed via options.client")}listen(i,o,d){return this.channel(i).listen(o,d)}channel(i){return this.channels[i]||(this.channels[i]=new qs(this.socket,i,this.options)),this.channels[i]}privateChannel(i){return this.channels["private-"+i]||(this.channels["private-"+i]=new Us(this.socket,"private-"+i,this.options)),this.channels["private-"+i]}presenceChannel(i){return this.channels["presence-"+i]||(this.channels["presence-"+i]=new ji(this.socket,"presence-"+i,this.options)),this.channels["presence-"+i]}leave(i){[i,"private-"+i,"presence-"+i].forEach(o=>{this.leaveChannel(o)})}leaveChannel(i){this.channels[i]&&(this.channels[i].unsubscribe(),delete this.channels[i])}socketId(){return this.socket.id}connectionStatus(){return this.socket.connected?"connected":this.socket.io._reconnecting?"reconnecting":this.socket.id!==void 0?"disconnected":"connecting"}onConnectionChange(i){const o=()=>{i(this.connectionStatus())},d=["connect","disconnect","connect_error","reconnect_attempt","reconnect","reconnect_error","reconnect_failed"];return d.forEach(u=>{this.socket.on(u,o)}),()=>{d.forEach(u=>{this.socket.off(u,o)})}}disconnect(){this.socket.disconnect()}}class bs extends Vt{constructor(){super(...arguments),this.channels={}}connect(){}listen(i,o,d){return new ct}channel(i){return new ct}privateChannel(i){return new Fs}encryptedPrivateChannel(i){return new ki}presenceChannel(i){return new Ni}leave(i){}leaveChannel(i){}socketId(){return"fake-socket-id"}connectionStatus(){return"connected"}onConnectionChange(i){return()=>{}}disconnect(){}}class _i{constructor(i){this.options=i,this.connect(),this.options.withoutInterceptors||this.registerInterceptors()}channel(i){return this.connector.channel(i)}connect(){if(this.options.broadcaster==="reverb")this.connector=new it({...this.options,cluster:""});else if(this.options.broadcaster==="pusher")this.connector=new it(this.options);else if(this.options.broadcaster==="ably")this.connector=new it({...this.options,cluster:"",broadcaster:"pusher"});else if(this.options.broadcaster==="socket.io")this.connector=new Si(this.options);else if(this.options.broadcaster==="null")this.connector=new bs(this.options);else if(typeof this.options.broadcaster=="function"&&vi(this.options.broadcaster))this.connector=new this.options.broadcaster(this.options);else throw new Error(`Broadcaster ${typeof this.options.broadcaster} ${String(this.options.broadcaster)} is not supported.`)}disconnect(){this.connector.disconnect()}join(i){return this.connector.presenceChannel(i)}leave(i){this.connector.leave(i)}leaveChannel(i){this.connector.leaveChannel(i)}leaveAllChannels(){for(const i in this.connector.channels)this.leaveChannel(i)}listen(i,o,d){return this.connector.listen(i,o,d)}private(i){return this.connector.privateChannel(i)}encryptedPrivate(i){if(this.connectorSupportsEncryptedPrivateChannels(this.connector))return this.connector.encryptedPrivateChannel(i);throw new Error(`Broadcaster ${typeof this.options.broadcaster} ${String(this.options.broadcaster)} does not support encrypted private channels.`)}connectorSupportsEncryptedPrivateChannels(i){return i instanceof it||i instanceof bs}socketId(){return this.connector.socketId()}connectionStatus(){return this.connector.connectionStatus()}registerInterceptors(){typeof Vue<"u"&&Vue!=null&&Vue.http&&this.registerVueRequestInterceptor(),typeof axios=="function"&&this.registerAxiosRequestInterceptor(),typeof jQuery=="function"&&this.registerjQueryAjaxSetup(),typeof Turbo=="object"&&this.registerTurboRequestInterceptor()}registerVueRequestInterceptor(){Vue.http.interceptors.push((i,o)=>{this.socketId()&&i.headers.set("X-Socket-ID",this.socketId()),o()})}registerAxiosRequestInterceptor(){axios.interceptors.request.use(i=>(this.socketId()&&(i.headers["X-Socket-Id"]=this.socketId()),i))}registerjQueryAjaxSetup(){typeof jQuery.ajax<"u"&&jQuery.ajaxPrefilter((i,o,d)=>{this.socketId()&&d.setRequestHeader("X-Socket-Id",this.socketId())})}registerTurboRequestInterceptor(){document.addEventListener("turbo:before-fetch-request",i=>{i.detail.fetchOptions.headers["X-Socket-Id"]=this.socketId()})}}var Rt={exports:{}};/*!
 * Pusher JavaScript Library v8.4.0
 * https://pusher.com/
 *
 * Copyright 2020, Pusher
 * Released under the MIT licence.
 */var vs;function Ci(){return vs||(vs=1,(function(r,i){(function(d,u){r.exports=u()})(window,function(){return(function(o){var d={};function u(h){if(d[h])return d[h].exports;var p=d[h]={i:h,l:!1,exports:{}};return o[h].call(p.exports,p,p.exports,u),p.l=!0,p.exports}return u.m=o,u.c=d,u.d=function(h,p,k){u.o(h,p)||Object.defineProperty(h,p,{enumerable:!0,get:k})},u.r=function(h){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(h,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(h,"__esModule",{value:!0})},u.t=function(h,p){if(p&1&&(h=u(h)),p&8||p&4&&typeof h=="object"&&h&&h.__esModule)return h;var k=Object.create(null);if(u.r(k),Object.defineProperty(k,"default",{enumerable:!0,value:h}),p&2&&typeof h!="string")for(var l in h)u.d(k,l,(function(A){return h[A]}).bind(null,l));return k},u.n=function(h){var p=h&&h.__esModule?function(){return h.default}:function(){return h};return u.d(p,"a",p),p},u.o=function(h,p){return Object.prototype.hasOwnProperty.call(h,p)},u.p="",u(u.s=2)})([(function(o,d,u){var h=this&&this.__extends||(function(){var v=function(m,b){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(P,y){P.__proto__=y}||function(P,y){for(var f in y)y.hasOwnProperty(f)&&(P[f]=y[f])},v(m,b)};return function(m,b){v(m,b);function P(){this.constructor=m}m.prototype=b===null?Object.create(b):(P.prototype=b.prototype,new P)}})();Object.defineProperty(d,"__esModule",{value:!0});var p=256,k=(function(){function v(m){m===void 0&&(m="="),this._paddingCharacter=m}return v.prototype.encodedLength=function(m){return this._paddingCharacter?(m+2)/3*4|0:(m*8+5)/6|0},v.prototype.encode=function(m){for(var b="",P=0;P<m.length-2;P+=3){var y=m[P]<<16|m[P+1]<<8|m[P+2];b+=this._encodeByte(y>>>18&63),b+=this._encodeByte(y>>>12&63),b+=this._encodeByte(y>>>6&63),b+=this._encodeByte(y>>>0&63)}var f=m.length-P;if(f>0){var y=m[P]<<16|(f===2?m[P+1]<<8:0);b+=this._encodeByte(y>>>18&63),b+=this._encodeByte(y>>>12&63),f===2?b+=this._encodeByte(y>>>6&63):b+=this._paddingCharacter||"",b+=this._paddingCharacter||""}return b},v.prototype.maxDecodedLength=function(m){return this._paddingCharacter?m/4*3|0:(m*6+7)/8|0},v.prototype.decodedLength=function(m){return this.maxDecodedLength(m.length-this._getPaddingLength(m))},v.prototype.decode=function(m){if(m.length===0)return new Uint8Array(0);for(var b=this._getPaddingLength(m),P=m.length-b,y=new Uint8Array(this.maxDecodedLength(P)),f=0,S=0,U=0,R=0,J=0,Z=0,ee=0;S<P-4;S+=4)R=this._decodeChar(m.charCodeAt(S+0)),J=this._decodeChar(m.charCodeAt(S+1)),Z=this._decodeChar(m.charCodeAt(S+2)),ee=this._decodeChar(m.charCodeAt(S+3)),y[f++]=R<<2|J>>>4,y[f++]=J<<4|Z>>>2,y[f++]=Z<<6|ee,U|=R&p,U|=J&p,U|=Z&p,U|=ee&p;if(S<P-1&&(R=this._decodeChar(m.charCodeAt(S)),J=this._decodeChar(m.charCodeAt(S+1)),y[f++]=R<<2|J>>>4,U|=R&p,U|=J&p),S<P-2&&(Z=this._decodeChar(m.charCodeAt(S+2)),y[f++]=J<<4|Z>>>2,U|=Z&p),S<P-3&&(ee=this._decodeChar(m.charCodeAt(S+3)),y[f++]=Z<<6|ee,U|=ee&p),U!==0)throw new Error("Base64Coder: incorrect characters for decoding");return y},v.prototype._encodeByte=function(m){var b=m;return b+=65,b+=25-m>>>8&6,b+=51-m>>>8&-75,b+=61-m>>>8&-15,b+=62-m>>>8&3,String.fromCharCode(b)},v.prototype._decodeChar=function(m){var b=p;return b+=(42-m&m-44)>>>8&-p+m-43+62,b+=(46-m&m-48)>>>8&-p+m-47+63,b+=(47-m&m-58)>>>8&-p+m-48+52,b+=(64-m&m-91)>>>8&-p+m-65+0,b+=(96-m&m-123)>>>8&-p+m-97+26,b},v.prototype._getPaddingLength=function(m){var b=0;if(this._paddingCharacter){for(var P=m.length-1;P>=0&&m[P]===this._paddingCharacter;P--)b++;if(m.length<4||b>2)throw new Error("Base64Coder: incorrect padding")}return b},v})();d.Coder=k;var l=new k;function A(v){return l.encode(v)}d.encode=A;function N(v){return l.decode(v)}d.decode=N;var T=(function(v){h(m,v);function m(){return v!==null&&v.apply(this,arguments)||this}return m.prototype._encodeByte=function(b){var P=b;return P+=65,P+=25-b>>>8&6,P+=51-b>>>8&-75,P+=61-b>>>8&-13,P+=62-b>>>8&49,String.fromCharCode(P)},m.prototype._decodeChar=function(b){var P=p;return P+=(44-b&b-46)>>>8&-p+b-45+62,P+=(94-b&b-96)>>>8&-p+b-95+63,P+=(47-b&b-58)>>>8&-p+b-48+52,P+=(64-b&b-91)>>>8&-p+b-65+0,P+=(96-b&b-123)>>>8&-p+b-97+26,P},m})(k);d.URLSafeCoder=T;var _=new T;function E(v){return _.encode(v)}d.encodeURLSafe=E;function x(v){return _.decode(v)}d.decodeURLSafe=x,d.encodedLength=function(v){return l.encodedLength(v)},d.maxDecodedLength=function(v){return l.maxDecodedLength(v)},d.decodedLength=function(v){return l.decodedLength(v)}}),(function(o,d,u){Object.defineProperty(d,"__esModule",{value:!0});var h="utf8: invalid string",p="utf8: invalid source encoding";function k(N){for(var T=new Uint8Array(l(N)),_=0,E=0;E<N.length;E++){var x=N.charCodeAt(E);x<128?T[_++]=x:x<2048?(T[_++]=192|x>>6,T[_++]=128|x&63):x<55296?(T[_++]=224|x>>12,T[_++]=128|x>>6&63,T[_++]=128|x&63):(E++,x=(x&1023)<<10,x|=N.charCodeAt(E)&1023,x+=65536,T[_++]=240|x>>18,T[_++]=128|x>>12&63,T[_++]=128|x>>6&63,T[_++]=128|x&63)}return T}d.encode=k;function l(N){for(var T=0,_=0;_<N.length;_++){var E=N.charCodeAt(_);if(E<128)T+=1;else if(E<2048)T+=2;else if(E<55296)T+=3;else if(E<=57343){if(_>=N.length-1)throw new Error(h);_++,T+=4}else throw new Error(h)}return T}d.encodedLength=l;function A(N){for(var T=[],_=0;_<N.length;_++){var E=N[_];if(E&128){var x=void 0;if(E<224){if(_>=N.length)throw new Error(p);var v=N[++_];if((v&192)!==128)throw new Error(p);E=(E&31)<<6|v&63,x=128}else if(E<240){if(_>=N.length-1)throw new Error(p);var v=N[++_],m=N[++_];if((v&192)!==128||(m&192)!==128)throw new Error(p);E=(E&15)<<12|(v&63)<<6|m&63,x=2048}else if(E<248){if(_>=N.length-2)throw new Error(p);var v=N[++_],m=N[++_],b=N[++_];if((v&192)!==128||(m&192)!==128||(b&192)!==128)throw new Error(p);E=(E&15)<<18|(v&63)<<12|(m&63)<<6|b&63,x=65536}else throw new Error(p);if(E<x||E>=55296&&E<=57343)throw new Error(p);if(E>=65536){if(E>1114111)throw new Error(p);E-=65536,T.push(String.fromCharCode(55296|E>>10)),E=56320|E&1023}}T.push(String.fromCharCode(E))}return T.join("")}d.decode=A}),(function(o,d,u){o.exports=u(3).default}),(function(o,d,u){u.r(d);class h{constructor(t,s){this.lastId=0,this.prefix=t,this.name=s}create(t){this.lastId++;var s=this.lastId,a=this.prefix+s,c=this.name+"["+s+"]",g=!1,I=function(){g||(t.apply(null,arguments),g=!0)};return this[s]=I,{number:s,id:a,name:c,callback:I}}remove(t){delete this[t.number]}}var p=new h("_pusher_script_","Pusher.ScriptReceivers"),k={VERSION:"8.4.0",PROTOCOL:7,wsPort:80,wssPort:443,wsPath:"",httpHost:"sockjs.pusher.com",httpPort:80,httpsPort:443,httpPath:"/pusher",stats_host:"stats.pusher.com",authEndpoint:"/pusher/auth",authTransport:"ajax",activityTimeout:12e4,pongTimeout:3e4,unavailableTimeout:1e4,userAuthentication:{endpoint:"/pusher/user-auth",transport:"ajax"},channelAuthorization:{endpoint:"/pusher/auth",transport:"ajax"},cdn_http:"http://js.pusher.com",cdn_https:"https://js.pusher.com",dependency_suffix:""},l=k;class A{constructor(t){this.options=t,this.receivers=t.receivers||p,this.loading={}}load(t,s,a){var c=this;if(c.loading[t]&&c.loading[t].length>0)c.loading[t].push(a);else{c.loading[t]=[a];var g=W.createScriptRequest(c.getPath(t,s)),I=c.receivers.create(function(q){if(c.receivers.remove(I),c.loading[t]){var M=c.loading[t];delete c.loading[t];for(var Y=function(ue){ue||g.cleanup()},se=0;se<M.length;se++)M[se](q,Y)}});g.send(I)}}getRoot(t){var s,a=W.getDocument().location.protocol;return t&&t.useTLS||a==="https:"?s=this.options.cdn_https:s=this.options.cdn_http,s.replace(/\/*$/,"")+"/"+this.options.version}getPath(t,s){return this.getRoot(s)+"/"+t+this.options.suffix+".js"}}var N=new h("_pusher_dependencies","Pusher.DependenciesReceivers"),T=new A({cdn_http:l.cdn_http,cdn_https:l.cdn_https,version:l.VERSION,suffix:l.dependency_suffix,receivers:N});const _={baseUrl:"https://pusher.com",urls:{authenticationEndpoint:{path:"/docs/channels/server_api/authenticating_users"},authorizationEndpoint:{path:"/docs/channels/server_api/authorizing-users/"},javascriptQuickStart:{path:"/docs/javascript_quick_start"},triggeringClientEvents:{path:"/docs/client_api_guide/client_events#trigger-events"},encryptedChannelSupport:{fullUrl:"https://github.com/pusher/pusher-js/tree/cc491015371a4bde5743d1c87a0fbac0feb53195#encrypted-channel-support"}}};var x={buildLogSuffix:function(n){const t="See:",s=_.urls[n];if(!s)return"";let a;return s.fullUrl?a=s.fullUrl:s.path&&(a=_.baseUrl+s.path),a?`${t} ${a}`:""}},v;(function(n){n.UserAuthentication="user-authentication",n.ChannelAuthorization="channel-authorization"})(v||(v={}));class m extends Error{constructor(t){super(t),Object.setPrototypeOf(this,new.target.prototype)}}class b extends Error{constructor(t){super(t),Object.setPrototypeOf(this,new.target.prototype)}}class P extends Error{constructor(t){super(t),Object.setPrototypeOf(this,new.target.prototype)}}class y extends Error{constructor(t){super(t),Object.setPrototypeOf(this,new.target.prototype)}}class f extends Error{constructor(t){super(t),Object.setPrototypeOf(this,new.target.prototype)}}class S extends Error{constructor(t){super(t),Object.setPrototypeOf(this,new.target.prototype)}}class U extends Error{constructor(t){super(t),Object.setPrototypeOf(this,new.target.prototype)}}class R extends Error{constructor(t){super(t),Object.setPrototypeOf(this,new.target.prototype)}}class J extends Error{constructor(t,s){super(s),this.status=t,Object.setPrototypeOf(this,new.target.prototype)}}var ee=function(n,t,s,a,c){const g=W.createXHR();g.open("POST",s.endpoint,!0),g.setRequestHeader("Content-Type","application/x-www-form-urlencoded");for(var I in s.headers)g.setRequestHeader(I,s.headers[I]);if(s.headersProvider!=null){let q=s.headersProvider();for(var I in q)g.setRequestHeader(I,q[I])}return g.onreadystatechange=function(){if(g.readyState===4)if(g.status===200){let q,M=!1;try{q=JSON.parse(g.responseText),M=!0}catch{c(new J(200,`JSON returned from ${a.toString()} endpoint was invalid, yet status code was 200. Data was: ${g.responseText}`),null)}M&&c(null,q)}else{let q="";switch(a){case v.UserAuthentication:q=x.buildLogSuffix("authenticationEndpoint");break;case v.ChannelAuthorization:q=`Clients must be authorized to join private or presence channels. ${x.buildLogSuffix("authorizationEndpoint")}`;break}c(new J(g.status,`Unable to retrieve auth string from ${a.toString()} endpoint - received status: ${g.status} from ${s.endpoint}. ${q}`),null)}},g.send(t),g};function re(n){return le(Q(n))}var B=String.fromCharCode,z="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",L=function(n){var t=n.charCodeAt(0);return t<128?n:t<2048?B(192|t>>>6)+B(128|t&63):B(224|t>>>12&15)+B(128|t>>>6&63)+B(128|t&63)},Q=function(n){return n.replace(/[^\x00-\x7F]/g,L)},X=function(n){var t=[0,2,1][n.length%3],s=n.charCodeAt(0)<<16|(n.length>1?n.charCodeAt(1):0)<<8|(n.length>2?n.charCodeAt(2):0),a=[z.charAt(s>>>18),z.charAt(s>>>12&63),t>=2?"=":z.charAt(s>>>6&63),t>=1?"=":z.charAt(s&63)];return a.join("")},le=window.btoa||function(n){return n.replace(/[\s\S]{1,3}/g,X)};class me{constructor(t,s,a,c){this.clear=s,this.timer=t(()=>{this.timer&&(this.timer=c(this.timer))},a)}isRunning(){return this.timer!==null}ensureAborted(){this.timer&&(this.clear(this.timer),this.timer=null)}}var Ne=me;function Se(n){window.clearTimeout(n)}function O(n){window.clearInterval(n)}class K extends Ne{constructor(t,s){super(setTimeout,Se,t,function(a){return s(),null})}}class ae extends Ne{constructor(t,s){super(setInterval,O,t,function(a){return s(),a})}}var we={now(){return Date.now?Date.now():new Date().valueOf()},defer(n){return new K(0,n)},method(n,...t){var s=Array.prototype.slice.call(arguments,1);return function(a){return a[n].apply(a,s.concat(arguments))}}},w=we;function $(n,...t){for(var s=0;s<t.length;s++){var a=t[s];for(var c in a)a[c]&&a[c].constructor&&a[c].constructor===Object?n[c]=$(n[c]||{},a[c]):n[c]=a[c]}return n}function ce(){for(var n=["Pusher"],t=0;t<arguments.length;t++)typeof arguments[t]=="string"?n.push(arguments[t]):n.push(et(arguments[t]));return n.join(" : ")}function he(n,t){var s=Array.prototype.indexOf;if(n===null)return-1;if(s&&n.indexOf===s)return n.indexOf(t);for(var a=0,c=n.length;a<c;a++)if(n[a]===t)return a;return-1}function C(n,t){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&t(n[s],s,n)}function H(n){var t=[];return C(n,function(s,a){t.push(a)}),t}function F(n){var t=[];return C(n,function(s){t.push(s)}),t}function D(n,t,s){for(var a=0;a<n.length;a++)t.call(s||window,n[a],a,n)}function te(n,t){for(var s=[],a=0;a<n.length;a++)s.push(t(n[a],a,n,s));return s}function ie(n,t){var s={};return C(n,function(a,c){s[c]=t(a)}),s}function de(n,t){t=t||function(c){return!!c};for(var s=[],a=0;a<n.length;a++)t(n[a],a,n,s)&&s.push(n[a]);return s}function ye(n,t){var s={};return C(n,function(a,c){(t&&t(a,c,n,s)||a)&&(s[c]=a)}),s}function Ae(n){var t=[];return C(n,function(s,a){t.push([a,s])}),t}function Le(n,t){for(var s=0;s<n.length;s++)if(t(n[s],s,n))return!0;return!1}function He(n,t){for(var s=0;s<n.length;s++)if(!t(n[s],s,n))return!1;return!0}function Ve(n){return ie(n,function(t){return typeof t=="object"&&(t=et(t)),encodeURIComponent(re(t.toString()))})}function Ks(n){var t=ye(n,function(a){return a!==void 0}),s=te(Ae(Ve(t)),w.method("join","=")).join("&");return s}function Xs(n){var t=[],s=[];return(function a(c,g){var I,q,M;switch(typeof c){case"object":if(!c)return null;for(I=0;I<t.length;I+=1)if(t[I]===c)return{$ref:s[I]};if(t.push(c),s.push(g),Object.prototype.toString.apply(c)==="[object Array]")for(M=[],I=0;I<c.length;I+=1)M[I]=a(c[I],g+"["+I+"]");else{M={};for(q in c)Object.prototype.hasOwnProperty.call(c,q)&&(M[q]=a(c[q],g+"["+JSON.stringify(q)+"]"))}return M;case"number":case"string":case"boolean":return c}})(n,"$")}function et(n){try{return JSON.stringify(n)}catch{return JSON.stringify(Xs(n))}}class Js{constructor(){this.globalLog=t=>{window.console&&window.console.log&&window.console.log(t)}}debug(...t){this.log(this.globalLog,t)}warn(...t){this.log(this.globalLogWarn,t)}error(...t){this.log(this.globalLogError,t)}globalLogWarn(t){window.console&&window.console.warn?window.console.warn(t):this.globalLog(t)}globalLogError(t){window.console&&window.console.error?window.console.error(t):this.globalLogWarn(t)}log(t,...s){var a=ce.apply(this,arguments);jt.log?jt.log(a):jt.logToConsole&&t.bind(this)(a)}}var oe=new Js,Qs=function(n,t,s,a,c){(s.headers!==void 0||s.headersProvider!=null)&&oe.warn(`To send headers with the ${a.toString()} request, you must use AJAX, rather than JSONP.`);var g=n.nextAuthCallbackID.toString();n.nextAuthCallbackID++;var I=n.getDocument(),q=I.createElement("script");n.auth_callbacks[g]=function(se){c(null,se)};var M="Pusher.auth_callbacks['"+g+"']";q.src=s.endpoint+"?callback="+encodeURIComponent(M)+"&"+t;var Y=I.getElementsByTagName("head")[0]||I.documentElement;Y.insertBefore(q,Y.firstChild)},Ys=Qs;class Gs{constructor(t){this.src=t}send(t){var s=this,a="Error loading "+s.src;s.script=document.createElement("script"),s.script.id=t.id,s.script.src=s.src,s.script.type="text/javascript",s.script.charset="UTF-8",s.script.addEventListener?(s.script.onerror=function(){t.callback(a)},s.script.onload=function(){t.callback(null)}):s.script.onreadystatechange=function(){(s.script.readyState==="loaded"||s.script.readyState==="complete")&&t.callback(null)},s.script.async===void 0&&document.attachEvent&&/opera/i.test(navigator.userAgent)?(s.errorScript=document.createElement("script"),s.errorScript.id=t.id+"_error",s.errorScript.text=t.name+"('"+a+"');",s.script.async=s.errorScript.async=!1):s.script.async=!0;var c=document.getElementsByTagName("head")[0];c.insertBefore(s.script,c.firstChild),s.errorScript&&c.insertBefore(s.errorScript,s.script.nextSibling)}cleanup(){this.script&&(this.script.onload=this.script.onerror=null,this.script.onreadystatechange=null),this.script&&this.script.parentNode&&this.script.parentNode.removeChild(this.script),this.errorScript&&this.errorScript.parentNode&&this.errorScript.parentNode.removeChild(this.errorScript),this.script=null,this.errorScript=null}}class Zs{constructor(t,s){this.url=t,this.data=s}send(t){if(!this.request){var s=Ks(this.data),a=this.url+"/"+t.number+"?"+s;this.request=W.createScriptRequest(a),this.request.send(t)}}cleanup(){this.request&&this.request.cleanup()}}var en=function(n,t){return function(s,a){var c="http"+(t?"s":"")+"://",g=c+(n.host||n.options.host)+n.options.path,I=W.createJSONPRequest(g,s),q=W.ScriptReceivers.create(function(M,Y){p.remove(q),I.cleanup(),Y&&Y.host&&(n.host=Y.host),a&&a(M,Y)});I.send(q)}},tn={name:"jsonp",getAgent:en},sn=tn;function ht(n,t,s){var a=n+(t.useTLS?"s":""),c=t.useTLS?t.hostTLS:t.hostNonTLS;return a+"://"+c+s}function pt(n,t){var s="/app/"+n,a="?protocol="+l.PROTOCOL+"&client=js&version="+l.VERSION+(t?"&"+t:"");return s+a}var nn={getInitial:function(n,t){var s=(t.httpPath||"")+pt(n,"flash=false");return ht("ws",t,s)}},rn={getInitial:function(n,t){var s=(t.httpPath||"/pusher")+pt(n);return ht("http",t,s)}},an={getInitial:function(n,t){return ht("http",t,t.httpPath||"/pusher")},getPath:function(n,t){return pt(n)}};class on{constructor(){this._callbacks={}}get(t){return this._callbacks[ft(t)]}add(t,s,a){var c=ft(t);this._callbacks[c]=this._callbacks[c]||[],this._callbacks[c].push({fn:s,context:a})}remove(t,s,a){if(!t&&!s&&!a){this._callbacks={};return}var c=t?[ft(t)]:H(this._callbacks);s||a?this.removeCallback(c,s,a):this.removeAllCallbacks(c)}removeCallback(t,s,a){D(t,function(c){this._callbacks[c]=de(this._callbacks[c]||[],function(g){return s&&s!==g.fn||a&&a!==g.context}),this._callbacks[c].length===0&&delete this._callbacks[c]},this)}removeAllCallbacks(t){D(t,function(s){delete this._callbacks[s]},this)}}function ft(n){return"_"+n}class _e{constructor(t){this.callbacks=new on,this.global_callbacks=[],this.failThrough=t}bind(t,s,a){return this.callbacks.add(t,s,a),this}bind_global(t){return this.global_callbacks.push(t),this}unbind(t,s,a){return this.callbacks.remove(t,s,a),this}unbind_global(t){return t?(this.global_callbacks=de(this.global_callbacks||[],s=>s!==t),this):(this.global_callbacks=[],this)}unbind_all(){return this.unbind(),this.unbind_global(),this}emit(t,s,a){for(var c=0;c<this.global_callbacks.length;c++)this.global_callbacks[c](t,s);var g=this.callbacks.get(t),I=[];if(a?I.push(s,a):s&&I.push(s),g&&g.length>0)for(var c=0;c<g.length;c++)g[c].fn.apply(g[c].context||window,I);else this.failThrough&&this.failThrough(t,s);return this}}class cn extends _e{constructor(t,s,a,c,g){super(),this.initialize=W.transportConnectionInitializer,this.hooks=t,this.name=s,this.priority=a,this.key=c,this.options=g,this.state="new",this.timeline=g.timeline,this.activityTimeout=g.activityTimeout,this.id=this.timeline.generateUniqueID()}handlesActivityChecks(){return!!this.hooks.handlesActivityChecks}supportsPing(){return!!this.hooks.supportsPing}connect(){if(this.socket||this.state!=="initialized")return!1;var t=this.hooks.urls.getInitial(this.key,this.options);try{this.socket=this.hooks.getSocket(t,this.options)}catch(s){return w.defer(()=>{this.onError(s),this.changeState("closed")}),!1}return this.bindListeners(),oe.debug("Connecting",{transport:this.name,url:t}),this.changeState("connecting"),!0}close(){return this.socket?(this.socket.close(),!0):!1}send(t){return this.state==="open"?(w.defer(()=>{this.socket&&this.socket.send(t)}),!0):!1}ping(){this.state==="open"&&this.supportsPing()&&this.socket.ping()}onOpen(){this.hooks.beforeOpen&&this.hooks.beforeOpen(this.socket,this.hooks.urls.getPath(this.key,this.options)),this.changeState("open"),this.socket.onopen=void 0}onError(t){this.emit("error",{type:"WebSocketError",error:t}),this.timeline.error(this.buildTimelineMessage({error:t.toString()}))}onClose(t){t?this.changeState("closed",{code:t.code,reason:t.reason,wasClean:t.wasClean}):this.changeState("closed"),this.unbindListeners(),this.socket=void 0}onMessage(t){this.emit("message",t)}onActivity(){this.emit("activity")}bindListeners(){this.socket.onopen=()=>{this.onOpen()},this.socket.onerror=t=>{this.onError(t)},this.socket.onclose=t=>{this.onClose(t)},this.socket.onmessage=t=>{this.onMessage(t)},this.supportsPing()&&(this.socket.onactivity=()=>{this.onActivity()})}unbindListeners(){this.socket&&(this.socket.onopen=void 0,this.socket.onerror=void 0,this.socket.onclose=void 0,this.socket.onmessage=void 0,this.supportsPing()&&(this.socket.onactivity=void 0))}changeState(t,s){this.state=t,this.timeline.info(this.buildTimelineMessage({state:t,params:s})),this.emit(t,s)}buildTimelineMessage(t){return $({cid:this.id},t)}}class $e{constructor(t){this.hooks=t}isSupported(t){return this.hooks.isSupported(t)}createConnection(t,s,a,c){return new cn(this.hooks,t,s,a,c)}}var ln=new $e({urls:nn,handlesActivityChecks:!1,supportsPing:!1,isInitialized:function(){return!!W.getWebSocketAPI()},isSupported:function(){return!!W.getWebSocketAPI()},getSocket:function(n){return W.createWebSocket(n)}}),Kt={urls:rn,handlesActivityChecks:!1,supportsPing:!0,isInitialized:function(){return!0}},Xt=$({getSocket:function(n){return W.HTTPFactory.createStreamingSocket(n)}},Kt),Jt=$({getSocket:function(n){return W.HTTPFactory.createPollingSocket(n)}},Kt),Qt={isSupported:function(){return W.isXHRSupported()}},dn=new $e($({},Xt,Qt)),un=new $e($({},Jt,Qt)),hn={ws:ln,xhr_streaming:dn,xhr_polling:un},tt=hn,pn=new $e({file:"sockjs",urls:an,handlesActivityChecks:!0,supportsPing:!1,isSupported:function(){return!0},isInitialized:function(){return window.SockJS!==void 0},getSocket:function(n,t){return new window.SockJS(n,null,{js_path:T.getPath("sockjs",{useTLS:t.useTLS}),ignore_null_origin:t.ignoreNullOrigin})},beforeOpen:function(n,t){n.send(JSON.stringify({path:t}))}}),Yt={isSupported:function(n){var t=W.isXDRSupported(n.useTLS);return t}},fn=new $e($({},Xt,Yt)),mn=new $e($({},Jt,Yt));tt.xdr_streaming=fn,tt.xdr_polling=mn,tt.sockjs=pn;var xn=tt;class gn extends _e{constructor(){super();var t=this;window.addEventListener!==void 0&&(window.addEventListener("online",function(){t.emit("online")},!1),window.addEventListener("offline",function(){t.emit("offline")},!1))}isOnline(){return window.navigator.onLine===void 0?!0:window.navigator.onLine}}var bn=new gn;class vn{constructor(t,s,a){this.manager=t,this.transport=s,this.minPingDelay=a.minPingDelay,this.maxPingDelay=a.maxPingDelay,this.pingDelay=void 0}createConnection(t,s,a,c){c=$({},c,{activityTimeout:this.pingDelay});var g=this.transport.createConnection(t,s,a,c),I=null,q=function(){g.unbind("open",q),g.bind("closed",M),I=w.now()},M=Y=>{if(g.unbind("closed",M),Y.code===1002||Y.code===1003)this.manager.reportDeath();else if(!Y.wasClean&&I){var se=w.now()-I;se<2*this.maxPingDelay&&(this.manager.reportDeath(),this.pingDelay=Math.max(se/2,this.minPingDelay))}};return g.bind("open",q),g}isSupported(t){return this.manager.isAlive()&&this.transport.isSupported(t)}}const Gt={decodeMessage:function(n){try{var t=JSON.parse(n.data),s=t.data;if(typeof s=="string")try{s=JSON.parse(t.data)}catch{}var a={event:t.event,channel:t.channel,data:s};return t.user_id&&(a.user_id=t.user_id),a}catch(c){throw{type:"MessageParseError",error:c,data:n.data}}},encodeMessage:function(n){return JSON.stringify(n)},processHandshake:function(n){var t=Gt.decodeMessage(n);if(t.event==="pusher:connection_established"){if(!t.data.activity_timeout)throw"No activity timeout specified in handshake";return{action:"connected",id:t.data.socket_id,activityTimeout:t.data.activity_timeout*1e3}}else{if(t.event==="pusher:error")return{action:this.getCloseAction(t.data),error:this.getCloseError(t.data)};throw"Invalid handshake"}},getCloseAction:function(n){return n.code<4e3?n.code>=1002&&n.code<=1004?"backoff":null:n.code===4e3?"tls_only":n.code<4100?"refused":n.code<4200?"backoff":n.code<4300?"retry":"refused"},getCloseError:function(n){return n.code!==1e3&&n.code!==1001?{type:"PusherError",data:{code:n.code,message:n.reason||n.message}}:null}};var Re=Gt;class wn extends _e{constructor(t,s){super(),this.id=t,this.transport=s,this.activityTimeout=s.activityTimeout,this.bindListeners()}handlesActivityChecks(){return this.transport.handlesActivityChecks()}send(t){return this.transport.send(t)}send_event(t,s,a){var c={event:t,data:s};return a&&(c.channel=a),oe.debug("Event sent",c),this.send(Re.encodeMessage(c))}ping(){this.transport.supportsPing()?this.transport.ping():this.send_event("pusher:ping",{})}close(){this.transport.close()}bindListeners(){var t={message:a=>{var c;try{c=Re.decodeMessage(a)}catch(g){this.emit("error",{type:"MessageParseError",error:g,data:a.data})}if(c!==void 0){switch(oe.debug("Event recd",c),c.event){case"pusher:error":this.emit("error",{type:"PusherError",data:c.data});break;case"pusher:ping":this.emit("ping");break;case"pusher:pong":this.emit("pong");break}this.emit("message",c)}},activity:()=>{this.emit("activity")},error:a=>{this.emit("error",a)},closed:a=>{s(),a&&a.code&&this.handleCloseEvent(a),this.transport=null,this.emit("closed")}},s=()=>{C(t,(a,c)=>{this.transport.unbind(c,a)})};C(t,(a,c)=>{this.transport.bind(c,a)})}handleCloseEvent(t){var s=Re.getCloseAction(t),a=Re.getCloseError(t);a&&this.emit("error",a),s&&this.emit(s,{action:s,error:a})}}class yn{constructor(t,s){this.transport=t,this.callback=s,this.bindListeners()}close(){this.unbindListeners(),this.transport.close()}bindListeners(){this.onMessage=t=>{this.unbindListeners();var s;try{s=Re.processHandshake(t)}catch(a){this.finish("error",{error:a}),this.transport.close();return}s.action==="connected"?this.finish("connected",{connection:new wn(s.id,this.transport),activityTimeout:s.activityTimeout}):(this.finish(s.action,{error:s.error}),this.transport.close())},this.onClosed=t=>{this.unbindListeners();var s=Re.getCloseAction(t)||"backoff",a=Re.getCloseError(t);this.finish(s,{error:a})},this.transport.bind("message",this.onMessage),this.transport.bind("closed",this.onClosed)}unbindListeners(){this.transport.unbind("message",this.onMessage),this.transport.unbind("closed",this.onClosed)}finish(t,s){this.callback($({transport:this.transport,action:t},s))}}class jn{constructor(t,s){this.timeline=t,this.options=s||{}}send(t,s){this.timeline.isEmpty()||this.timeline.send(W.TimelineTransport.getAgent(this,t),s)}}class mt extends _e{constructor(t,s){super(function(a,c){oe.debug("No callbacks on "+t+" for "+a)}),this.name=t,this.pusher=s,this.subscribed=!1,this.subscriptionPending=!1,this.subscriptionCancelled=!1}authorize(t,s){return s(null,{auth:""})}trigger(t,s){if(t.indexOf("client-")!==0)throw new m("Event '"+t+"' does not start with 'client-'");if(!this.subscribed){var a=x.buildLogSuffix("triggeringClientEvents");oe.warn(`Client event triggered before channel 'subscription_succeeded' event . ${a}`)}return this.pusher.send_event(t,s,this.name)}disconnect(){this.subscribed=!1,this.subscriptionPending=!1}handleEvent(t){var s=t.event,a=t.data;if(s==="pusher_internal:subscription_succeeded")this.handleSubscriptionSucceededEvent(t);else if(s==="pusher_internal:subscription_count")this.handleSubscriptionCountEvent(t);else if(s.indexOf("pusher_internal:")!==0){var c={};this.emit(s,a,c)}}handleSubscriptionSucceededEvent(t){this.subscriptionPending=!1,this.subscribed=!0,this.subscriptionCancelled?this.pusher.unsubscribe(this.name):this.emit("pusher:subscription_succeeded",t.data)}handleSubscriptionCountEvent(t){t.data.subscription_count&&(this.subscriptionCount=t.data.subscription_count),this.emit("pusher:subscription_count",t.data)}subscribe(){this.subscribed||(this.subscriptionPending=!0,this.subscriptionCancelled=!1,this.authorize(this.pusher.connection.socket_id,(t,s)=>{t?(this.subscriptionPending=!1,oe.error(t.toString()),this.emit("pusher:subscription_error",Object.assign({},{type:"AuthError",error:t.message},t instanceof J?{status:t.status}:{}))):this.pusher.send_event("pusher:subscribe",{auth:s.auth,channel_data:s.channel_data,channel:this.name})}))}unsubscribe(){this.subscribed=!1,this.pusher.send_event("pusher:unsubscribe",{channel:this.name})}cancelSubscription(){this.subscriptionCancelled=!0}reinstateSubscription(){this.subscriptionCancelled=!1}}class xt extends mt{authorize(t,s){return this.pusher.config.channelAuthorizer({channelName:this.name,socketId:t},s)}}class kn{constructor(){this.reset()}get(t){return Object.prototype.hasOwnProperty.call(this.members,t)?{id:t,info:this.members[t]}:null}each(t){C(this.members,(s,a)=>{t(this.get(a))})}setMyID(t){this.myID=t}onSubscription(t){this.members=t.presence.hash,this.count=t.presence.count,this.me=this.get(this.myID)}addMember(t){return this.get(t.user_id)===null&&this.count++,this.members[t.user_id]=t.user_info,this.get(t.user_id)}removeMember(t){var s=this.get(t.user_id);return s&&(delete this.members[t.user_id],this.count--),s}reset(){this.members={},this.count=0,this.myID=null,this.me=null}}var Nn=function(n,t,s,a){function c(g){return g instanceof s?g:new s(function(I){I(g)})}return new(s||(s=Promise))(function(g,I){function q(se){try{Y(a.next(se))}catch(ue){I(ue)}}function M(se){try{Y(a.throw(se))}catch(ue){I(ue)}}function Y(se){se.done?g(se.value):c(se.value).then(q,M)}Y((a=a.apply(n,t||[])).next())})};class Sn extends xt{constructor(t,s){super(t,s),this.members=new kn}authorize(t,s){super.authorize(t,(a,c)=>Nn(this,void 0,void 0,function*(){if(!a)if(c=c,c.channel_data!=null){var g=JSON.parse(c.channel_data);this.members.setMyID(g.user_id)}else if(yield this.pusher.user.signinDonePromise,this.pusher.user.user_data!=null)this.members.setMyID(this.pusher.user.user_data.id);else{let I=x.buildLogSuffix("authorizationEndpoint");oe.error(`Invalid auth response for channel '${this.name}', expected 'channel_data' field. ${I}, or the user should be signed in.`),s("Invalid auth response");return}s(a,c)}))}handleEvent(t){var s=t.event;if(s.indexOf("pusher_internal:")===0)this.handleInternalEvent(t);else{var a=t.data,c={};t.user_id&&(c.user_id=t.user_id),this.emit(s,a,c)}}handleInternalEvent(t){var s=t.event,a=t.data;switch(s){case"pusher_internal:subscription_succeeded":this.handleSubscriptionSucceededEvent(t);break;case"pusher_internal:subscription_count":this.handleSubscriptionCountEvent(t);break;case"pusher_internal:member_added":var c=this.members.addMember(a);this.emit("pusher:member_added",c);break;case"pusher_internal:member_removed":var g=this.members.removeMember(a);g&&this.emit("pusher:member_removed",g);break}}handleSubscriptionSucceededEvent(t){this.subscriptionPending=!1,this.subscribed=!0,this.subscriptionCancelled?this.pusher.unsubscribe(this.name):(this.members.onSubscription(t.data),this.emit("pusher:subscription_succeeded",this.members))}disconnect(){this.members.reset(),super.disconnect()}}var _n=u(1),gt=u(0);class Cn extends xt{constructor(t,s,a){super(t,s),this.key=null,this.nacl=a}authorize(t,s){super.authorize(t,(a,c)=>{if(a){s(a,c);return}let g=c.shared_secret;if(!g){s(new Error(`No shared_secret key in auth payload for encrypted channel: ${this.name}`),null);return}this.key=Object(gt.decode)(g),delete c.shared_secret,s(null,c)})}trigger(t,s){throw new S("Client events are not currently supported for encrypted channels")}handleEvent(t){var s=t.event,a=t.data;if(s.indexOf("pusher_internal:")===0||s.indexOf("pusher:")===0){super.handleEvent(t);return}this.handleEncryptedEvent(s,a)}handleEncryptedEvent(t,s){if(!this.key){oe.debug("Received encrypted event before key has been retrieved from the authEndpoint");return}if(!s.ciphertext||!s.nonce){oe.error("Unexpected format for encrypted event, expected object with `ciphertext` and `nonce` fields, got: "+s);return}let a=Object(gt.decode)(s.ciphertext);if(a.length<this.nacl.secretbox.overheadLength){oe.error(`Expected encrypted event ciphertext length to be ${this.nacl.secretbox.overheadLength}, got: ${a.length}`);return}let c=Object(gt.decode)(s.nonce);if(c.length<this.nacl.secretbox.nonceLength){oe.error(`Expected encrypted event nonce length to be ${this.nacl.secretbox.nonceLength}, got: ${c.length}`);return}let g=this.nacl.secretbox.open(a,c,this.key);if(g===null){oe.debug("Failed to decrypt an event, probably because it was encrypted with a different key. Fetching a new key from the authEndpoint..."),this.authorize(this.pusher.connection.socket_id,(I,q)=>{if(I){oe.error(`Failed to make a request to the authEndpoint: ${q}. Unable to fetch new key, so dropping encrypted event`);return}if(g=this.nacl.secretbox.open(a,c,this.key),g===null){oe.error("Failed to decrypt event with new key. Dropping encrypted event");return}this.emit(t,this.getDataToEmit(g))});return}this.emit(t,this.getDataToEmit(g))}getDataToEmit(t){let s=Object(_n.decode)(t);try{return JSON.parse(s)}catch{return s}}}class Pn extends _e{constructor(t,s){super(),this.state="initialized",this.connection=null,this.key=t,this.options=s,this.timeline=this.options.timeline,this.usingTLS=this.options.useTLS,this.errorCallbacks=this.buildErrorCallbacks(),this.connectionCallbacks=this.buildConnectionCallbacks(this.errorCallbacks),this.handshakeCallbacks=this.buildHandshakeCallbacks(this.errorCallbacks);var a=W.getNetwork();a.bind("online",()=>{this.timeline.info({netinfo:"online"}),(this.state==="connecting"||this.state==="unavailable")&&this.retryIn(0)}),a.bind("offline",()=>{this.timeline.info({netinfo:"offline"}),this.connection&&this.sendActivityCheck()}),this.updateStrategy()}connect(){if(!(this.connection||this.runner)){if(!this.strategy.isSupported()){this.updateState("failed");return}this.updateState("connecting"),this.startConnecting(),this.setUnavailableTimer()}}send(t){return this.connection?this.connection.send(t):!1}send_event(t,s,a){return this.connection?this.connection.send_event(t,s,a):!1}disconnect(){this.disconnectInternally(),this.updateState("disconnected")}isUsingTLS(){return this.usingTLS}startConnecting(){var t=(s,a)=>{s?this.runner=this.strategy.connect(0,t):a.action==="error"?(this.emit("error",{type:"HandshakeError",error:a.error}),this.timeline.error({handshakeError:a.error})):(this.abortConnecting(),this.handshakeCallbacks[a.action](a))};this.runner=this.strategy.connect(0,t)}abortConnecting(){this.runner&&(this.runner.abort(),this.runner=null)}disconnectInternally(){if(this.abortConnecting(),this.clearRetryTimer(),this.clearUnavailableTimer(),this.connection){var t=this.abandonConnection();t.close()}}updateStrategy(){this.strategy=this.options.getStrategy({key:this.key,timeline:this.timeline,useTLS:this.usingTLS})}retryIn(t){this.timeline.info({action:"retry",delay:t}),t>0&&this.emit("connecting_in",Math.round(t/1e3)),this.retryTimer=new K(t||0,()=>{this.disconnectInternally(),this.connect()})}clearRetryTimer(){this.retryTimer&&(this.retryTimer.ensureAborted(),this.retryTimer=null)}setUnavailableTimer(){this.unavailableTimer=new K(this.options.unavailableTimeout,()=>{this.updateState("unavailable")})}clearUnavailableTimer(){this.unavailableTimer&&this.unavailableTimer.ensureAborted()}sendActivityCheck(){this.stopActivityCheck(),this.connection.ping(),this.activityTimer=new K(this.options.pongTimeout,()=>{this.timeline.error({pong_timed_out:this.options.pongTimeout}),this.retryIn(0)})}resetActivityCheck(){this.stopActivityCheck(),this.connection&&!this.connection.handlesActivityChecks()&&(this.activityTimer=new K(this.activityTimeout,()=>{this.sendActivityCheck()}))}stopActivityCheck(){this.activityTimer&&this.activityTimer.ensureAborted()}buildConnectionCallbacks(t){return $({},t,{message:s=>{this.resetActivityCheck(),this.emit("message",s)},ping:()=>{this.send_event("pusher:pong",{})},activity:()=>{this.resetActivityCheck()},error:s=>{this.emit("error",s)},closed:()=>{this.abandonConnection(),this.shouldRetry()&&this.retryIn(1e3)}})}buildHandshakeCallbacks(t){return $({},t,{connected:s=>{this.activityTimeout=Math.min(this.options.activityTimeout,s.activityTimeout,s.connection.activityTimeout||1/0),this.clearUnavailableTimer(),this.setConnection(s.connection),this.socket_id=this.connection.id,this.updateState("connected",{socket_id:this.socket_id})}})}buildErrorCallbacks(){let t=s=>a=>{a.error&&this.emit("error",{type:"WebSocketError",error:a.error}),s(a)};return{tls_only:t(()=>{this.usingTLS=!0,this.updateStrategy(),this.retryIn(0)}),refused:t(()=>{this.disconnect()}),backoff:t(()=>{this.retryIn(1e3)}),retry:t(()=>{this.retryIn(0)})}}setConnection(t){this.connection=t;for(var s in this.connectionCallbacks)this.connection.bind(s,this.connectionCallbacks[s]);this.resetActivityCheck()}abandonConnection(){if(this.connection){this.stopActivityCheck();for(var t in this.connectionCallbacks)this.connection.unbind(t,this.connectionCallbacks[t]);var s=this.connection;return this.connection=null,s}}updateState(t,s){var a=this.state;if(this.state=t,a!==t){var c=t;c==="connected"&&(c+=" with new socket ID "+s.socket_id),oe.debug("State changed",a+" -> "+c),this.timeline.info({state:t,params:s}),this.emit("state_change",{previous:a,current:t}),this.emit(t,s)}}shouldRetry(){return this.state==="connecting"||this.state==="connected"}}class En{constructor(){this.channels={}}add(t,s){return this.channels[t]||(this.channels[t]=Tn(t,s)),this.channels[t]}all(){return F(this.channels)}find(t){return this.channels[t]}remove(t){var s=this.channels[t];return delete this.channels[t],s}disconnect(){C(this.channels,function(t){t.disconnect()})}}function Tn(n,t){if(n.indexOf("private-encrypted-")===0){if(t.config.nacl)return Ce.createEncryptedChannel(n,t,t.config.nacl);let s="Tried to subscribe to a private-encrypted- channel but no nacl implementation available",a=x.buildLogSuffix("encryptedChannelSupport");throw new S(`${s}. ${a}`)}else{if(n.indexOf("private-")===0)return Ce.createPrivateChannel(n,t);if(n.indexOf("presence-")===0)return Ce.createPresenceChannel(n,t);if(n.indexOf("#")===0)throw new b('Cannot create a channel with name "'+n+'".');return Ce.createChannel(n,t)}}var In={createChannels(){return new En},createConnectionManager(n,t){return new Pn(n,t)},createChannel(n,t){return new mt(n,t)},createPrivateChannel(n,t){return new xt(n,t)},createPresenceChannel(n,t){return new Sn(n,t)},createEncryptedChannel(n,t,s){return new Cn(n,t,s)},createTimelineSender(n,t){return new jn(n,t)},createHandshake(n,t){return new yn(n,t)},createAssistantToTheTransportManager(n,t,s){return new vn(n,t,s)}},Ce=In;class Zt{constructor(t){this.options=t||{},this.livesLeft=this.options.lives||1/0}getAssistant(t){return Ce.createAssistantToTheTransportManager(this,t,{minPingDelay:this.options.minPingDelay,maxPingDelay:this.options.maxPingDelay})}isAlive(){return this.livesLeft>0}reportDeath(){this.livesLeft-=1}}class ze{constructor(t,s){this.strategies=t,this.loop=!!s.loop,this.failFast=!!s.failFast,this.timeout=s.timeout,this.timeoutLimit=s.timeoutLimit}isSupported(){return Le(this.strategies,w.method("isSupported"))}connect(t,s){var a=this.strategies,c=0,g=this.timeout,I=null,q=(M,Y)=>{Y?s(null,Y):(c=c+1,this.loop&&(c=c%a.length),c<a.length?(g&&(g=g*2,this.timeoutLimit&&(g=Math.min(g,this.timeoutLimit))),I=this.tryStrategy(a[c],t,{timeout:g,failFast:this.failFast},q)):s(!0))};return I=this.tryStrategy(a[c],t,{timeout:g,failFast:this.failFast},q),{abort:function(){I.abort()},forceMinPriority:function(M){t=M,I&&I.forceMinPriority(M)}}}tryStrategy(t,s,a,c){var g=null,I=null;return a.timeout>0&&(g=new K(a.timeout,function(){I.abort(),c(!0)})),I=t.connect(s,function(q,M){q&&g&&g.isRunning()&&!a.failFast||(g&&g.ensureAborted(),c(q,M))}),{abort:function(){g&&g.ensureAborted(),I.abort()},forceMinPriority:function(q){I.forceMinPriority(q)}}}}class bt{constructor(t){this.strategies=t}isSupported(){return Le(this.strategies,w.method("isSupported"))}connect(t,s){return An(this.strategies,t,function(a,c){return function(g,I){if(c[a].error=g,g){Ln(c)&&s(!0);return}D(c,function(q){q.forceMinPriority(I.transport.priority)}),s(null,I)}})}}function An(n,t,s){var a=te(n,function(c,g,I,q){return c.connect(t,s(g,q))});return{abort:function(){D(a,Rn)},forceMinPriority:function(c){D(a,function(g){g.forceMinPriority(c)})}}}function Ln(n){return He(n,function(t){return!!t.error})}function Rn(n){!n.error&&!n.aborted&&(n.abort(),n.aborted=!0)}class zn{constructor(t,s,a){this.strategy=t,this.transports=s,this.ttl=a.ttl||1800*1e3,this.usingTLS=a.useTLS,this.timeline=a.timeline}isSupported(){return this.strategy.isSupported()}connect(t,s){var a=this.usingTLS,c=On(a),g=c&&c.cacheSkipCount?c.cacheSkipCount:0,I=[this.strategy];if(c&&c.timestamp+this.ttl>=w.now()){var q=this.transports[c.transport];q&&(["ws","wss"].includes(c.transport)||g>3?(this.timeline.info({cached:!0,transport:c.transport,latency:c.latency}),I.push(new ze([q],{timeout:c.latency*2+1e3,failFast:!0}))):g++)}var M=w.now(),Y=I.pop().connect(t,function se(ue,rt){ue?(es(a),I.length>0?(M=w.now(),Y=I.pop().connect(t,se)):s(ue)):(qn(a,rt.transport.name,w.now()-M,g),s(null,rt))});return{abort:function(){Y.abort()},forceMinPriority:function(se){t=se,Y&&Y.forceMinPriority(se)}}}}function vt(n){return"pusherTransport"+(n?"TLS":"NonTLS")}function On(n){var t=W.getLocalStorage();if(t)try{var s=t[vt(n)];if(s)return JSON.parse(s)}catch{es(n)}return null}function qn(n,t,s,a){var c=W.getLocalStorage();if(c)try{c[vt(n)]=et({timestamp:w.now(),transport:t,latency:s,cacheSkipCount:a})}catch{}}function es(n){var t=W.getLocalStorage();if(t)try{delete t[vt(n)]}catch{}}class st{constructor(t,{delay:s}){this.strategy=t,this.options={delay:s}}isSupported(){return this.strategy.isSupported()}connect(t,s){var a=this.strategy,c,g=new K(this.options.delay,function(){c=a.connect(t,s)});return{abort:function(){g.ensureAborted(),c&&c.abort()},forceMinPriority:function(I){t=I,c&&c.forceMinPriority(I)}}}}class Ke{constructor(t,s,a){this.test=t,this.trueBranch=s,this.falseBranch=a}isSupported(){var t=this.test()?this.trueBranch:this.falseBranch;return t.isSupported()}connect(t,s){var a=this.test()?this.trueBranch:this.falseBranch;return a.connect(t,s)}}class Un{constructor(t){this.strategy=t}isSupported(){return this.strategy.isSupported()}connect(t,s){var a=this.strategy.connect(t,function(c,g){g&&a.abort(),s(c,g)});return a}}function Xe(n){return function(){return n.isSupported()}}var Fn=function(n,t,s){var a={};function c(us,Ur,Fr,$r,Dr){var hs=s(n,us,Ur,Fr,$r,Dr);return a[us]=hs,hs}var g=Object.assign({},t,{hostNonTLS:n.wsHost+":"+n.wsPort,hostTLS:n.wsHost+":"+n.wssPort,httpPath:n.wsPath}),I=Object.assign({},g,{useTLS:!0}),q=Object.assign({},t,{hostNonTLS:n.httpHost+":"+n.httpPort,hostTLS:n.httpHost+":"+n.httpsPort,httpPath:n.httpPath}),M={loop:!0,timeout:15e3,timeoutLimit:6e4},Y=new Zt({minPingDelay:1e4,maxPingDelay:n.activityTimeout}),se=new Zt({lives:2,minPingDelay:1e4,maxPingDelay:n.activityTimeout}),ue=c("ws","ws",3,g,Y),rt=c("wss","ws",3,I,Y),Lr=c("sockjs","sockjs",1,q),is=c("xhr_streaming","xhr_streaming",1,q,se),Rr=c("xdr_streaming","xdr_streaming",1,q,se),as=c("xhr_polling","xhr_polling",1,q),zr=c("xdr_polling","xdr_polling",1,q),os=new ze([ue],M),Or=new ze([rt],M),qr=new ze([Lr],M),cs=new ze([new Ke(Xe(is),is,Rr)],M),ls=new ze([new Ke(Xe(as),as,zr)],M),ds=new ze([new Ke(Xe(cs),new bt([cs,new st(ls,{delay:4e3})]),ls)],M),kt=new Ke(Xe(ds),ds,qr),Nt;return t.useTLS?Nt=new bt([os,new st(kt,{delay:2e3})]):Nt=new bt([os,new st(Or,{delay:2e3}),new st(kt,{delay:5e3})]),new zn(new Un(new Ke(Xe(ue),Nt,kt)),a,{ttl:18e5,timeline:t.timeline,useTLS:t.useTLS})},$n=Fn,Dn=(function(){var n=this;n.timeline.info(n.buildTimelineMessage({transport:n.name+(n.options.useTLS?"s":"")})),n.hooks.isInitialized()?n.changeState("initialized"):n.hooks.file?(n.changeState("initializing"),T.load(n.hooks.file,{useTLS:n.options.useTLS},function(t,s){n.hooks.isInitialized()?(n.changeState("initialized"),s(!0)):(t&&n.onError(t),n.onClose(),s(!1))})):n.onClose()}),Mn={getRequest:function(n){var t=new window.XDomainRequest;return t.ontimeout=function(){n.emit("error",new P),n.close()},t.onerror=function(s){n.emit("error",s),n.close()},t.onprogress=function(){t.responseText&&t.responseText.length>0&&n.onChunk(200,t.responseText)},t.onload=function(){t.responseText&&t.responseText.length>0&&n.onChunk(200,t.responseText),n.emit("finished",200),n.close()},t},abortRequest:function(n){n.ontimeout=n.onerror=n.onprogress=n.onload=null,n.abort()}},Wn=Mn;const Bn=256*1024;class Hn extends _e{constructor(t,s,a){super(),this.hooks=t,this.method=s,this.url=a}start(t){this.position=0,this.xhr=this.hooks.getRequest(this),this.unloader=()=>{this.close()},W.addUnloadListener(this.unloader),this.xhr.open(this.method,this.url,!0),this.xhr.setRequestHeader&&this.xhr.setRequestHeader("Content-Type","application/json"),this.xhr.send(t)}close(){this.unloader&&(W.removeUnloadListener(this.unloader),this.unloader=null),this.xhr&&(this.hooks.abortRequest(this.xhr),this.xhr=null)}onChunk(t,s){for(;;){var a=this.advanceBuffer(s);if(a)this.emit("chunk",{status:t,data:a});else break}this.isBufferTooLong(s)&&this.emit("buffer_too_long")}advanceBuffer(t){var s=t.slice(this.position),a=s.indexOf(`
`);return a!==-1?(this.position+=a+1,s.slice(0,a)):null}isBufferTooLong(t){return this.position===t.length&&t.length>Bn}}var wt;(function(n){n[n.CONNECTING=0]="CONNECTING",n[n.OPEN=1]="OPEN",n[n.CLOSED=3]="CLOSED"})(wt||(wt={}));var Oe=wt,Vn=1;class Kn{constructor(t,s){this.hooks=t,this.session=ss(1e3)+"/"+Yn(8),this.location=Xn(s),this.readyState=Oe.CONNECTING,this.openStream()}send(t){return this.sendRaw(JSON.stringify([t]))}ping(){this.hooks.sendHeartbeat(this)}close(t,s){this.onClose(t,s,!0)}sendRaw(t){if(this.readyState===Oe.OPEN)try{return W.createSocketRequest("POST",ts(Jn(this.location,this.session))).start(t),!0}catch{return!1}else return!1}reconnect(){this.closeStream(),this.openStream()}onClose(t,s,a){this.closeStream(),this.readyState=Oe.CLOSED,this.onclose&&this.onclose({code:t,reason:s,wasClean:a})}onChunk(t){if(t.status===200){this.readyState===Oe.OPEN&&this.onActivity();var s,a=t.data.slice(0,1);switch(a){case"o":s=JSON.parse(t.data.slice(1)||"{}"),this.onOpen(s);break;case"a":s=JSON.parse(t.data.slice(1)||"[]");for(var c=0;c<s.length;c++)this.onEvent(s[c]);break;case"m":s=JSON.parse(t.data.slice(1)||"null"),this.onEvent(s);break;case"h":this.hooks.onHeartbeat(this);break;case"c":s=JSON.parse(t.data.slice(1)||"[]"),this.onClose(s[0],s[1],!0);break}}}onOpen(t){this.readyState===Oe.CONNECTING?(t&&t.hostname&&(this.location.base=Qn(this.location.base,t.hostname)),this.readyState=Oe.OPEN,this.onopen&&this.onopen()):this.onClose(1006,"Server lost session",!0)}onEvent(t){this.readyState===Oe.OPEN&&this.onmessage&&this.onmessage({data:t})}onActivity(){this.onactivity&&this.onactivity()}onError(t){this.onerror&&this.onerror(t)}openStream(){this.stream=W.createSocketRequest("POST",ts(this.hooks.getReceiveURL(this.location,this.session))),this.stream.bind("chunk",t=>{this.onChunk(t)}),this.stream.bind("finished",t=>{this.hooks.onFinished(this,t)}),this.stream.bind("buffer_too_long",()=>{this.reconnect()});try{this.stream.start()}catch(t){w.defer(()=>{this.onError(t),this.onClose(1006,"Could not start streaming",!1)})}}closeStream(){this.stream&&(this.stream.unbind_all(),this.stream.close(),this.stream=null)}}function Xn(n){var t=/([^\?]*)\/*(\??.*)/.exec(n);return{base:t[1],queryString:t[2]}}function Jn(n,t){return n.base+"/"+t+"/xhr_send"}function ts(n){var t=n.indexOf("?")===-1?"?":"&";return n+t+"t="+ +new Date+"&n="+Vn++}function Qn(n,t){var s=/(https?:\/\/)([^\/:]+)((\/|:)?.*)/.exec(n);return s[1]+t+s[3]}function ss(n){return W.randomInt(n)}function Yn(n){for(var t=[],s=0;s<n;s++)t.push(ss(32).toString(32));return t.join("")}var Gn=Kn,Zn={getReceiveURL:function(n,t){return n.base+"/"+t+"/xhr_streaming"+n.queryString},onHeartbeat:function(n){n.sendRaw("[]")},sendHeartbeat:function(n){n.sendRaw("[]")},onFinished:function(n,t){n.onClose(1006,"Connection interrupted ("+t+")",!1)}},er=Zn,tr={getReceiveURL:function(n,t){return n.base+"/"+t+"/xhr"+n.queryString},onHeartbeat:function(){},sendHeartbeat:function(n){n.sendRaw("[]")},onFinished:function(n,t){t===200?n.reconnect():n.onClose(1006,"Connection interrupted ("+t+")",!1)}},sr=tr,nr={getRequest:function(n){var t=W.getXHRAPI(),s=new t;return s.onreadystatechange=s.onprogress=function(){switch(s.readyState){case 3:s.responseText&&s.responseText.length>0&&n.onChunk(s.status,s.responseText);break;case 4:s.responseText&&s.responseText.length>0&&n.onChunk(s.status,s.responseText),n.emit("finished",s.status),n.close();break}},s},abortRequest:function(n){n.onreadystatechange=null,n.abort()}},rr=nr,ir={createStreamingSocket(n){return this.createSocket(er,n)},createPollingSocket(n){return this.createSocket(sr,n)},createSocket(n,t){return new Gn(n,t)},createXHR(n,t){return this.createRequest(rr,n,t)},createRequest(n,t,s){return new Hn(n,t,s)}},ns=ir;ns.createXDR=function(n,t){return this.createRequest(Wn,n,t)};var ar=ns,or={nextAuthCallbackID:1,auth_callbacks:{},ScriptReceivers:p,DependenciesReceivers:N,getDefaultStrategy:$n,Transports:xn,transportConnectionInitializer:Dn,HTTPFactory:ar,TimelineTransport:sn,getXHRAPI(){return window.XMLHttpRequest},getWebSocketAPI(){return window.WebSocket||window.MozWebSocket},setup(n){window.Pusher=n;var t=()=>{this.onDocumentBody(n.ready)};window.JSON?t():T.load("json2",{},t)},getDocument(){return document},getProtocol(){return this.getDocument().location.protocol},getAuthorizers(){return{ajax:ee,jsonp:Ys}},onDocumentBody(n){document.body?n():setTimeout(()=>{this.onDocumentBody(n)},0)},createJSONPRequest(n,t){return new Zs(n,t)},createScriptRequest(n){return new Gs(n)},getLocalStorage(){try{return window.localStorage}catch{return}},createXHR(){return this.getXHRAPI()?this.createXMLHttpRequest():this.createMicrosoftXHR()},createXMLHttpRequest(){var n=this.getXHRAPI();return new n},createMicrosoftXHR(){return new ActiveXObject("Microsoft.XMLHTTP")},getNetwork(){return bn},createWebSocket(n){var t=this.getWebSocketAPI();return new t(n)},createSocketRequest(n,t){if(this.isXHRSupported())return this.HTTPFactory.createXHR(n,t);if(this.isXDRSupported(t.indexOf("https:")===0))return this.HTTPFactory.createXDR(n,t);throw"Cross-origin HTTP requests are not supported"},isXHRSupported(){var n=this.getXHRAPI();return!!n&&new n().withCredentials!==void 0},isXDRSupported(n){var t=n?"https:":"http:",s=this.getProtocol();return!!window.XDomainRequest&&s===t},addUnloadListener(n){window.addEventListener!==void 0?window.addEventListener("unload",n,!1):window.attachEvent!==void 0&&window.attachEvent("onunload",n)},removeUnloadListener(n){window.addEventListener!==void 0?window.removeEventListener("unload",n,!1):window.detachEvent!==void 0&&window.detachEvent("onunload",n)},randomInt(n){return Math.floor(function(){return(window.crypto||window.msCrypto).getRandomValues(new Uint32Array(1))[0]/Math.pow(2,32)}()*n)}},W=or,yt;(function(n){n[n.ERROR=3]="ERROR",n[n.INFO=6]="INFO",n[n.DEBUG=7]="DEBUG"})(yt||(yt={}));var nt=yt;class cr{constructor(t,s,a){this.key=t,this.session=s,this.events=[],this.options=a||{},this.sent=0,this.uniqueID=0}log(t,s){t<=this.options.level&&(this.events.push($({},s,{timestamp:w.now()})),this.options.limit&&this.events.length>this.options.limit&&this.events.shift())}error(t){this.log(nt.ERROR,t)}info(t){this.log(nt.INFO,t)}debug(t){this.log(nt.DEBUG,t)}isEmpty(){return this.events.length===0}send(t,s){var a=$({session:this.session,bundle:this.sent+1,key:this.key,lib:"js",version:this.options.version,cluster:this.options.cluster,features:this.options.features,timeline:this.events},this.options.params);return this.events=[],t(a,(c,g)=>{c||this.sent++,s&&s(c,g)}),!0}generateUniqueID(){return this.uniqueID++,this.uniqueID}}class lr{constructor(t,s,a,c){this.name=t,this.priority=s,this.transport=a,this.options=c||{}}isSupported(){return this.transport.isSupported({useTLS:this.options.useTLS})}connect(t,s){if(this.isSupported()){if(this.priority<t)return rs(new y,s)}else return rs(new R,s);var a=!1,c=this.transport.createConnection(this.name,this.priority,this.options.key,this.options),g=null,I=function(){c.unbind("initialized",I),c.connect()},q=function(){g=Ce.createHandshake(c,function(ue){a=!0,se(),s(null,ue)})},M=function(ue){se(),s(ue)},Y=function(){se();var ue;ue=et(c),s(new f(ue))},se=function(){c.unbind("initialized",I),c.unbind("open",q),c.unbind("error",M),c.unbind("closed",Y)};return c.bind("initialized",I),c.bind("open",q),c.bind("error",M),c.bind("closed",Y),c.initialize(),{abort:()=>{a||(se(),g?g.close():c.close())},forceMinPriority:ue=>{a||this.priority<ue&&(g?g.close():c.close())}}}}function rs(n,t){return w.defer(function(){t(n)}),{abort:function(){},forceMinPriority:function(){}}}const{Transports:dr}=W;var ur=function(n,t,s,a,c,g){var I=dr[s];if(!I)throw new U(s);var q=(!n.enabledTransports||he(n.enabledTransports,t)!==-1)&&(!n.disabledTransports||he(n.disabledTransports,t)===-1),M;return q?(c=Object.assign({ignoreNullOrigin:n.ignoreNullOrigin},c),M=new lr(t,a,g?g.getAssistant(I):I,c)):M=hr,M},hr={isSupported:function(){return!1},connect:function(n,t){var s=w.defer(function(){t(new R)});return{abort:function(){s.ensureAborted()},forceMinPriority:function(){}}}};function pr(n){if(n==null)throw"You must pass an options object";if(n.cluster==null)throw"Options object must provide a cluster";"disableStats"in n&&oe.warn("The disableStats option is deprecated in favor of enableStats")}const fr=(n,t)=>{var s="socket_id="+encodeURIComponent(n.socketId);for(var a in t.params)s+="&"+encodeURIComponent(a)+"="+encodeURIComponent(t.params[a]);if(t.paramsProvider!=null){let c=t.paramsProvider();for(var a in c)s+="&"+encodeURIComponent(a)+"="+encodeURIComponent(c[a])}return s};var mr=n=>{if(typeof W.getAuthorizers()[n.transport]>"u")throw`'${n.transport}' is not a recognized auth transport`;return(t,s)=>{const a=fr(t,n);W.getAuthorizers()[n.transport](W,a,n,v.UserAuthentication,s)}};const xr=(n,t)=>{var s="socket_id="+encodeURIComponent(n.socketId);s+="&channel_name="+encodeURIComponent(n.channelName);for(var a in t.params)s+="&"+encodeURIComponent(a)+"="+encodeURIComponent(t.params[a]);if(t.paramsProvider!=null){let c=t.paramsProvider();for(var a in c)s+="&"+encodeURIComponent(a)+"="+encodeURIComponent(c[a])}return s};var gr=n=>{if(typeof W.getAuthorizers()[n.transport]>"u")throw`'${n.transport}' is not a recognized auth transport`;return(t,s)=>{const a=xr(t,n);W.getAuthorizers()[n.transport](W,a,n,v.ChannelAuthorization,s)}};const br=(n,t,s)=>{const a={authTransport:t.transport,authEndpoint:t.endpoint,auth:{params:t.params,headers:t.headers}};return(c,g)=>{const I=n.channel(c.channelName);s(I,a).authorize(c.socketId,g)}};function vr(n,t){let s={activityTimeout:n.activityTimeout||l.activityTimeout,cluster:n.cluster,httpPath:n.httpPath||l.httpPath,httpPort:n.httpPort||l.httpPort,httpsPort:n.httpsPort||l.httpsPort,pongTimeout:n.pongTimeout||l.pongTimeout,statsHost:n.statsHost||l.stats_host,unavailableTimeout:n.unavailableTimeout||l.unavailableTimeout,wsPath:n.wsPath||l.wsPath,wsPort:n.wsPort||l.wsPort,wssPort:n.wssPort||l.wssPort,enableStats:Nr(n),httpHost:wr(n),useTLS:kr(n),wsHost:yr(n),userAuthenticator:Sr(n),channelAuthorizer:Cr(n,t)};return"disabledTransports"in n&&(s.disabledTransports=n.disabledTransports),"enabledTransports"in n&&(s.enabledTransports=n.enabledTransports),"ignoreNullOrigin"in n&&(s.ignoreNullOrigin=n.ignoreNullOrigin),"timelineParams"in n&&(s.timelineParams=n.timelineParams),"nacl"in n&&(s.nacl=n.nacl),s}function wr(n){return n.httpHost?n.httpHost:n.cluster?`sockjs-${n.cluster}.pusher.com`:l.httpHost}function yr(n){return n.wsHost?n.wsHost:jr(n.cluster)}function jr(n){return`ws-${n}.pusher.com`}function kr(n){return W.getProtocol()==="https:"?!0:n.forceTLS!==!1}function Nr(n){return"enableStats"in n?n.enableStats:"disableStats"in n?!n.disableStats:!1}function Sr(n){const t=Object.assign(Object.assign({},l.userAuthentication),n.userAuthentication);return"customHandler"in t&&t.customHandler!=null?t.customHandler:mr(t)}function _r(n,t){let s;return"channelAuthorization"in n?s=Object.assign(Object.assign({},l.channelAuthorization),n.channelAuthorization):(s={transport:n.authTransport||l.authTransport,endpoint:n.authEndpoint||l.authEndpoint},"auth"in n&&("params"in n.auth&&(s.params=n.auth.params),"headers"in n.auth&&(s.headers=n.auth.headers)),"authorizer"in n&&(s.customHandler=br(t,s,n.authorizer))),s}function Cr(n,t){const s=_r(n,t);return"customHandler"in s&&s.customHandler!=null?s.customHandler:gr(s)}class Pr extends _e{constructor(t){super(function(s,a){oe.debug(`No callbacks on watchlist events for ${s}`)}),this.pusher=t,this.bindWatchlistInternalEvent()}handleEvent(t){t.data.events.forEach(s=>{this.emit(s.name,s)})}bindWatchlistInternalEvent(){this.pusher.connection.bind("message",t=>{var s=t.event;s==="pusher_internal:watchlist_events"&&this.handleEvent(t)})}}function Er(){let n,t;return{promise:new Promise((a,c)=>{n=a,t=c}),resolve:n,reject:t}}var Tr=Er;class Ir extends _e{constructor(t){super(function(s,a){oe.debug("No callbacks on user for "+s)}),this.signin_requested=!1,this.user_data=null,this.serverToUserChannel=null,this.signinDonePromise=null,this._signinDoneResolve=null,this._onAuthorize=(s,a)=>{if(s){oe.warn(`Error during signin: ${s}`),this._cleanup();return}this.pusher.send_event("pusher:signin",{auth:a.auth,user_data:a.user_data})},this.pusher=t,this.pusher.connection.bind("state_change",({previous:s,current:a})=>{s!=="connected"&&a==="connected"&&this._signin(),s==="connected"&&a!=="connected"&&(this._cleanup(),this._newSigninPromiseIfNeeded())}),this.watchlist=new Pr(t),this.pusher.connection.bind("message",s=>{var a=s.event;a==="pusher:signin_success"&&this._onSigninSuccess(s.data),this.serverToUserChannel&&this.serverToUserChannel.name===s.channel&&this.serverToUserChannel.handleEvent(s)})}signin(){this.signin_requested||(this.signin_requested=!0,this._signin())}_signin(){this.signin_requested&&(this._newSigninPromiseIfNeeded(),this.pusher.connection.state==="connected"&&this.pusher.config.userAuthenticator({socketId:this.pusher.connection.socket_id},this._onAuthorize))}_onSigninSuccess(t){try{this.user_data=JSON.parse(t.user_data)}catch{oe.error(`Failed parsing user data after signin: ${t.user_data}`),this._cleanup();return}if(typeof this.user_data.id!="string"||this.user_data.id===""){oe.error(`user_data doesn't contain an id. user_data: ${this.user_data}`),this._cleanup();return}this._signinDoneResolve(),this._subscribeChannels()}_subscribeChannels(){const t=s=>{s.subscriptionPending&&s.subscriptionCancelled?s.reinstateSubscription():!s.subscriptionPending&&this.pusher.connection.state==="connected"&&s.subscribe()};this.serverToUserChannel=new mt(`#server-to-user-${this.user_data.id}`,this.pusher),this.serverToUserChannel.bind_global((s,a)=>{s.indexOf("pusher_internal:")===0||s.indexOf("pusher:")===0||this.emit(s,a)}),t(this.serverToUserChannel)}_cleanup(){this.user_data=null,this.serverToUserChannel&&(this.serverToUserChannel.unbind_all(),this.serverToUserChannel.disconnect(),this.serverToUserChannel=null),this.signin_requested&&this._signinDoneResolve()}_newSigninPromiseIfNeeded(){if(!this.signin_requested||this.signinDonePromise&&!this.signinDonePromise.done)return;const{promise:t,resolve:s}=Tr();t.done=!1;const a=()=>{t.done=!0};t.then(a).catch(a),this.signinDonePromise=t,this._signinDoneResolve=s}}class pe{static ready(){pe.isReady=!0;for(var t=0,s=pe.instances.length;t<s;t++)pe.instances[t].connect()}static getClientFeatures(){return H(ye({ws:W.Transports.ws},function(t){return t.isSupported({})}))}constructor(t,s){Ar(t),pr(s),this.key=t,this.config=vr(s,this),this.channels=Ce.createChannels(),this.global_emitter=new _e,this.sessionID=W.randomInt(1e9),this.timeline=new cr(this.key,this.sessionID,{cluster:this.config.cluster,features:pe.getClientFeatures(),params:this.config.timelineParams||{},limit:50,level:nt.INFO,version:l.VERSION}),this.config.enableStats&&(this.timelineSender=Ce.createTimelineSender(this.timeline,{host:this.config.statsHost,path:"/timeline/v2/"+W.TimelineTransport.name}));var a=c=>W.getDefaultStrategy(this.config,c,ur);this.connection=Ce.createConnectionManager(this.key,{getStrategy:a,timeline:this.timeline,activityTimeout:this.config.activityTimeout,pongTimeout:this.config.pongTimeout,unavailableTimeout:this.config.unavailableTimeout,useTLS:!!this.config.useTLS}),this.connection.bind("connected",()=>{this.subscribeAll(),this.timelineSender&&this.timelineSender.send(this.connection.isUsingTLS())}),this.connection.bind("message",c=>{var g=c.event,I=g.indexOf("pusher_internal:")===0;if(c.channel){var q=this.channel(c.channel);q&&q.handleEvent(c)}I||this.global_emitter.emit(c.event,c.data)}),this.connection.bind("connecting",()=>{this.channels.disconnect()}),this.connection.bind("disconnected",()=>{this.channels.disconnect()}),this.connection.bind("error",c=>{oe.warn(c)}),pe.instances.push(this),this.timeline.info({instances:pe.instances.length}),this.user=new Ir(this),pe.isReady&&this.connect()}channel(t){return this.channels.find(t)}allChannels(){return this.channels.all()}connect(){if(this.connection.connect(),this.timelineSender&&!this.timelineSenderTimer){var t=this.connection.isUsingTLS(),s=this.timelineSender;this.timelineSenderTimer=new ae(6e4,function(){s.send(t)})}}disconnect(){this.connection.disconnect(),this.timelineSenderTimer&&(this.timelineSenderTimer.ensureAborted(),this.timelineSenderTimer=null)}bind(t,s,a){return this.global_emitter.bind(t,s,a),this}unbind(t,s,a){return this.global_emitter.unbind(t,s,a),this}bind_global(t){return this.global_emitter.bind_global(t),this}unbind_global(t){return this.global_emitter.unbind_global(t),this}unbind_all(t){return this.global_emitter.unbind_all(),this}subscribeAll(){var t;for(t in this.channels.channels)this.channels.channels.hasOwnProperty(t)&&this.subscribe(t)}subscribe(t){var s=this.channels.add(t,this);return s.subscriptionPending&&s.subscriptionCancelled?s.reinstateSubscription():!s.subscriptionPending&&this.connection.state==="connected"&&s.subscribe(),s}unsubscribe(t){var s=this.channels.find(t);s&&s.subscriptionPending?s.cancelSubscription():(s=this.channels.remove(t),s&&s.subscribed&&s.unsubscribe())}send_event(t,s,a){return this.connection.send_event(t,s,a)}shouldUseTLS(){return this.config.useTLS}signin(){this.user.signin()}}pe.instances=[],pe.isReady=!1,pe.logToConsole=!1,pe.Runtime=W,pe.ScriptReceivers=W.ScriptReceivers,pe.DependenciesReceivers=W.DependenciesReceivers,pe.auth_callbacks=W.auth_callbacks;var jt=d.default=pe;function Ar(n){if(n==null)throw"You must pass your app key when you instantiate Pusher."}W.setup(pe)})])})})(Rt)),Rt.exports}var Pi=Ci();const Ei=Mr(Pi),Ti=()=>{const r="https://api.nyem.online/backend/public/api";if(r.trim()!=="")return console.log("[API Config] Using VITE_API_BASE from environment:",r),r.trim();if(typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"||window.location.hostname==="0.0.0.0")){const d="http://localhost:8000/api";return console.log("[API Config] Development mode detected, using local URL:",d),d}const o="https://api.nyem.online/backend/public/api";return console.log("[API Config] Production mode, using production URL:",o),o},Te=Ti();console.log("[API Config] Final API Base URL:",Te);console.log("[API Config] Environment check:",{VITE_API_BASE:"https://api.nyem.online/backend/public/api",DEV:!1,MODE:"production",hostname:typeof window<"u"?window.location.hostname:"N/A"});let De=!1,qe=null;function Ms(){De=!1,qe=null}function Ii(){const r=document.cookie.split(";");for(let i of r){const[o,d]=i.trim().split("=");if(o==="XSRF-TOKEN")return decodeURIComponent(d)}return null}async function ws(r=!1){if(r&&Ms(),De)return;if(qe)return qe;const i=new URL(Te);if(!(i.hostname==="localhost"||i.hostname==="127.0.0.1"||i.hostname==="0.0.0.0")){console.log("[API] Skipping CSRF cookie fetch for production/cross-domain API"),De=!0;return}const u=`${Te.replace("/api","")}/sanctum/csrf-cookie`;return console.log("[API] Fetching CSRF cookie from:",u),qe=fetch(u,{method:"GET",credentials:"include",headers:{Accept:"application/json"}}).then(h=>{h.ok?(console.log("[API] CSRF cookie fetched successfully"),De=!0):(console.warn("[API] CSRF cookie fetch returned status:",h.status),De=!1),qe=null}).catch(h=>{console.warn("[API] Failed to fetch CSRF cookie:",h),De=!1,qe=null}),qe}async function Ze(r,i={},o=!0){const{method:d="GET",body:u,token:h,headers:p={}}=i;["POST","PUT","DELETE","PATCH"].includes(d)&&await ws();const k={Accept:"application/json",...p},l=typeof FormData<"u"&&u instanceof FormData;!l&&u&&(k["Content-Type"]="application/json; charset=utf-8");const A=new URL(Te),N=A.hostname==="localhost"||A.hostname==="127.0.0.1"||A.hostname==="0.0.0.0";if(N){const x=Ii();x&&["POST","PUT","DELETE","PATCH"].includes(d)&&(k["X-XSRF-TOKEN"]=x)}const T=localStorage.getItem("guest_latitude"),_=localStorage.getItem("guest_longitude");if(T&&_&&(k["X-User-Latitude"]=T,k["X-User-Longitude"]=_),h?(k.Authorization=`Bearer ${h}`,console.log(`[apiFetch] Using token: ${h.substring(0,10)}...`)):console.log("[apiFetch] No token provided for this request"),!r||r==="undefined"||r==="null")throw console.error("[apiFetch] Invalid path provided:",r),new Error(`Invalid API endpoint path: ${r}. Please check that the endpoint is properly defined in constants/endpoints.ts`);const E=`${Te}${r}`;console.log("[apiFetch]",d,E,N?"(localhost - CSRF enabled)":"(production - token auth only)");try{let x;u&&(l?x=u:x=JSON.stringify(u));const v=await fetch(E,{method:d,headers:k,body:x,credentials:N?"include":"omit"});let m={};const b=v.headers.get("content-type");if(b&&b.includes("application/json"))m=await v.json().catch(()=>({}));else{const P=await v.text().catch(()=>"");if(P)try{m=JSON.parse(P)}catch{m={message:P||`Server returned ${v.status}`}}}if(!v.ok){v.status===401&&h&&(console.warn("[apiFetch] Unauthorized - token may be invalid"),localStorage.removeItem("auth_token"),localStorage.removeItem("auth_user"));let P=(m==null?void 0:m.message)||(m==null?void 0:m.error)||`Request failed with status ${v.status}`;if(v.status===419){const y=new URL(Te),f=y.hostname==="localhost"||y.hostname==="127.0.0.1"||y.hostname==="0.0.0.0";if(f&&(Ms(),o&&["POST","PUT","DELETE","PATCH"].includes(d))){console.log("[apiFetch] 419 error - retrying with fresh CSRF cookie..."),await ws(!0);try{const S=await fetch(E,{method:d,headers:k,body:x,credentials:"include"});if(S.ok){const U=S.headers.get("content-type");let R={};if(U&&U.includes("application/json"))R=await S.json().catch(()=>({}));else{const J=await S.text().catch(()=>"");if(J)try{R=JSON.parse(J)}catch{R={message:J||`Server returned ${S.status}`}}}return console.log("[apiFetch] Retry successful after 419 error"),R}}catch(S){console.warn("[apiFetch] Retry after 419 error failed:",S)}}f?P="CSRF token mismatch (419). This usually means the session expired. Please try again.":P="CSRF token mismatch (419). The production API should use token-based authentication. Please check backend configuration."}else v.status===503?window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?P=`Backend server error (503). Please check: 1) Laravel backend is running (php artisan serve), 2) Database is configured and migrated, 3) Check backend logs for errors. API URL: ${E}`:P="Service temporarily unavailable (503). The backend server may be down or experiencing issues.":v.status===404?P=`API endpoint not found (404). Check that the route exists: ${E}`:v.status===500&&(P=(m==null?void 0:m.message)||(m==null?void 0:m.error)||"Server error (500). Check backend logs for details.");throw new Error(P)}return m}catch(x){if((x==null?void 0:x.message)&&(x.message.includes("Unauthenticated")||x.message.includes("Unauthorized"))&&!h||console.error("[apiFetch][error]",d,E,(x==null?void 0:x.message)||x),x.name==="TypeError"&&x.message==="Failed to fetch"){const m=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1";try{const b=new URL(Te).hostname;throw m&&(b==="localhost"||b==="127.0.0.1")?new Error("Cannot connect to backend API. Please ensure: 1) Laravel backend is running (php artisan serve), 2) Backend is accessible at http://localhost:8000, 3) CORS is properly configured in backend/config/cors.php"):new Error(`Network error: Cannot reach API server at ${Te}. Please check your internet connection or API server status.`)}catch{throw new Error("Network error: Cannot connect to API server. Please check that the backend is running and accessible.")}}throw x}}function ke(){return localStorage.getItem("auth_token")}function Wa(r){localStorage.setItem("auth_token",r)}function Ba(){localStorage.removeItem("auth_token"),localStorage.removeItem("auth_user")}function Ai(){const r=localStorage.getItem("auth_user");if(!r)return null;try{return JSON.parse(r)}catch{return null}}function Li(r){localStorage.setItem("auth_user",JSON.stringify(r))}const ne=async(r,i={})=>{const o=ke(),d=await Ze(r,{...i,token:o});return d.data!==void 0?d.data:d.user!==void 0?d.user:d.listings!==void 0?d.listings:d.items!==void 0?d.items:d.requests!==void 0?d.requests:d.conversations!==void 0?d.conversations:d.messages!==void 0?d.messages:d},G={auth:{sendOtp:"/auth/send-otp",sendEmailOtp:"/auth/send-email-otp",verifyOtp:"/auth/verify-otp",verifyPhoneForSeller:"/auth/verify-phone-for-seller",login:"/auth/login",register:"/auth/register",google:"/auth/google",forgotPassword:"/auth/forgot-password",resetPassword:"/auth/reset-password"},profile:{me:"/profile/me",update:"/profile/update",updatePassword:"/profile/update-password",checkUsername:"/profile/check-username",updateOneSignalPlayerId:"/profile/onesignal-player-id",payments:"/profile/payments",getBanks:"/profile/banks",verifyBank:"/profile/verify-bank",tradeHistory:"/profile/trade-history",show:r=>`/profile/${r}`},items:{feed:"/items/feed",create:"/posts",show:r=>`/items/${r}`,update:r=>`/items/${r}`,delete:r=>`/items/${r}`,trackView:r=>`/items/${r}/view`,trackShare:r=>`/items/${r}/share`},categories:"/categories",locations:"/locations",locationsCities:"/locations/cities",locationsAreas:r=>r?`/locations/cities/${r}/areas`:"/locations/areas",swipes:{create:"/swipes",pendingRequests:"/swipes/pending-requests",wishlist:"/swipes/wishlist"},tradeOffers:{pending:"/trade-offers/pending",respond:r=>`/trade-offers/${r}/respond`},messageRequests:{pending:"/message-requests/pending",respond:r=>`/message-requests/${r}/respond`},matches:{list:"/matches",show:r=>`/matches/${r}`},conversations:{list:"/conversations",start:"/conversations/start",messages:r=>`/conversations/${r}/messages`,matches:r=>`/conversations/${r}/matches`,toggleEscrow:r=>`/conversations/${r}/toggle-escrow`},messages:{create:"/messages"},reports:"/report",block:"/block",location:{update:"/location/update",nearby:"/location/nearby",status:"/location/status"},images:{upload:"/images/upload",uploadMultiple:"/images/upload-multiple",uploadBase64:"/images/upload-base64",uploadMultipleBase64:"/images/upload-multiple-base64"},serviceProviders:{feed:"/service-providers/feed",create:"/service-providers",me:"/service-providers/me"},notifications:{test:"/notifications/test",testMe:"/notifications/test/me"},reviews:{create:"/reviews",list:r=>`/users/${r}/reviews`},follow:{follow:r=>`/users/${r}/follow`,unfollow:r=>`/users/${r}/unfollow`,status:r=>`/users/${r}/follow-status`},escrows:{store:"/escrows",verifyPayment:r=>`/escrows/${r}/verify-payment`,acknowledge:r=>`/escrows/${r}/acknowledge`,complete:r=>`/escrows/${r}/complete`,confirm:r=>`/escrows/${r}/confirm`,dispute:r=>`/escrows/${r}/dispute`}},dt=()=>{const r=ke();return ge({queryKey:["profile","me"],queryFn:()=>ne(G.profile.me),enabled:!!r,select:i=>{var o;return i.user||((o=i.data)==null?void 0:o.user)||i}})},Ri=()=>{const r=ve();return fe({mutationFn:i=>ne(G.profile.update,{method:"PUT",body:i}),onSuccess:i=>{var d;const o=i.user||((d=i.data)==null?void 0:d.user)||i;o&&Li(o),r.invalidateQueries({queryKey:["profile","me"]})}})},zi=()=>{const r=ke();return ge({queryKey:["profile","payments"],queryFn:()=>ne(G.profile.payments),enabled:!!r})},Oi=()=>{const r=ve();return fe({mutationFn:i=>ne(G.profile.payments,{method:"PUT",body:i}),onSuccess:()=>{r.invalidateQueries({queryKey:["profile","payments"]})}})},qi=()=>{const r=ke();return ge({queryKey:["profile","banks"],queryFn:()=>ne(G.profile.getBanks),enabled:!!r,select:i=>i.banks||[]})},Ui=()=>fe({mutationFn:r=>ne(G.profile.verifyBank,{method:"POST",body:r})}),Fi=()=>fe({mutationFn:r=>ne(G.profile.updatePassword,{method:"PUT",body:r})}),$i=()=>{const r=ke();return ge({queryKey:["profile","trade-history"],queryFn:()=>ne(G.profile.tradeHistory),enabled:!!r,select:i=>i.transactions||[]})};window.Pusher=Ei;const Ws=j.createContext(void 0),Ha=({children:r})=>{const{data:i}=dt(),[o,d]=j.useState(!1),u=j.useRef(null),h=j.useCallback(()=>{if(!(i!=null&&i.id)||u.current)return;const k=ke();if(!k){console.warn("[WebSocket] No auth token available, skipping Echo connection");return}const l="XXtWgUw0t6Lf0kBvOmu0",A="nyem.gnosisbrand.com",N="443",T="https",_="https://api.nyem.online/backend/public/api";console.log("[WebSocket] Connecting via Echo to:",A);try{const E=new _i({broadcaster:"reverb",key:l,wsHost:A,wsPort:N,wssPort:N,forceTLS:T==="https",enabledTransports:["ws","wss"],authEndpoint:`${_}/broadcasting/auth`,auth:{headers:{Authorization:`Bearer ${k}`,Accept:"application/json"}}});E.connector.pusher.connection.bind("connected",()=>{console.log("[WebSocket] Echo Connected"),d(!0)}),E.connector.pusher.connection.bind("disconnected",()=>{console.log("[WebSocket] Echo Disconnected"),d(!1)}),E.connector.pusher.connection.bind("error",x=>{console.error("[WebSocket] Echo Error:",x)}),u.current=E}catch(E){console.error("[WebSocket] Failed to initialize Echo:",E)}},[i==null?void 0:i.id]);j.useEffect(()=>(h(),()=>{u.current&&(console.log("[WebSocket] Disconnecting Echo"),u.current.disconnect(),u.current=null)}),[h]);const p=j.useCallback((k,l)=>{if(!u.current)return console.warn("[WebSocket] Echo not initialized, cannot subscribe to:",k),()=>{};console.log(`[WebSocket] Subscribing to: ${k}`);let A;return k.startsWith("user.")||k.startsWith("conversation.")?A=u.current.private(k):A=u.current.channel(k),A.listen(".message.sent",N=>{console.log(`[WebSocket][${k}] Received message:`,N),l(N.message||N)}),(k==="escrow.toggle"||k.startsWith("conversation."))&&A.listen(".escrow.toggle",N=>{console.log(`[WebSocket][${k}] Received escrow toggle:`,N),l(N)}),()=>{console.log(`[WebSocket] Unsubscribing from: ${k}`),u.current&&u.current.leave(k)}},[]);return e.jsx(Ws.Provider,{value:{isConnected:o,subscribe:p,echo:u.current||void 0},children:r})},Bs=()=>{const r=j.useContext(Ws);if(!r)throw new Error("useWebSocket must be used within a WebSocketProvider");return r},Hs=(r="Shop")=>ge({queryKey:["categories",r],queryFn:()=>ne(`${G.categories}?parent=${r}`),select:i=>{var o;return Array.isArray(i)?i:i&&typeof i=="object"?i.categories||((o=i.data)==null?void 0:o.categories)||i.data||[]:[]}}),Vs=r=>{var p,k,l,A;const i=r.user||r.owner||{};let o=[];Array.isArray(r.images)&&r.images.length>0?o=r.images:Array.isArray(r.photos)&&r.photos.length>0?o=r.photos:Array.isArray(r.gallery)&&r.gallery.length>0?o=r.gallery:r.image&&(o=[r.image]);let d="Price on request";if(r.price)if(typeof r.price=="string"&&r.price.includes(","))d=r.price.includes("")?r.price:`${r.price}`;else{const N=typeof r.price=="string"?parseFloat(r.price.replace(/[,]/g,"")):r.price;isNaN(N)?d=`${r.price}`:d=`${N.toLocaleString("en-US")}`}else r.looking_for&&(d="Trade");let u="Unknown";r.distance_km!==null&&r.distance_km!==void 0?r.distance_km<1?u=`${Math.round(r.distance_km*1e3)}M`:u=`${r.distance_km.toFixed(1)}KM`:r.distance_display&&(u=r.distance_display.toUpperCase());const h=(p=r.owner)!=null&&p.location?r.owner.location:i.area?`${i.area}, ${i.city||r.city||"Unknown"}`:i.city||r.city||"Unknown";return{id:r.id,name:r.title||"Untitled Item",price:d,category:typeof r.category=="object"&&r.category!==null?r.category.name:r.category||"UNCATEGORIZED",description:r.description||"",longDescription:r.description||"",images:o.length>0?o:["https://images.unsplash.com/photo-1542496658-e33a6d0d50f6?w=800"],color:"#f3f4f6",distance:u,createdAt:typeof r.created_at=="string"?r.created_at:((k=r.created_at)==null?void 0:k.date)||r.created_at,vendor:{id:i.id||r.user_id||((l=r.owner)==null?void 0:l.id),name:i.username||i.name||"Unknown Seller",avatar:i.profile_photo||i.image||"https://i.pravatar.cc/150?u=default",location:h,rating:0,reviewCount:0,followers:0,joinedDate:"2024",bio:"",verified:!!i.phone_verified_at,reviews:[]},isSuper:!1,userId:r.user_id||i.id||((A=r.owner)==null?void 0:A.id)||null,stats:{views:r.views||0,likes:r.likes||0,stars:r.stars||r.super_interest||0,super_interest:r.super_interest||r.stars||0,shares:r.shares||0}}},Di=()=>({id:`ad-${Date.now()}`,name:"Small Business Support",description:"Nyem empowers local artisans and micro-businesses. Join our community and shine together!",price:"PROMO",category:"COMMUNITY",images:["https://images.unsplash.com/photo-1542744094-24638eff58bb?w=800"],color:"#830e4c",longDescription:"",distance:"Local",vendor:{name:"Nyem Community",avatar:"https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?w=150",location:"Everywhere",rating:5,reviewCount:1e3,joinedDate:"2024",bio:"Supporting small businesses.",verified:!0,followers:1e4},isAd:!0}),Mi=()=>({id:"welcome-card",name:"Welcome to Nyem",description:"Learn how to use Nyem to discover amazing local items.",price:"INFO",category:"ONBOARDING",images:[],color:"#830e4c",longDescription:"",distance:"System",vendor:{name:"Nyem Guide",avatar:"",location:"Local",rating:5,reviewCount:0,joinedDate:"2024",bio:"Your personal guide to Nyem.",verified:!0,followers:1e4},isWelcome:!0}),Wi=(r,i,o)=>{"Notification"in window&&Notification.permission==="granted"&&new Notification(r,{body:i,icon:o||"https://images.unsplash.com/photo-1614850523296-d8c1af93d400?auto=format&fit=crop&q=80&w=100"})},Bi=r=>{const{activeTab:i,activeCategory:o,currentCity:d}=r;return ge({queryKey:["listings","feed",r],queryFn:()=>{const u=[];u.push("type=marketplace"),o!=="All"&&u.push(`category=${encodeURIComponent(o)}`),d==="All Locations"?(u.push("city=all"),u.push("ignore_city=true")):u.push(`city=${encodeURIComponent(d)}`);const h=`${G.items.feed}?${u.join("&")}`;return ne(h)},enabled:i==="marketplace",select:u=>u.map(Vs)})},Hi=()=>{const r=ve();return fe({mutationFn:i=>ne(G.swipes.create,{method:"POST",body:i}),onSuccess:()=>{r.invalidateQueries({queryKey:["wishlist"]}),r.invalidateQueries({queryKey:["matches"]}),r.invalidateQueries({queryKey:["message-requests"]})}})},Vi=()=>{const r=ve();return fe({mutationFn:i=>ne(G.items.create,{method:"POST",body:i}),onSuccess:()=>{r.invalidateQueries({queryKey:["listings"]})}})},Ki=()=>{const r=ve();return fe({mutationFn:({id:i,data:o})=>ne(G.items.update(i),{method:"PUT",body:o}),onSuccess:()=>{r.invalidateQueries({queryKey:["listings"]}),r.invalidateQueries({queryKey:["profile","me"]})}})},Xi=()=>{const r=ve();return fe({mutationFn:i=>ne(G.items.delete(i),{method:"DELETE"}),onSuccess:()=>{r.invalidateQueries({queryKey:["listings"]}),r.invalidateQueries({queryKey:["profile","me"]})}})},Ji=()=>fe({mutationFn:r=>ne(G.items.trackView(r),{method:"POST"})}),Qi=()=>fe({mutationFn:r=>ne(G.items.trackShare(r),{method:"POST"})}),ys={type:"spring",stiffness:400,damping:40,mass:1},Va=()=>{const[r,i]=j.useState("new"),[o,d]=j.useState(null),u=Ye(),[h]=Wr(),p=h.get("edit"),[k,l]=j.useState([]),[A,N]=j.useState(""),[T,_]=j.useState(""),[E,x]=j.useState(""),[v,m]=j.useState(""),[b,P]=j.useState(""),[y,f]=j.useState(null),{data:S=[],isLoading:U}=Hs("Shop"),{data:R,isLoading:J,refetch:Z}=dt(),ee=Vi(),re=Ki(),B=Xi(),z=((R==null?void 0:R.listings)||(R==null?void 0:R.items)||[]).map(w=>({id:w.id,title:w.title||w.name||"Untitled",photos:w.photos||(w.image?[w.image]:[]),price:w.price,status:w.status||"active",category_id:w.category_id,condition:w.condition,description:w.description})),L=j.useRef(null),Q=ee.isPending||re.isPending,X=[{value:"new",label:"New"},{value:"like_new",label:"Like New"},{value:"used",label:"Used"},{value:"fair",label:"Fair"}],[le,me]=j.useState(!1);j.useEffect(()=>()=>{k.forEach(w=>{w.startsWith("blob:")&&URL.revokeObjectURL(w)})},[k]);const Ne=async w=>{const $=w.target.files;if(!$||$.length===0)return;if(k.length>=4){f("Maximum 4 images allowed");return}const ce=4-k.length,he=Array.from($).slice(0,ce);he.length<$.length?f(`Only ${ce} more images allowed. Selected first ${ce}.`):f(null);const C=he.map(F=>URL.createObjectURL(F)),H=k.length;l(F=>[...F,...C]),L.current&&(L.current.value="");try{me(!0);const F=ke();if(!F){f("Please login to upload images"),me(!1);return}const D=he.map(async(te,ie)=>{const de=H+ie,ye=C[ie];try{if(te.size>10*1024*1024)throw new Error(`File ${te.name} is too large (max 10MB)`);const Ae=new FormData;Ae.append("image",te);const Le=await Ze(G.images.upload,{method:"POST",token:F,body:Ae});if(!Le.url)throw new Error("Upload failed");l(He=>{const Ve=[...He];return Ve[de]===ye&&(Ve[de]=Le.url,URL.revokeObjectURL(ye)),Ve})}catch(Ae){console.error(`Failed to upload image ${ie}:`,Ae),l(Le=>Le.filter(He=>He!==ye)),URL.revokeObjectURL(ye),f(`Failed to upload ${te.name}: ${Ae.message}`)}});await Promise.all(D)}catch(F){console.error("Batch upload error:",F)}finally{me(!1)}},Se=w=>{l($=>$.filter((ce,he)=>he!==w))},O=w=>{d(w),N(w.title),_(w.description||""),l(w.photos||[]),x(w.category_id||""),m(w.condition||""),P(w.price?String(w.price).replace(/[,]/g,""):""),i("new"),window.scrollTo({top:0,behavior:"smooth"})},K=()=>{d(null),N(""),_(""),l([]),x(""),m(""),P(""),f(null)};j.useEffect(()=>{if(p&&z.length>0&&!o){const w=z.find($=>String($.id)===String(p));w&&(O(w),i("new"))}},[p,z,o]);const ae=async()=>{if(!(R!=null&&R.city_id)&&!(R!=null&&R.city)){f("Please complete your profile (City & Area) before publishing");return}if(!A.trim()){f("Listing title is required");return}if(k.length===0){f("At least one image is required");return}if(!E){f("Category is required");return}if(!v){f("Condition is required");return}if(!b.trim()||parseFloat(b)<=0){f("Valid price is required");return}try{f(null);const w={title:A.trim(),description:T.trim()||null,category_id:Number(E),condition:v,photos:k,type:"marketplace",price:parseFloat(b)};o?(await re.mutateAsync({id:o.id,data:w}),i("collection"),K()):(await ee.mutateAsync(w),i("collection"),K())}catch(w){console.error("Failed to submit listing:",w),f(w.message||"Failed to save listing. Please try again.")}},we=async w=>{if(confirm("Are you sure you want to delete this listing?"))try{await B.mutateAsync(w)}catch($){console.error("Failed to delete listing:",$),f($.message||"Failed to delete listing. Please try again."),alert($.message||"Failed to delete listing. Please try again.")}};return e.jsxs(V.div,{initial:{opacity:0},animate:{opacity:1},className:"w-full flex flex-col gap-6",children:[y&&e.jsx("div",{className:"bg-rose-50 border border-rose-200 text-rose-700 px-4 py-3 rounded-2xl text-sm font-medium",children:y}),e.jsxs("div",{className:"flex bg-neutral-100 p-1 rounded-3xl shrink-0",children:[e.jsxs("button",{onClick:()=>i("collection"),className:`relative flex-1 py-3.5 flex items-center justify-center gap-2 rounded-2xl text-[10px] font-black uppercase tracking-[0.2em] transition-all ${r==="collection"?"bg-white text-[#830e4c] shadow-md":"text-neutral-400 hover:text-neutral-600"}`,children:[e.jsx(Vr,{size:16,strokeWidth:r==="collection"?3:2}),"Your Collection"]}),e.jsxs("button",{onClick:()=>{i("new"),o||K()},className:`relative flex-1 py-3.5 flex items-center justify-center gap-2 rounded-2xl text-[10px] font-black uppercase tracking-[0.2em] transition-all ${r==="new"?"bg-white text-[#830e4c] shadow-md":"text-neutral-400 hover:text-neutral-600"}`,children:[e.jsx(Kr,{size:16,strokeWidth:r==="new"?3:2}),o?"Edit Drop":"New Drop"]})]}),e.jsx(xe,{mode:"wait",children:r==="collection"?e.jsxs(V.div,{initial:{opacity:0,scale:.98},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.98},transition:ys,className:"grid grid-cols-2 gap-4 pb-20",children:[e.jsxs("button",{onClick:()=>i("new"),className:"aspect-square bg-neutral-50 border-2 border-dashed border-neutral-200 rounded-[2.5rem] flex flex-col items-center justify-center gap-3 text-neutral-400 hover:border-[#830e4c33] hover:bg-[#830e4c1a]/30 transition-all group shadow-sm",children:[e.jsx("div",{className:"p-4 bg-white rounded-3xl shadow-sm border border-neutral-100 group-hover:scale-110 group-hover:rotate-90 transition-all duration-500",children:e.jsx(Xr,{size:28,className:"text-neutral-400 group-hover:text-[#830e4c]",strokeWidth:3})}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest opacity-60",children:"Add New Drop"})]}),J?e.jsx("div",{className:"col-span-2 flex justify-center items-center py-12",children:e.jsx("div",{className:"w-8 h-8 border-4 border-[#830e4c] border-t-transparent rounded-full animate-spin"})}):z.map(w=>e.jsxs(V.div,{layout:!0,className:"group relative aspect-square bg-white rounded-[2.5rem] overflow-hidden shadow-md border border-neutral-100",children:[w.photos&&w.photos.length>0&&e.jsx("img",{src:w.photos[0],className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-110",alt:w.title,onError:$=>{const ce=$.target;ce.style.display="none"}}),e.jsx("div",{className:"absolute top-4 left-4",children:e.jsx("span",{className:`px-2.5 py-1 rounded-lg text-[8px] font-black uppercase tracking-widest backdrop-blur-md shadow-sm border ${w.status==="active"?"bg-[#830e4c]/90":"bg-emerald-500/90"} text-white border-white/20`,children:w.status==="active"?"Active":w.status})}),e.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-all duration-300 backdrop-blur-[2px] flex flex-col items-center justify-center gap-3 p-4 text-center",children:[e.jsx("h4",{className:"text-white text-xs font-black uppercase tracking-widest truncate w-full px-2",children:w.title}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>O(w),className:"p-3 bg-white text-[#830e4c] rounded-2xl active:scale-90 shadow-xl",children:e.jsx(at,{size:18,strokeWidth:2.5})}),e.jsx("button",{onClick:()=>we(w.id),className:"p-3 bg-rose-500 text-white rounded-2xl active:scale-90 shadow-xl",children:e.jsx(_s,{size:18,strokeWidth:2.5})})]})]})]},w.id)),!J&&z.length===0&&e.jsxs("div",{className:"col-span-2 flex flex-col items-center justify-center py-12 text-center",children:[e.jsx("p",{className:"text-sm font-medium text-neutral-400 mb-2",children:"No listings yet"}),e.jsx("p",{className:"text-xs text-neutral-300",children:"Create your first listing to get started"})]})]},"collection-grid"):e.jsx(V.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},transition:ys,className:"space-y-8 flex flex-col pb-32",children:!(R!=null&&R.city_id)&&!(R!=null&&R.city)?e.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-[2.5rem] p-7 text-center shadow-xl shadow-amber-900/5 mt-2",children:[e.jsx("div",{className:"w-14 h-14 bg-amber-100 rounded-[1.5rem] flex items-center justify-center mx-auto mb-4",children:e.jsx(Pe,{size:24,className:"text-amber-600"})}),e.jsx("h4",{className:"text-sm font-black text-amber-900 uppercase tracking-[0.2em] mb-3 italic",children:"Complete Your Profile"}),e.jsxs("p",{className:"text-[11px] text-amber-700 font-medium leading-relaxed mb-6 px-4",children:["Buyers need to know where you're located! Please set your ",e.jsx("span",{className:"font-black text-amber-900",children:"City & Area"})," in settings before you can publish listings."]}),e.jsx("button",{onClick:()=>u("/profile"),className:"w-full bg-amber-600 text-white py-4 rounded-2xl text-[10px] font-black uppercase tracking-[0.3em] active:scale-95 transition-all shadow-lg shadow-amber-600/20",children:"Navigate to Settings"})]}):e.jsxs(e.Fragment,{children:[o&&e.jsxs("div",{className:"flex items-center justify-between bg-[#830e4c] rounded-[2rem] p-5 shadow-xl border border-white/10 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-4 overflow-hidden",children:[o.photos&&o.photos.length>0&&e.jsx("img",{src:o.photos[0],className:"w-12 h-12 rounded-2xl object-cover border border-white/20 shrink-0",alt:o.title,onError:w=>{const $=w.target;$.style.display="none"}}),e.jsxs("div",{className:"flex flex-col min-w-0",children:[e.jsx("span",{className:"text-[9px] font-black text-white/60 uppercase tracking-[0.2em]",children:"Editing Drop"}),e.jsx("h4",{className:"text-white text-xs font-black uppercase truncate tracking-tight",children:o.title})]})]}),e.jsx("button",{onClick:K,className:"p-2.5 bg-white/10 rounded-xl text-white hover:bg-white/20 transition-all active:scale-90 shrink-0",children:e.jsx(Be,{size:18,strokeWidth:3})})]}),e.jsxs("div",{className:"space-y-4 shrink-0",children:[e.jsxs("div",{className:"flex justify-between items-end px-1",children:[e.jsx("label",{className:"text-[11px] font-black text-neutral-900 uppercase tracking-[0.2em]",children:"Product Imagery"}),e.jsxs("span",{className:"text-[9px] font-black text-neutral-400 uppercase tracking-widest",children:[k.length,"/4 Required"]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[k.map((w,$)=>{const ce=w.startsWith("blob:");return e.jsxs(V.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},className:"relative aspect-square rounded-2xl overflow-hidden border border-neutral-200 shadow-sm group",children:[e.jsx("img",{src:w,className:"w-full h-full object-cover",alt:`Upload ${$+1}`}),ce&&e.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-[1px] flex items-center justify-center",children:e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"})}),e.jsx("button",{onClick:()=>{ce&&URL.revokeObjectURL(w),Se($)},className:"absolute top-1 right-1 p-1 bg-black/60 text-white rounded-full backdrop-blur-md opacity-0 group-hover:opacity-100 transition-opacity z-10",children:e.jsx(Be,{size:10,strokeWidth:3})})]},w)}),k.length<4&&e.jsx("button",{onClick:()=>{var w;return(w=L.current)==null?void 0:w.click()},disabled:le,className:`aspect-square rounded-2xl bg-white border-2 border-dashed border-neutral-200 flex flex-col items-center justify-center text-neutral-400 hover:text-[#830e4c] hover:border-[#830e4c33] hover:bg-[#830e4c1a]/30 transition-all active:scale-95 group shadow-sm ${le?"opacity-50 cursor-not-allowed":""}`,children:le?e.jsx("div",{className:"w-6 h-6 border-2 border-[#830e4c] border-t-transparent rounded-full animate-spin"}):e.jsx(Jr,{size:20,className:"group-hover:scale-110 transition-transform"})})]}),e.jsx("input",{ref:L,type:"file",accept:"image/*",multiple:!0,onChange:Ne,className:"hidden"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-neutral-500 uppercase tracking-widest px-1",children:"Listing Title"}),e.jsx("input",{type:"text",value:A,onChange:w=>N(w.target.value),placeholder:"e.g., iPhone 15 Pro Max",className:"w-full bg-white border border-neutral-300 rounded-[1.5rem] px-6 py-5 text-sm font-black text-neutral-900 focus:outline-none focus:border-[#830e4c] focus:ring-4 focus:ring-[#830e4c]/5 transition-all shadow-sm placeholder:text-neutral-200"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-neutral-500 uppercase tracking-widest px-1",children:"Description"}),e.jsx("textarea",{value:T,onChange:w=>_(w.target.value),placeholder:"Tell buyers why they need this...",rows:4,className:"w-full bg-white border border-neutral-300 rounded-[1.5rem] px-6 py-5 text-sm font-medium text-neutral-900 focus:outline-none focus:border-[#830e4c] focus:ring-4 focus:ring-[#830e4c]/5 transition-all shadow-sm placeholder:text-neutral-200 resize-none"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-neutral-500 uppercase tracking-widest px-1",children:"Category"}),e.jsxs("select",{value:E===""?"":String(E),onChange:w=>x(w.target.value?Number(w.target.value):""),disabled:U,className:"w-full bg-white border border-neutral-300 rounded-[1.5rem] px-6 py-5 text-[11px] font-black uppercase tracking-widest text-neutral-900 focus:outline-none focus:border-[#830e4c] focus:ring-4 focus:ring-[#830e4c]/5 transition-all shadow-sm disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("option",{value:"",children:"Select Category"}),Array.isArray(S)&&S.map(w=>e.jsx("option",{value:w.id,children:w.name},w.id))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-neutral-500 uppercase tracking-widest px-1",children:"Condition"}),e.jsxs("select",{value:v,onChange:w=>m(w.target.value),className:"w-full bg-white border border-neutral-300 rounded-[1.5rem] px-6 py-5 text-[11px] font-black uppercase tracking-widest text-neutral-900 focus:outline-none focus:border-[#830e4c] focus:ring-4 focus:ring-[#830e4c]/5 transition-all shadow-sm",children:[e.jsx("option",{value:"",children:"Item Condition"}),X.map(w=>e.jsx("option",{value:w.value,children:w.label},w.value))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-neutral-500 uppercase tracking-widest px-1",children:"Asking Price"}),e.jsxs("div",{className:"flex h-[62px] bg-white border border-neutral-300 rounded-[1.5rem] focus-within:border-[#830e4c] focus-within:ring-4 focus-within:ring-[#830e4c]/5 transition-all overflow-hidden shadow-sm items-stretch",children:[e.jsx("div",{className:"flex items-center justify-center pl-6 pr-3 border-r border-neutral-100 bg-neutral-50/30 shrink-0",children:e.jsx("span",{className:"text-[#830e4c] font-black text-lg",children:""})}),e.jsx("input",{type:"number",value:b,onChange:w=>P(w.target.value),placeholder:"0.00",min:"0",step:"0.01",className:"w-full bg-transparent border-none px-4 py-0 text-sm font-black text-neutral-900 focus:ring-0 focus:outline-none placeholder:text-neutral-200"})]})]})]}),e.jsx("button",{onClick:ae,disabled:Q||le,className:"w-full bg-[#830e4c] text-white py-6 rounded-[2rem] font-black uppercase tracking-[0.3em] text-[11px] shadow-xl active:scale-[0.98] transition-all flex items-center justify-center gap-3 shrink-0 disabled:opacity-50 disabled:cursor-not-allowed",children:Q?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Submitting..."})]}):le?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Uploading Images..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Dt,{size:16,className:"text-white/60"}),o?"Finalize Updates":"Publish to Marketplace"]})})]})},"new-drop-form")})]})},Yi=()=>ge({queryKey:["conversations"],queryFn:()=>ne(G.conversations.list),select:r=>{var i;return r.conversations||((i=r.data)==null?void 0:i.conversations)||r||[]}}),Gi=()=>ge({queryKey:["message-requests"],queryFn:()=>ne(G.messageRequests.pending),select:r=>{var i;return r.requests||((i=r.data)==null?void 0:i.requests)||r||[]}}),Zi=()=>ge({queryKey:["trade-offers"],queryFn:()=>ne(G.tradeOffers.pending),select:r=>{var i;return r.offers||((i=r.data)==null?void 0:i.offers)||r||[]}}),ea=()=>{const r=ve();return fe({mutationFn:({id:i,decision:o})=>ne(G.messageRequests.respond(i),{method:"POST",body:{decision:o}}),onSuccess:()=>{r.invalidateQueries({queryKey:["message-requests"]}),r.invalidateQueries({queryKey:["conversations"]})}})},ta=()=>{const r=ve();return fe({mutationFn:({id:i,decision:o})=>ne(G.tradeOffers.respond(i),{method:"POST",body:{decision:o}}),onSuccess:()=>{r.invalidateQueries({queryKey:["trade-offers"]}),r.invalidateQueries({queryKey:["conversations"]}),r.invalidateQueries({queryKey:["matches"]})}})},sa=r=>ge({queryKey:["messages",r],queryFn:()=>ne(G.conversations.messages(r)),enabled:!!r}),na=()=>{const r=ve();return fe({mutationFn:i=>ne(G.messages.create,{method:"POST",body:i}),onSuccess:(i,o)=>{r.invalidateQueries({queryKey:["messages",o.conversation_id]}),r.invalidateQueries({queryKey:["conversations"]})}})},ra=r=>ge({queryKey:["conversation-listing",r],queryFn:async()=>{var o;const i=await ne(G.conversations.matches(r));if(i!=null&&i.matches&&i.matches.length>0){const d=i.matches[0],u=d.my_listing||d.my_item||d.their_listing||d.their_item||d.listing1||d.listing2;if(u)return{id:u.id,title:u.title||"Unknown Listing",photo:((o=u.photos)==null?void 0:o[0])||u.photo||null,price:u.price}}return null},enabled:!!r,staleTime:300*1e3}),ia=()=>{const r=ve();return fe({mutationFn:async i=>{const o=ke();if(!o)throw new Error("Authentication required");return await Ze(G.escrows.store,{method:"POST",token:o,body:i})},onSuccess:()=>{r.invalidateQueries({queryKey:["escrows"]})}})},aa=()=>{const r=ve();return fe({mutationFn:async i=>{const o=ke();if(!o)throw new Error("Authentication required");return await Ze(G.conversations.toggleEscrow(i),{method:"POST",token:o})},onSuccess:(i,o)=>{r.invalidateQueries({queryKey:["conversations"]})}})},js={type:"spring",stiffness:400,damping:40,mass:1};function oa(r){return new Date(r).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}const ca=({chat:r,currentUserId:i,onClose:o,onChatToggle:d})=>{const{data:u=[],isLoading:h,refetch:p}=sa(r.conversation_id),k=na(),l=ia(),A=aa(),[N,T]=j.useState(""),[_,E]=j.useState(r.is_escrow_active||!1),[x,v]=j.useState(!1),[m,b]=j.useState(!1),[P,y]=j.useState(!1),[f,S]=j.useState(null),U=ve(),{subscribe:R,isConnected:J}=Bs(),Z=j.useRef(null);j.useEffect(()=>{Z.current=new Audio("https://assets.mixkit.co/active_storage/sfx/2354/2354-preview.mp3")},[]),j.useEffect(()=>{if(!r.conversation_id)return;console.log("[ChatView] Subscribing to conversation:",r.conversation_id);const O=R(`conversation.${r.conversation_id}`,ae=>{var we;console.log(`[ChatView] WebSocket Callback Triggered for: conversation.${r.conversation_id}`),console.log("[ChatView] Message:",ae),U.setQueryData(["messages",r.conversation_id],w=>{const $=Array.isArray(w)?w:[];return $.some(he=>he.id&&he.id===ae.id||he.message_id&&he.message_id===ae.id)?(console.log("[ChatView] Duplicate message ignored"),$):(console.log("[ChatView] Adding new message to state"),[...$,ae])}),String(ae.sender_id)!==String(i)&&((we=Z.current)==null||we.play().catch(w=>console.warn("Sound play failed:",w)))}),K=R("escrow.toggle",ae=>{console.log("[ChatView] Escrow Toggle Received:",ae),String(ae.conversation_id)===String(r.conversation_id)&&(console.log("[ChatView] Updating local escrow state:",ae.is_escrow_active),E(ae.is_escrow_active))});return()=>{console.log("[ChatView] Unsubscribing from conversation and escrow:",r.conversation_id),O(),K()}},[r.conversation_id,R,U,i]);const ee=j.useRef(null),re=j.useRef(null),B=O=>O===i,z=r.other_user,L=(f==null?void 0:f.sellerId)&&String(i)===String(f.sellerId),Q=(f==null?void 0:f.sellerId)&&String(i)!==String(f.sellerId);j.useEffect(()=>{console.log("=== Role Detection Debug ==="),console.log("currentUserId:",i),console.log("chatListingInfo.sellerId:",f==null?void 0:f.sellerId),console.log("isSeller:",L),console.log("isBuyer:",Q)},[i,f,L,Q]),j.useEffect(()=>{p()},[r.conversation_id]),j.useEffect(()=>{ee.current&&u.length>0&&(ee.current.scrollTop=ee.current.scrollHeight)},[u]),j.useEffect(()=>{const O=K=>{re.current&&!re.current.contains(K.target)&&v(!1)};return document.addEventListener("mousedown",O),()=>document.removeEventListener("mousedown",O)},[]);const{data:X}=ra(r.conversation_id);j.useEffect(()=>{var K;console.log("=== ChatView Listing Debug ==="),console.log("chat.listing_context:",r.listing_context),console.log("conversationListing:",X),console.log("Current chatListingInfo:",f);const O=r.listing_context||X;if(O){const ae={title:O.title||"Unknown Listing",image:O.photo||null,price:O.price?`${Number(O.price).toLocaleString()}`:void 0,priceValue:O.price?Number(O.price):void 0,sellerId:O.user_id||((K=O.user)==null?void 0:K.id)};ae.sellerId||console.warn("ChatView: Could not determine sellerId from listing data!",O),console.log("Setting new listing info:",ae),S(ae)}else console.log("No listing data available");console.log("=== End Debug ===")},[r.listing_context,X]);const le=async()=>{if(!(!N.trim()||k.isPending))try{await k.mutateAsync({conversation_id:r.conversation_id,message_text:N.trim(),receiver_id:z.id}),T("")}catch(O){console.error("Failed to send message:",O),alert(O.message||"Failed to send message. Please try again.")}},me=k.isPending,Ne=()=>{E(!1),v(!1),b(!1),o()};j.useEffect(()=>{const O=document.createElement("script");return O.src="https://js.paystack.co/v1/inline.js",O.async=!0,document.body.appendChild(O),()=>{document.body.contains(O)&&document.body.removeChild(O)}},[]);const Se=async()=>{if(!(f!=null&&f.priceValue)){alert("Price information not available");return}y(!0);try{const O=await l.mutateAsync({seller_id:f.sellerId||z.id,amount:f.priceValue,description:`Purchase of ${f.title}`});console.log("Escrow created:",O);const K=window.PaystackPop;if(!K){alert("Payment system is loading, please try again in a moment or refresh the page."),y(!1);return}const ae=localStorage.getItem("auth_user"),we=ae?JSON.parse(ae).email:"buyer@nyem.com",w=void 0;if(!w||w.includes("placeholder")){alert("Paystack Public Key is missing! Please configure VITE_PAYSTACK_PUBLIC_KEY in .env"),y(!1);return}K.setup({key:w,email:we,amount:f.priceValue*100,currency:"NGN",ref:O.id,metadata:{escrow_id:O.id,custom_fields:[{display_name:"Item",variable_name:"item",value:f.title}]},callback:function(ce){console.log("Payment complete! Reference:",ce.reference),alert("Payment successful! Your funds are now secured in Escrow."),b(!1)},onClose:function(){alert("Transaction was cancelled."),y(!1)}}).openIframe()}catch(O){console.error("Failed to create escrow:",O),alert(O.message||"Failed to initiate secure checkout. Please try again."),y(!1)}};return e.jsxs(V.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},transition:js,className:"fixed inset-0 bg-white z-[300] flex flex-col",children:[e.jsxs("header",{className:"shrink-0 bg-white border-b border-neutral-100 px-4 flex items-center justify-between",style:{paddingTop:"max(16px, env(safe-area-inset-top))",paddingBottom:"16px"},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:Ne,className:"p-2 -ml-1 text-[#830e4c] active:scale-95 transition-all",children:e.jsx(Cs,{size:24,strokeWidth:2.5})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"relative",children:e.jsx("img",{src:z.profile_photo||`https://i.pravatar.cc/150?u=${z.id}`,className:"w-10 h-10 rounded-full object-cover border border-neutral-100",onError:O=>{const K=O.target;K.src=`https://i.pravatar.cc/150?u=${z.id}`}})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h3",{className:"text-sm font-black text-neutral-900 tracking-tight leading-none",children:z.name||z.username}),e.jsx("span",{className:"text-[10px] font-bold text-neutral-400 mt-1 uppercase tracking-widest",children:"Active recently"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-1 relative",ref:re,children:[e.jsx("button",{className:"p-2 text-neutral-400 hover:text-[#830e4c] transition-colors active:scale-90",children:e.jsx(Qr,{size:20})}),e.jsx("button",{onClick:()=>v(!x),className:`p-2 transition-all active:scale-90 ${x?"text-[#830e4c]":"text-neutral-400 hover:text-[#830e4c]"}`,children:e.jsx(Yr,{size:20})}),e.jsx(xe,{children:x&&e.jsxs(V.div,{initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},className:"absolute top-full right-0 mt-2 w-56 bg-white border border-neutral-100 rounded-2xl shadow-2xl z-50 p-2 overflow-hidden",children:[L&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{disabled:A.isPending,onClick:()=>{A.mutate(r.conversation_id,{onSuccess:O=>{E(O.is_escrow_active),v(!1)}})},className:`w-full flex items-center gap-3 p-3 rounded-xl transition-all border-2 ${_?"bg-[#830e4c] border-[#830e4c] text-white shadow-lg":"bg-white border-neutral-50 hover:border-[#830e4c33] text-neutral-700 active:scale-95"}`,children:[e.jsx("div",{className:`p-1.5 rounded-lg transition-colors ${_?"bg-white/20 text-white":"bg-neutral-100 text-neutral-400"}`,children:e.jsx(Qe,{size:18,strokeWidth:2.5})}),e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{className:`text-[11px] font-black uppercase tracking-widest leading-none ${_?"text-white":"text-neutral-900"}`,children:_?"Escrow Enabled":"Use Escrow"}),e.jsx("span",{className:`text-[8px] font-bold mt-1 uppercase tracking-wider ${_?"text-white/40":"text-neutral-400"}`,children:"Secure Protection"})]}),_?e.jsx(Ue,{size:14,className:"ml-auto text-white",strokeWidth:4}):e.jsx(be,{size:14,className:"ml-auto text-neutral-200"})]}),e.jsx("div",{className:"h-px bg-neutral-50 my-1 mx-2"})]}),e.jsxs("button",{className:"w-full flex items-center gap-3 p-3 rounded-xl hover:bg-rose-50 text-rose-500 transition-all active:scale-95",children:[e.jsx("div",{className:"p-1.5 rounded-lg bg-rose-100/50 text-rose-500",children:e.jsx(Ps,{size:16,strokeWidth:2.5})}),e.jsx("span",{className:"text-xs font-black uppercase tracking-widest",children:"Report Deal"})]})]})})]})]}),f&&e.jsxs("div",{className:"bg-white px-5 py-4 flex items-center justify-between border-b border-neutral-50 shadow-[0_4px_12px_rgba(0,0,0,0,02)] z-[5]",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[f.image&&e.jsx("img",{src:f.image,className:"w-12 h-12 rounded-[14px] object-cover border border-neutral-100 shadow-sm",onError:O=>{const K=O.target;K.style.display="none"}}),e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsx("span",{className:"text-[10px] font-black text-neutral-300 uppercase tracking-[0.1em]",children:"Regarding Item"}),e.jsx("span",{className:"text-[14px] font-black text-[#830e4c] truncate max-w-[180px] tracking-tight leading-tight",children:f.title})]})]}),e.jsx("button",{className:"px-5 py-2.5 bg-white border border-neutral-100 rounded-full text-[10px] font-black uppercase tracking-widest text-[#830e4c] shadow-sm active:scale-95 transition-all",children:"View Post"})]}),e.jsx(xe,{children:_&&Q&&(f==null?void 0:f.price)&&e.jsx(V.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden bg-white border-b border-[#830e4c33]",children:e.jsx("div",{className:"p-4",children:e.jsxs("div",{onClick:()=>b(!0),className:"bg-[#830e4c] rounded-[1.5rem] p-4 flex items-center justify-between shadow-lg shadow-[#830e4c1a] cursor-pointer active:scale-[0.98] transition-all hover:bg-[#931e5c]",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-2xl bg-white/20 backdrop-blur-md flex items-center justify-center text-white",children:e.jsx(Me,{size:20,strokeWidth:2.5})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h4",{className:"text-xs font-black text-white uppercase tracking-widest leading-none",children:"Complete Secure Purchase"}),e.jsx("p",{className:"text-[9px] font-bold text-white/50 mt-1.5 uppercase tracking-wider",children:"Tap to checkout using Escrow"})]})]}),e.jsx("div",{className:"bg-white/10 p-2 rounded-xl text-white",children:e.jsx(be,{size:18,strokeWidth:3})})]})})})}),e.jsx(xe,{children:_&&L&&(f==null?void 0:f.price)&&e.jsx(V.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden bg-white border-b border-[#830e4c33]",children:e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"bg-neutral-50 border border-neutral-100 rounded-[1.5rem] p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-2xl bg-[#830e4c]/10 flex items-center justify-center text-[#830e4c]",children:e.jsx(Qe,{size:20,strokeWidth:2.5})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h4",{className:"text-xs font-black text-neutral-900 uppercase tracking-widest leading-none",children:"Escrow Active"}),e.jsx("p",{className:"text-[9px] font-bold text-neutral-400 mt-1.5 uppercase tracking-wider",children:"Waiting for buyer payment"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-full bg-amber-50 text-amber-600 border border-amber-100",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-amber-500 animate-pulse"}),e.jsx("span",{className:"text-[9px] font-bold uppercase tracking-wider",children:"Pending"})]})]})})})}),e.jsx("div",{ref:ee,className:"flex-1 overflow-y-auto p-4 space-y-5 bg-white no-scrollbar",children:h?e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsx("div",{className:"w-8 h-8 border-4 border-[#830e4c] border-t-transparent rounded-full animate-spin"})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex justify-center mb-8 mt-4",children:e.jsx("span",{className:"px-8 py-2.5 bg-[#830e4c0d] rounded-full text-[10px] font-black text-[#830e4c] uppercase tracking-[0.15em] shadow-sm border border-[#830e4c10]",children:"Deal Conversation"})}),e.jsx(xe,{initial:!1,children:u.map(O=>{const K=B(O.sender_id);return e.jsx(V.div,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},transition:js,className:`flex ${K?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:"flex flex-col max-w-[82%] gap-1",children:[e.jsx("div",{className:`px-5 py-3 rounded-[1.5rem] text-sm font-medium shadow-sm border ${K?"bg-[#830e4c] text-white border-[#830e4c] rounded-br-none":"bg-neutral-50 text-neutral-900 border-neutral-100 rounded-bl-none"}`,children:O.message_text}),e.jsxs("div",{className:`flex items-center gap-1.5 px-1 ${K?"justify-end":"justify-start"}`,children:[e.jsx("span",{className:"text-[8px] font-black text-neutral-300 uppercase tracking-widest",children:oa(O.created_at)}),K&&e.jsx(Es,{size:10,className:"text-[#830e4c]"})]})]})},O.id)})}),u.length===0&&e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsx("p",{className:"text-sm font-medium text-neutral-400",children:"No messages yet. Start the conversation!"})})]})}),e.jsx(xe,{children:m&&(f==null?void 0:f.price)&&e.jsxs(e.Fragment,{children:[e.jsx(V.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>b(!1),className:"absolute inset-0 bg-black/60 backdrop-blur-sm z-[400]"}),e.jsxs(V.div,{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:200},className:"absolute bottom-0 left-0 right-0 bg-white rounded-t-[2.5rem] z-[410] p-6 pb-12 shadow-2xl",children:[e.jsx("div",{className:"w-12 h-1.5 bg-neutral-200 rounded-full mx-auto mb-8"}),e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl bg-[#830e4c1a] flex items-center justify-center text-[#830e4c]",children:e.jsx(Ts,{size:32,strokeWidth:1.5})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-neutral-900 tracking-tighter uppercase leading-none",children:"Checkout Securely"}),e.jsx("p",{className:"text-xs font-bold text-[#830e4c] mt-2 uppercase tracking-widest",children:"Protected by Nyem Escrow"})]})]}),e.jsxs("div",{className:"space-y-4 bg-neutral-50 p-6 rounded-[2rem] border border-neutral-100 mb-8",children:[e.jsxs("div",{className:"flex justify-between items-center pb-4 border-b border-neutral-200",children:[e.jsx("span",{className:"text-sm font-black text-neutral-400 uppercase tracking-widest",children:"Item Price"}),e.jsx("span",{className:"text-base font-black text-neutral-900",children:f.price})]}),e.jsxs("div",{className:"flex justify-between items-center pb-4 border-b border-neutral-200",children:[e.jsx("span",{className:"text-sm font-black text-neutral-400 uppercase tracking-widest",children:"Escrow Fee"}),e.jsx("span",{className:"text-base font-black text-emerald-600",children:"FREE"})]}),e.jsxs("div",{className:"flex justify-between items-center pt-2",children:[e.jsx("span",{className:"text-base font-black text-neutral-900 uppercase tracking-widest",children:"Total Payable"}),e.jsx("span",{className:"text-2xl font-black text-[#830e4c]",children:f.price})]})]}),e.jsx("button",{onClick:Se,disabled:P,className:"w-full bg-[#830e4c] text-white py-5 rounded-2xl font-black uppercase tracking-[0.2em] text-[11px] shadow-2xl active:scale-95 transition-all flex items-center justify-center gap-3 disabled:opacity-50 disabled:cursor-not-allowed",children:P?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Creating Escrow..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Me,{size:16,strokeWidth:2.5}),"Confirm & Pay Securely"]})}),e.jsx("button",{onClick:()=>b(!1),className:"w-full py-4 text-[10px] font-black text-neutral-300 uppercase tracking-[0.2em] mt-2",children:"Go Back to Chat"})]})]})}),e.jsx("div",{className:"shrink-0 p-4 pb-10 bg-white border-t border-neutral-50",children:e.jsxs("div",{className:"flex items-center gap-2 bg-neutral-50 p-1.5 rounded-[2rem] border border-neutral-100 focus-within:border-[#830e4c]/30 focus-within:bg-white transition-all",children:[e.jsx("button",{className:"p-2.5 text-neutral-400 hover:text-[#830e4c] active:scale-95 transition-all",children:e.jsx(Gr,{size:18})}),e.jsx("input",{type:"text",value:N,onChange:O=>T(O.target.value),onKeyDown:O=>O.key==="Enter"&&!O.shiftKey&&le(),placeholder:"Message...",disabled:me,className:"flex-1 bg-transparent border-none py-2 text-sm font-medium text-neutral-900 focus:ring-0 focus:outline-none placeholder:text-neutral-300 disabled:opacity-50"}),e.jsx("button",{className:"p-2.5 text-neutral-400 hover:text-[#830e4c] active:scale-95 transition-all",children:e.jsx(Zr,{size:18})}),e.jsx("button",{onClick:le,disabled:!N.trim()||me,className:`p-2.5 rounded-full transition-all active:scale-95 ${N.trim()&&!me?"bg-[#830e4c] text-white shadow-lg":"bg-neutral-200 text-neutral-400"}`,children:e.jsx(Dt,{size:16})})]})})]})},la={type:"spring",stiffness:400,damping:40,mass:1};function da(r){const i=new Date(r),o=new Date,d=Math.floor((o.getTime()-i.getTime())/1e3);if(d<60)return"Just now";const u=Math.floor(d/60);if(u<60)return`${u}m ago`;const h=Math.floor(u/60);if(h<24)return`${h}h ago`;const p=Math.floor(h/24);return p<7?`${p}d ago`:i.toLocaleDateString("en-US",{month:"short",day:"numeric",year:i.getFullYear()!==o.getFullYear()?"numeric":void 0})}const ua=({chats:r,currentUserId:i,onChatClick:o})=>e.jsxs(V.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:la,className:"space-y-1",children:[r.map(d=>{var h;const u=d.other_user;return d.last_message&&d.last_message.sender_id,e.jsxs(V.div,{layout:!0,onClick:()=>o(d),className:"flex items-center gap-4 p-4 hover:bg-[#830e4c1a]/20 rounded-[2rem] transition-colors cursor-pointer group",children:[e.jsx("div",{className:"relative flex-shrink-0",children:e.jsx("img",{src:u.profile_photo||`https://i.pravatar.cc/150?u=${u.id}`,className:"w-16 h-16 rounded-[1.5rem] object-cover border border-neutral-100",onError:p=>{const k=p.target;k.src=`https://i.pravatar.cc/150?u=${u.id}`}})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("h4",{className:"text-base font-black text-neutral-900 truncate tracking-tight",children:u.name||u.username}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-neutral-300",children:d.updated_at?da(d.updated_at):"Recently"})]}),e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsx("p",{className:"text-sm line-clamp-1 pr-4 text-neutral-400 font-medium",children:((h=d.last_message)==null?void 0:h.message_text)||"No messages yet"}),e.jsx(Es,{size:14,className:"text-neutral-200 flex-shrink-0"})]})]})]},d.id)}),r.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-24 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-neutral-50 rounded-full flex items-center justify-center mb-4",children:e.jsx(Mt,{size:24,className:"text-neutral-200"})}),e.jsx("h4",{className:"text-sm font-black text-neutral-900 uppercase",children:"No active chats"}),e.jsx("p",{className:"text-[10px] font-bold text-neutral-400 uppercase tracking-widest mt-1",children:"Accept requests to start a deal"})]})]}),zt={type:"spring",stiffness:400,damping:40,mass:1};function ha(r){const i=new Date(r),o=new Date,d=Math.floor((o.getTime()-i.getTime())/1e3);if(d<60)return"Just now";const u=Math.floor(d/60);if(u<60)return`${u}m ago`;const h=Math.floor(u/60);if(h<24)return`${h}h ago`;const p=Math.floor(h/24);return p<7?`${p}d ago`:i.toLocaleDateString("en-US",{month:"short",day:"numeric",year:i.getFullYear()!==o.getFullYear()?"numeric":void 0})}const pa=({requests:r,tradeOffers:i,onRequestAccepted:o,onRequestDeclined:d,onChatOpen:u})=>{const[h,p]=j.useState(null),[k,l]=j.useState(""),A=ea(),N=ta(),T=async(x,v)=>{try{v==="request"?await A.mutateAsync({id:x,decision:"decline"}):await N.mutateAsync({id:x,decision:"decline"}),d==null||d(x)}catch(m){console.error("Failed to decline:",m),alert("Failed to decline. Please try again.")}},_=async(x,v)=>{var m,b,P,y,f,S;try{const U=v==="request"?await A.mutateAsync({id:x,decision:"accept"}):await N.mutateAsync({id:x,decision:"accept"});if(p(null),l(""),(b=(m=U==null?void 0:U.data)==null?void 0:m.conversation)!=null&&b.id||(P=U==null?void 0:U.conversation)!=null&&P.id){const R=((f=(y=U==null?void 0:U.data)==null?void 0:y.conversation)==null?void 0:f.id)||((S=U==null?void 0:U.conversation)==null?void 0:S.id);u==null||u(R)}o()}catch(U){console.error("Failed to accept:",U),alert("Failed to accept. Please try again."),p(null)}},E=[...r.map(x=>({...x,type:"request"})),...i.map(x=>({...x,type:"trade"}))].sort((x,v)=>new Date(v.created_at).getTime()-new Date(x.created_at).getTime());return e.jsxs(V.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:zt,className:"space-y-4",children:[E.map(x=>{const v=x.type==="trade",m=x.from_user,b=v?x.target_item:x.listing||x.item,P=v?x.offered_item:null;return e.jsxs(V.div,{layout:!0,initial:{opacity:0,scale:.98},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.98},transition:zt,className:`bg-white border rounded-[2rem] p-5 flex flex-col gap-4 shadow-sm transition-all ${h===x.id?"border-[#830e4c] ring-4 ring-[#830e4c1a]":"border-neutral-100"}`,children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative flex-shrink-0",children:[e.jsx("img",{src:m.photo||`https://i.pravatar.cc/150?u=${m.id}`,className:"w-14 h-14 rounded-2xl object-cover border border-neutral-100",onError:y=>{const f=y.target;f.src=`https://i.pravatar.cc/150?u=${m.id}`}}),e.jsx("div",{className:`absolute -bottom-1 -right-1 w-6 h-6 rounded-full flex items-center justify-center border-2 border-white text-white ${v?"bg-amber-500":"bg-indigo-500"}`,children:v?e.jsx(ei,{size:10,strokeWidth:3}):e.jsx(Mt,{size:10,strokeWidth:3})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"text-base font-black text-neutral-900 truncate tracking-tight",children:m.name||m.username}),e.jsx("span",{className:"text-[10px] font-bold text-neutral-300 tracking-widest uppercase",children:ha(x.created_at)})]}),e.jsxs("p",{className:"text-xs font-medium text-neutral-400 truncate",children:[v?"Proposed a trade for your ":"Interested in your ",e.jsx("span",{className:"font-bold text-neutral-800",children:(b==null?void 0:b.title)||"Listing"})]})]}),(b==null?void 0:b.photo)&&e.jsx("img",{src:b.photo,className:"w-14 h-14 rounded-2xl object-cover border border-neutral-50 grayscale-[0.3]",onError:y=>{const f=y.target;f.style.display="none"}})]}),v&&P&&e.jsxs("div",{className:"bg-amber-50/50 p-4 rounded-2xl border border-amber-100 flex items-center gap-4",children:[e.jsx("img",{src:P.photo,className:"w-12 h-12 rounded-xl object-cover border border-amber-200",onError:y=>{const f=y.target;f.style.display="none"}}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-amber-600 uppercase tracking-widest leading-none mb-1",children:"Offered Item"}),e.jsx("p",{className:"text-sm font-bold text-neutral-900",children:P.title})]})]}),x.message_text&&e.jsxs("div",{className:"bg-neutral-50 p-4 rounded-2xl border border-neutral-100 italic text-xs text-neutral-600 font-medium leading-relaxed",children:['"',x.message_text,'"']}),e.jsx(xe,{children:h===x.id?e.jsxs(V.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},transition:zt,className:"space-y-3 pt-1",children:[e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{autoFocus:!0,value:k,onChange:y=>l(y.target.value),placeholder:v?"Accept this trade...":"Add a friendly reply...",className:"w-full bg-white border border-neutral-200 rounded-2xl px-4 py-4 text-sm font-medium text-neutral-900 focus:outline-none focus:border-[#830e4c] transition-all resize-none min-h-[110px] placeholder:text-neutral-300"}),e.jsx("button",{onClick:()=>_(x.id,x.type),className:"absolute bottom-3 right-3 p-3 bg-[#830e4c] text-white rounded-xl shadow-lg active:scale-95 transition-all",children:e.jsx(Dt,{size:18})})]}),e.jsx("button",{onClick:()=>p(null),className:"w-full py-2 text-[10px] font-black uppercase tracking-widest text-neutral-300 hover:text-[#830e4c] transition-colors",children:"Cancel"})]}):e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>T(x.id,x.type),className:"flex-1 bg-white hover:bg-rose-50 hover:text-rose-500 text-neutral-400 py-3.5 rounded-2xl flex items-center justify-center gap-2 transition-all active:scale-95 border border-neutral-100 hover:border-rose-100",children:[e.jsx(Be,{size:16,strokeWidth:3}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Decline"})]}),e.jsxs("button",{onClick:()=>p(x.id),className:`flex-[2] text-white py-3.5 rounded-2xl flex items-center justify-center gap-2 shadow-lg active:scale-95 transition-all border ${v?"bg-amber-600 border-amber-600":"bg-[#830e4c] border-[#830e4c]"}`,children:[e.jsx(Ue,{size:16,strokeWidth:3,className:"text-white/60"}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:v?"Accept Trade":"Accept Request"})]})]})})]},x.id)}),E.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-neutral-50 rounded-full flex items-center justify-center mb-6",children:e.jsx(Ge,{size:24,className:"text-neutral-200"})}),e.jsx("h4",{className:"text-sm font-black text-neutral-900 uppercase",children:"Inbox Clean"}),e.jsx("p",{className:"text-[10px] font-bold text-neutral-400 uppercase tracking-widest mt-1",children:"No new requests or trade offers"})]})]})},fa=({isOpen:r,onClose:i,onSuccess:o})=>{const[d,u]=j.useState(!1),[h,p]=j.useState(null),[k,l]=j.useState("prompt"),A=async()=>{var T,_,E,x,v,m;try{u(!0),p(null),l("processing");const b=ke();if(!b){p("Please login first"),u(!1),l("prompt");return}if(!("Notification"in window)){p("Your browser does not support notifications"),u(!1),l("prompt");return}let P=Notification.permission;if(P==="default"&&(P=await Notification.requestPermission()),P!=="granted"){p("Notification permission was denied. Please enable it in your browser settings."),u(!1),l("prompt");return}let y=null;if(window.OneSignalReady?y=await window.OneSignalReady:window.OneSignal?y=window.OneSignal:window.OneSignalDeferred&&(y=await new Promise(f=>{window.OneSignalDeferred.push(S=>{f(S)})})),!y){p("OneSignal is not loaded. Please refresh the page and try again."),u(!1),l("prompt");return}try{(T=y.User)!=null&&T.PushSubscription?!(y.User.PushSubscription.optedIn??!1)&&y.User.PushSubscription.optIn&&await y.User.PushSubscription.optIn():y.Notifications&&typeof y.Notifications.requestPermission=="function"&&await y.Notifications.requestPermission(),await new Promise(S=>setTimeout(S,1e3));let f=null;if((E=(_=y.User)==null?void 0:_.PushSubscription)!=null&&E.id?f=y.User.PushSubscription.id:typeof y.getUserId=="function"?f=await y.getUserId():(x=y.User)!=null&&x.id&&(f=y.User.id),f||(await new Promise(S=>setTimeout(S,2e3)),(m=(v=y.User)==null?void 0:v.PushSubscription)!=null&&m.id?f=y.User.PushSubscription.id:typeof y.getUserId=="function"&&(f=await y.getUserId())),!f){p("Unable to get notification ID. Please try refreshing the page."),u(!1),l("prompt");return}try{await Ze(G.profile.updateOneSignalPlayerId,{method:"POST",token:b,body:{onesignal_player_id:f}})}catch(S){console.warn("Failed to register player ID (may already be registered):",S)}l("success"),setTimeout(()=>{o(f),i()},1500)}catch(f){console.error("OneSignal subscription error:",f),p("Failed to enable notifications: "+((f==null?void 0:f.message)||"Unknown error")),u(!1),l("prompt")}}catch(b){console.error("Notification permission error:",b),p((b==null?void 0:b.message)||"Failed to enable notifications. Please try again."),u(!1),l("prompt")}},N=()=>{i()};return r?e.jsx(xe,{children:e.jsx(V.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[500] flex items-center justify-center p-4",onClick:T=>{T.target===T.currentTarget&&k!=="processing"&&N()},children:e.jsx(V.div,{initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},className:"bg-white rounded-[2.5rem] p-8 max-w-md w-full shadow-2xl",children:k==="success"?e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-2xl flex items-center justify-center mx-auto mb-6",children:e.jsx(Ue,{size:32,className:"text-emerald-600",strokeWidth:2.5})}),e.jsx("h2",{className:"text-2xl font-black text-neutral-900 tracking-tight mb-3",children:"Notifications Enabled! "}),e.jsx("p",{className:"text-sm text-neutral-600 leading-relaxed",children:"You'll now receive push notifications from Nyem."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("div",{className:"w-16 h-16 bg-indigo-100 rounded-2xl flex items-center justify-center",children:e.jsx(qt,{size:32,className:"text-indigo-600",strokeWidth:2.5})}),k!=="processing"&&e.jsx("button",{onClick:N,className:"p-2 text-neutral-400 hover:text-neutral-900 transition-colors",children:e.jsx(Be,{size:20})})]}),e.jsx("h2",{className:"text-2xl font-black text-neutral-900 tracking-tight mb-3",children:"Enable Push Notifications"}),e.jsx("p",{className:"text-sm text-neutral-600 leading-relaxed mb-6",children:"Get notified about new matches, messages, and important updates! We'll ask for your permission to send notifications."}),h&&e.jsx("div",{className:"bg-rose-50 border border-rose-200 text-rose-700 px-4 py-3 rounded-xl text-sm mb-4",children:h}),k==="processing"?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"w-8 h-8 border-4 border-indigo-600 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:A,disabled:d,className:"w-full bg-indigo-600 text-white py-4 rounded-full font-black uppercase tracking-widest text-xs shadow-xl active:scale-95 transition-all flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(qt,{size:16}),"Enable Notifications"]}),e.jsx("button",{onClick:N,disabled:d,className:"w-full bg-white border-2 border-neutral-200 text-neutral-600 py-4 rounded-full font-black uppercase tracking-widest text-xs active:scale-95 transition-all hover:border-neutral-400 disabled:opacity-50",children:"Maybe Later"})]})]})})})}):null},ma={type:"spring",stiffness:400,damping:40,mass:1},Ka=({onChatToggle:r})=>{const{id:i}=Br(),o=Ye(),[d,u]=j.useState("chats"),{data:h=[],isLoading:p,refetch:k}=Yi(),{data:l=[],isLoading:A,refetch:N}=Gi(),{data:T=[],isLoading:_,refetch:E}=Zi(),[x,v]=j.useState(null),[m,b]=j.useState(!1),P=j.useRef(null),{data:y}=dt();j.useEffect(()=>{y!=null&&y.id&&(P.current=y.id)},[y]);const f=ve(),{subscribe:S}=Bs();j.useEffect(()=>{if(!(y!=null&&y.id))return;const z=S(`user.${y.id}`,L=>{console.log("[MatchesPage] WebSocket event received:",L),f.invalidateQueries({queryKey:["conversations"]})});return()=>z()},[y==null?void 0:y.id,S,f]),j.useEffect(()=>{if(i&&h.length>0&&!x){const z=h.find(L=>L.conversation_id===i||L.id===i);z&&(v(z),r==null||r(!0))}},[i,h,x,r]);const U=p||A,R=async()=>{await k(),await N(),await E(),u("chats")},J=z=>{N()},Z=z=>{v(z),r==null||r(!0)},ee=()=>{v(null),r==null||r(!1),i&&o("/matches"),k()},re=z=>{const L=h.find(Q=>Q.conversation_id===z||Q.id===z);L?Z(L):k().then(()=>{const Q=h.find(X=>X.conversation_id===z||X.id===z);Q&&Z(Q)})},B=async z=>{k()};return x?e.jsx(ca,{chat:x,currentUserId:P.current,onClose:ee,onChatToggle:r}):e.jsxs(V.div,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},transition:ma,className:"w-full max-w-2xl mx-auto flex flex-col pb-40",children:[e.jsxs("div",{className:"flex px-4 gap-4 mb-6 mt-2",children:[e.jsx("button",{onClick:()=>u("chats"),className:`relative px-8 py-2.5 rounded-full text-xs font-black uppercase tracking-widest transition-all ${d==="chats"?"bg-[#830e4c] text-white shadow-lg":"bg-white text-neutral-400 border border-neutral-100"}`,children:"Chats"}),e.jsxs("button",{onClick:()=>u("requests"),className:`relative px-8 py-2.5 rounded-full text-xs font-black uppercase tracking-widest transition-all ${d==="requests"?"bg-[#830e4c] text-white shadow-lg":"bg-white text-neutral-400 border border-neutral-100"}`,children:["Requests",l.length+T.length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-[#830e4c] text-white text-[9px] flex items-center justify-center rounded-full border-2 border-white font-black",children:l.length+T.length})]})]}),e.jsx(fa,{isOpen:m,onClose:()=>b(!1),onSuccess:B}),e.jsx("div",{className:"px-4",children:U?e.jsx("div",{className:"flex justify-center items-center py-24",children:e.jsx("div",{className:"w-8 h-8 border-4 border-[#830e4c] border-t-transparent rounded-full animate-spin"})}):e.jsx(xe,{mode:"wait",children:d==="chats"?e.jsx(ua,{chats:h,currentUserId:P.current,onChatClick:Z},"chats-list"):e.jsx(pa,{requests:l,tradeOffers:T,onRequestAccepted:R,onRequestDeclined:J,onChatOpen:re},"requests-list")})})]})},xa=()=>ge({queryKey:["locations","cities"],queryFn:()=>ne(G.locationsCities),select:r=>{var i;return r.cities||((i=r.data)==null?void 0:i.cities)||r}}),ga=r=>ge({queryKey:["locations","areas",r],queryFn:()=>ne(G.locationsAreas(r)),enabled:!!r,select:i=>{var o;return i.areas||((o=i.data)==null?void 0:o.areas)||i}}),ks={type:"spring",stiffness:400,damping:40,mass:1},lt=({active:r,onClick:i})=>e.jsx("button",{onClick:o=>{o.stopPropagation(),i()},className:`w-12 h-6 rounded-full relative flex items-center px-1 transition-colors duration-300 ${r?"bg-[#830e4c]":"bg-neutral-200"}`,children:e.jsx(V.div,{animate:{x:r?24:0},transition:{type:"spring",stiffness:500,damping:30},className:"w-4 h-4 bg-white rounded-full shadow-md"})}),ba=()=>{var ee,re;const{data:r,isLoading:i}=zi(),{data:o=[],isLoading:d}=qi(),u=Ui(),h=Oi(),[p,k]=j.useState(!1),[l,A]=j.useState(""),[N,T]=j.useState(""),[_,E]=j.useState(""),[x,v]=j.useState(null),[m,b]=j.useState(!1),[P,y]=j.useState(!1),[f,S]=j.useState(!1);j.useEffect(()=>{r&&(k(r.escrow_enabled),r.bank_details?(T(r.bank_details.account_number||""),E(r.bank_details.account_name||""),r.bank_details.account_number||S(!0)):S(!0))},[r]);const U=Fe.useMemo(()=>{const B=o.find(z=>z.code===l);return B?B.name:""},[l,o]);j.useEffect(()=>{var B;if((B=r==null?void 0:r.bank_details)!=null&&B.bank_name&&o.length>0&&!l){const z=o.find(L=>L.name===r.bank_details.bank_name);z&&(A(z.code),y(!0))}},[r,o,l]);const R=async()=>{if(!(!l||N.length<10)){b(!0),v(null),E(""),y(!1);try{const B=await u.mutateAsync({account_number:N,bank_code:l});E(B.account_name),y(!0)}catch{v("Could not verify account. Please check details."),y(!1)}finally{b(!1)}}},J=async()=>{var B,z;if(p&&!P){v("Please verify your bank account before enabling escrow.");return}try{await h.mutateAsync({escrow_enabled:p,bank_name:U||((B=r==null?void 0:r.bank_details)==null?void 0:B.bank_name),account_number:N,account_name:_||((z=r==null?void 0:r.bank_details)==null?void 0:z.account_name)}),S(!1)}catch(L){console.error(L)}};if(i)return e.jsx("div",{className:"p-8 text-center text-neutral-400 text-xs font-black uppercase tracking-widest",children:"Loading settings..."});const Z=((ee=r==null?void 0:r.bank_details)==null?void 0:ee.account_number)&&((re=r==null?void 0:r.bank_details)==null?void 0:re.bank_name);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Escrow Status"}),e.jsxs("div",{onClick:()=>P&&k(!p),className:`p-6 rounded-[2.5rem] border-2 transition-all cursor-pointer ${p?"bg-emerald-50 border-emerald-500 shadow-xl shadow-emerald-100":"bg-white border-neutral-100 shadow-sm"} ${P?"":"opacity-50 cursor-not-allowed"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:`p-3 rounded-2xl ${p?"bg-emerald-500 text-white":"bg-neutral-100 text-neutral-400"}`,children:e.jsx(ri,{size:24,strokeWidth:2.5})}),e.jsx(lt,{active:p,onClick:()=>P&&k(!p)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h4",{className:`text-base font-black uppercase tracking-tight ${p?"text-emerald-900":"text-neutral-900"}`,children:p?"Escrow Protection Active":"Escrow Protection Disabled"}),e.jsx("p",{className:`text-[10px] font-bold uppercase tracking-widest leading-relaxed ${p?"text-emerald-600":"text-neutral-400"}`,children:p?"Your deals are secured by Nyem Escrow. Funds are held until buyers confirm delivery.":"Activate escrow to build trust and protect your transactions from disputes. You must add a verified bank account first."})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between px-1",children:[e.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest",children:"Withdrawal Destination"}),!f&&Z&&e.jsxs("button",{onClick:()=>S(!0),className:"text-[10px] font-black text-[#830e4c] uppercase tracking-widest flex items-center gap-1.5",children:[e.jsx(at,{size:12,strokeWidth:2.5})," Edit Details"]}),f&&Z&&e.jsx("button",{onClick:()=>S(!1),className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest",children:"Cancel"})]}),!f&&Z?e.jsxs("div",{className:"bg-white border border-neutral-100 rounded-[2.5rem] p-8 shadow-sm relative overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-[0.03] pointer-events-none group-hover:scale-110 transition-transform duration-500",children:e.jsx(Ct,{size:120})}),e.jsxs("div",{className:"space-y-6 relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-neutral-50 rounded-2xl flex items-center justify-center text-[#830e4c]",children:e.jsx(Ct,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] font-black text-neutral-400 uppercase tracking-[0.2em] mb-0.5",children:"Bank Name"}),e.jsx("h4",{className:"text-base font-black text-neutral-900 uppercase tracking-tight",children:r.bank_details.bank_name})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] font-black text-neutral-400 uppercase tracking-[0.2em] mb-1",children:"Account Number"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl font-black text-neutral-900 tracking-[0.1em]",children:r.bank_details.account_number}),e.jsx(Is,{size:18,className:"text-emerald-500"})]})]}),e.jsxs("div",{className:"pt-4 border-t border-neutral-50",children:[e.jsx("p",{className:"text-[9px] font-black text-neutral-400 uppercase tracking-[0.2em] mb-1",children:"Verified Account Name"}),e.jsx("h5",{className:"text-sm font-black text-neutral-900 uppercase",children:r.bank_details.account_name})]})]})]})]}):e.jsxs("div",{className:"bg-white border border-neutral-100 rounded-[2.5rem] p-6 shadow-sm space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest flex items-center gap-2",children:[e.jsx(Ct,{size:12})," Bank Name"]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:l,onChange:B=>{A(B.target.value),y(!1)},className:"w-full bg-neutral-50 border border-neutral-100 rounded-xl px-4 py-3 text-sm font-bold text-neutral-900 focus:outline-none focus:border-[#830e4c] transition-all appearance-none",disabled:d,children:[e.jsx("option",{value:"",children:"Select Bank"}),o.map(B=>e.jsx("option",{value:B.code,children:B.name},B.code))]}),e.jsx(Ut,{className:"absolute right-4 top-1/2 -translate-y-1/2 text-neutral-300 pointer-events-none",size:16})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest flex items-center gap-2",children:[e.jsx(As,{size:12})," Account Number"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:N,onChange:B=>{T(B.target.value.replace(/\D/g,"")),y(!1)},maxLength:10,placeholder:"0123456789",className:"flex-1 bg-neutral-50 border border-neutral-100 rounded-xl px-4 py-3 text-sm font-bold text-neutral-900 focus:outline-none focus:border-[#830e4c] transition-all placeholder:text-neutral-300 tracking-widest"}),e.jsx("button",{onClick:R,disabled:!l||N.length<10||m,className:"bg-neutral-900 text-white px-6 rounded-xl text-[10px] font-black uppercase tracking-widest disabled:opacity-50 disabled:cursor-not-allowed",children:m?"...":"Verify"})]})]}),(_||x)&&e.jsx("div",{className:`p-4 rounded-2xl ${x?"bg-red-50 text-red-600":"bg-emerald-50 text-emerald-700"} flex items-center gap-3`,children:x?e.jsxs(e.Fragment,{children:[e.jsx(Ps,{size:18}),e.jsx("span",{className:"text-xs font-bold",children:x})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ls,{size:18}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] font-black uppercase tracking-widest opacity-70",children:"Verified Name"}),e.jsx("p",{className:"text-sm font-black uppercase",children:_})]})]})}),f&&e.jsxs("button",{onClick:J,disabled:h.isPending||!P,className:"w-full bg-[#830e4c] text-white py-6 rounded-[2rem] font-black uppercase tracking-[0.25em] text-[11px] shadow-xl active:scale-95 transition-all flex items-center justify-center gap-3 disabled:opacity-50 disabled:cursor-not-allowed mt-4",children:[e.jsx(ii,{size:16,strokeWidth:2.5}),h.isPending?"Saving...":"Save Payment Settings"]})]})]})]})},va=()=>{const r=Fi(),[i,o]=j.useState(""),[d,u]=j.useState(""),[h,p]=j.useState(""),[k,l]=j.useState(!1),[A,N]=j.useState(!1),[T,_]=j.useState(null),E=async x=>{if(x.preventDefault(),_(null),d!==h){_({type:"error",message:"New passwords do not match"});return}try{await r.mutateAsync({current_password:i,new_password:d,new_password_confirmation:h}),_({type:"success",message:"Password updated successfully"}),o(""),u(""),p("")}catch(v){_({type:"error",message:v.message||"Failed to update password"})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Change Password"}),e.jsxs("form",{onSubmit:E,className:"bg-white border border-neutral-100 rounded-[2rem] p-6 space-y-5 shadow-sm",children:[T&&e.jsx("div",{className:`p-4 rounded-xl text-xs font-bold ${T.type==="success"?"bg-emerald-50 text-emerald-700":"bg-red-50 text-red-700"}`,children:T.message}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest flex items-center gap-2",children:[e.jsx(Me,{size:12})," Current Password"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:k?"text":"password",value:i,onChange:x=>o(x.target.value),className:"w-full bg-neutral-50 border border-neutral-100 rounded-xl px-4 py-3 text-sm font-bold text-neutral-900 focus:outline-none focus:border-[#830e4c] transition-all",required:!0}),e.jsx("button",{type:"button",onClick:()=>l(!k),className:"absolute right-3 top-1/2 -translate-y-1/2 text-neutral-300",children:k?e.jsx(fs,{size:16}):e.jsx(ot,{size:16})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest flex items-center gap-2",children:[e.jsx(Me,{size:12})," New Password"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:A?"text":"password",value:d,onChange:x=>u(x.target.value),className:"w-full bg-neutral-50 border border-neutral-100 rounded-xl px-4 py-3 text-sm font-bold text-neutral-900 focus:outline-none focus:border-[#830e4c] transition-all",required:!0,minLength:6}),e.jsx("button",{type:"button",onClick:()=>N(!A),className:"absolute right-3 top-1/2 -translate-y-1/2 text-neutral-300",children:A?e.jsx(fs,{size:16}):e.jsx(ot,{size:16})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest flex items-center gap-2",children:[e.jsx(Me,{size:12})," Confirm New Password"]}),e.jsx("input",{type:"password",value:h,onChange:x=>p(x.target.value),className:"w-full bg-neutral-50 border border-neutral-100 rounded-xl px-4 py-3 text-sm font-bold text-neutral-900 focus:outline-none focus:border-[#830e4c] transition-all",required:!0})]}),e.jsx("button",{type:"submit",disabled:r.isPending,className:"w-full bg-[#830e4c] text-white py-4 rounded-xl font-black uppercase tracking-widest text-[10px] shadow-lg active:scale-95 transition-all disabled:opacity-50",children:r.isPending?"Updating...":"Update Password"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Security Options"}),e.jsxs("div",{className:"bg-white border border-neutral-100 rounded-[2rem] p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between opacity-40",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-neutral-100 text-neutral-400 rounded-2xl",children:e.jsx(ni,{size:22})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-black text-neutral-900 tracking-tight",children:"Two-Factor Auth"}),e.jsx("p",{className:"text-[9px] font-black text-neutral-300 uppercase tracking-widest mt-1",children:"Coming Soon"})]})]}),e.jsx(lt,{active:!1,onClick:()=>{}})]}),e.jsx("div",{className:"h-px bg-neutral-50"}),e.jsxs("div",{className:"flex items-center justify-between opacity-40",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-neutral-100 text-neutral-400 rounded-2xl",children:e.jsx(Me,{size:22})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-black text-neutral-900 tracking-tight",children:"Biometric Login"}),e.jsx("p",{className:"text-[9px] font-black text-neutral-300 uppercase tracking-widest mt-1",children:"Coming Soon"})]})]}),e.jsx(lt,{active:!1,onClick:()=>{}})]})]})]})]})},Xa=({forceSettingsTab:r,onSignOut:i,onNavigateToUpload:o})=>{var w,$,ce,he;const[d,u]=j.useState("drops"),[h,p]=j.useState("main"),k=Ye(),{data:l,isLoading:A,refetch:N}=dt(),{data:T=[],isLoading:_}=$i(),E=Ri(),{data:x=[],isLoading:v}=xa(),m=j.useRef(null),[b,P]=j.useState({push:!0}),[y,f]=j.useState(""),[S,U]=j.useState(""),[R,J]=j.useState(""),[Z,ee]=j.useState(""),[re,B]=j.useState(null),[z,L]=j.useState(null),{data:Q=[],isLoading:X}=ga(S),le=E.isPending,me=Fe.useMemo(()=>l?(l.items||l.listings||[]).filter(H=>H.status==="active").slice(0,5).map(H=>{const D=(H.photos||[])[0]||'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="300" height="300"%3E%3Crect fill="%23f3f4f6" width="300" height="300"/%3E%3Ctext fill="%239ca3af" font-family="sans-serif" font-size="16" x="50%25" y="50%25" text-anchor="middle" dy=".3em"%3ENo Image%3C/text%3E%3C/svg%3E';let te="Price not set";return H.price&&(typeof H.price=="string"?te=H.price.includes("")?H.price:`${H.price}`:te=`${parseFloat(H.price).toLocaleString()}`),{id:H.id,name:H.title||"Untitled Item",price:te,image:D,views:H.views_count||0,likes:H.likes_count||0,stars:H.stars_count||0,status:H.status==="active"?"Active":"Sold"}}):[],[l]);j.useEffect(()=>{r&&(u("settings"),p("main"))},[r]),j.useEffect(()=>{l&&h==="edit"&&(f(l.name||l.username||""),U(l.city_id||""),J(l.area_id||""),ee(l.bio||""),B(l.profile_photo||null))},[l,h]);const Ne=()=>{var C;(C=m.current)==null||C.click()},Se=C=>{var F;const H=(F=C.target.files)==null?void 0:F[0];if(H){if(H.size>2*1024*1024){L("Image must be less than 2MB");return}if(!H.type.startsWith("image/")){L("Please select a valid image file");return}const D=new FileReader;D.onloadend=()=>{B(D.result),L(null)},D.onerror=()=>{L("Failed to read image file")},D.readAsDataURL(H)}m.current&&(m.current.value="")},O=[{label:"Deals",value:((l==null?void 0:l.purchases_count)||0)+((l==null?void 0:l.sales_count)||0),icon:St},{label:"Rating",value:l!=null&&l.reviews_avg_rating?Number(l.reviews_avg_rating).toFixed(1):"0.0",icon:Ee},{label:"Drops",value:((w=l==null?void 0:l.listings_count)==null?void 0:w.toString())||(($=l==null?void 0:l.items_count)==null?void 0:$.toString())||"0",icon:je}],K=[{id:"edit",label:"Edit Profile",icon:at,color:"text-[#830e4c]"},{id:"notifications",label:"Notification Settings",icon:qt,color:"text-[#830e4c]"},{id:"payments",label:"Escrow & Payments",icon:As,color:"text-emerald-600"},{id:"security",label:"Security & Password",icon:Qe,color:"text-neutral-900"},{id:"history",label:"Trade History",icon:_t,color:"text-neutral-900"}],ae=async()=>{if(L(null),!y.trim()){L("Display name is required");return}if(!S){L("City is required");return}try{const C={name:y.trim(),city_id:typeof S=="number"?S:parseInt(S),bio:Z||void 0};R&&R!==""&&!isNaN(Number(R))?C.area_id=typeof R=="number"?R:parseInt(R):C.area_id=null,re&&re!==(l==null?void 0:l.profile_photo)&&re.startsWith("data:image/")&&(C.profile_photo=re),await E.mutateAsync(C),p("main")}catch(C){L(C.message||"Failed to update profile. Please try again."),console.error("Update profile error:",C)}},we=()=>{switch(h){case"edit":return e.jsxs("div",{className:"space-y-6",children:[z&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:z}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{ref:m,type:"file",accept:"image/*",onChange:Se,className:"hidden"}),e.jsx("div",{className:"w-28 h-28 rounded-[2.5rem] bg-[#830e4c1a] border-4 border-white shadow-xl overflow-hidden",children:re?e.jsx("img",{src:re,className:"w-full h-full object-cover",alt:"Profile",onError:C=>{const H=C.target;H.src=`https://i.pravatar.cc/300?u=${(l==null?void 0:l.id)||(l==null?void 0:l.email)||"user"}`}}):l!=null&&l.profile_photo?e.jsx("img",{src:l.profile_photo,className:"w-full h-full object-cover",alt:"Profile",onError:C=>{const H=C.target;H.src=`https://i.pravatar.cc/300?u=${l.id||l.email||"user"}`}}):e.jsx("img",{src:`https://i.pravatar.cc/300?u=${(l==null?void 0:l.id)||(l==null?void 0:l.email)||(l==null?void 0:l.username)||"user"}`,className:"w-full h-full object-cover",alt:"Profile"})}),e.jsx("button",{type:"button",className:"absolute -bottom-1 -right-1 bg-[#830e4c] text-white p-2.5 rounded-2xl shadow-lg border border-white active:scale-90 transition-all",onClick:Ne,children:e.jsx(si,{size:16,strokeWidth:2.5})})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-neutral-500 uppercase tracking-widest px-1",children:"Display Name *"}),e.jsx("input",{type:"text",value:y,onChange:C=>f(C.target.value),placeholder:"Your display name",className:"w-full bg-white border border-neutral-200 rounded-[1.5rem] px-6 py-5 text-sm font-black text-neutral-900 focus:outline-none focus:border-[#830e4c] transition-all shadow-sm placeholder:text-neutral-200"}),e.jsx("p",{className:"text-[9px] font-bold text-neutral-400 uppercase tracking-widest px-1",children:"This is how your name appears to others"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-[10px] font-black text-neutral-500 uppercase tracking-widest px-1 flex items-center gap-2",children:[e.jsx(Pe,{size:12}),"City *"]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:S,onChange:C=>U(C.target.value?parseInt(C.target.value):""),disabled:v,className:"w-full bg-white border border-neutral-200 rounded-[1.5rem] px-6 py-5 text-sm font-black text-neutral-900 focus:outline-none focus:border-indigo-600 transition-all shadow-sm appearance-none cursor-pointer disabled:opacity-50",children:[e.jsx("option",{value:"",children:"Select your city"}),x.map(C=>e.jsx("option",{value:C.id,children:C.name},C.id))]}),e.jsx(Ut,{className:"absolute right-6 top-1/2 -translate-y-1/2 text-neutral-300 pointer-events-none",size:18})]}),v&&e.jsx("p",{className:"text-[9px] font-bold text-neutral-400 uppercase tracking-widest px-1",children:"Loading cities..."})]}),S&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-[10px] font-black text-neutral-500 uppercase tracking-widest px-1 flex items-center gap-2",children:[e.jsx(Pe,{size:12}),"Area ",Q.length>0?"(Optional)":""]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:R,onChange:C=>J(C.target.value?parseInt(C.target.value):""),disabled:X||Q.length===0,className:"w-full bg-white border border-neutral-200 rounded-[1.5rem] px-6 py-5 text-sm font-black text-neutral-900 focus:outline-none focus:border-[#830e4c] transition-all shadow-sm appearance-none cursor-pointer disabled:opacity-50",children:[e.jsx("option",{value:"",children:"Select your area (optional)"}),Q.map(C=>e.jsx("option",{value:C.id,children:C.name},C.id))]}),e.jsx(Ut,{className:"absolute right-6 top-1/2 -translate-y-1/2 text-neutral-300 pointer-events-none",size:18})]}),X&&e.jsx("p",{className:"text-[9px] font-bold text-neutral-400 uppercase tracking-widest px-1",children:"Loading areas..."}),!X&&Q.length===0&&S&&e.jsx("p",{className:"text-[9px] font-bold text-neutral-400 uppercase tracking-widest px-1",children:"No areas available for this city"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-neutral-500 uppercase tracking-widest px-1",children:"Bio"}),e.jsx("textarea",{value:Z,onChange:C=>ee(C.target.value),placeholder:"Tell us about yourself...",className:"w-full bg-white border border-neutral-200 rounded-[1.5rem] px-6 py-5 text-sm font-black text-neutral-900 focus:outline-none focus:border-[#830e4c] transition-all shadow-sm resize-none min-h-[120px] placeholder:text-neutral-200"})]}),e.jsx("button",{onClick:ae,disabled:le,className:"w-full bg-[#830e4c] text-white py-6 rounded-[2rem] font-black uppercase tracking-[0.25em] text-[11px] shadow-xl active:scale-95 transition-all flex items-center justify-center gap-3 disabled:opacity-50 disabled:cursor-not-allowed",children:le?"Saving...":"Save Changes"})]});case"notifications":return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-white border border-neutral-100 rounded-[2rem] p-6 space-y-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h4",{className:"text-sm font-black text-neutral-900 uppercase tracking-tight",children:"Push Notifications"}),e.jsx("p",{className:"text-[10px] font-bold text-neutral-400 uppercase tracking-widest mt-1",children:"Chat messages and system alerts"})]}),e.jsx(lt,{active:b.push,onClick:()=>P({...b,push:!b.push})})]})}),e.jsxs("div",{className:"p-5 bg-[#830e4c1a] rounded-3xl border border-[#830e4c33] flex gap-4 items-start",children:[e.jsx(je,{size:18,className:"text-[#830e4c] shrink-0 mt-0.5"}),e.jsx("p",{className:"text-[10px] font-bold text-[#830e4c] uppercase tracking-widest leading-relaxed",children:"Stay updated on the latest drops in your area by enabling location-based alerts in your phone settings."})]})]});case"payments":return e.jsx(ba,{});case"security":return e.jsx(va,{});case"history":return e.jsxs("div",{className:"space-y-4",children:[_?e.jsx("div",{className:"p-12 text-center text-neutral-400 text-[10px] font-black uppercase tracking-widest",children:"Loading history..."}):T.length>0?T.map(C=>{var H,F;return e.jsxs("div",{className:"bg-white border border-neutral-100 rounded-[2.5rem] p-4 flex items-center gap-4 hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl overflow-hidden border border-neutral-100 shrink-0 bg-neutral-50 flex items-center justify-center",children:(H=C.listing)!=null&&H.image?e.jsx("img",{src:C.listing.image,className:"w-full h-full object-cover",alt:C.listing.title}):e.jsx(St,{size:20,className:"text-neutral-200"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:`text-[8px] font-black px-2 py-0.5 rounded-full w-fit mb-1 ${C.type==="SALE"?"bg-[#830e4c1a] text-[#830e4c]":"bg-emerald-50 text-emerald-600"}`,children:C.type}),e.jsx("h4",{className:"text-sm font-black text-neutral-900 tracking-tight uppercase truncate",children:((F=C.listing)==null?void 0:F.title)||"Unknown Item"})]}),e.jsx("span",{className:"text-xs font-black text-neutral-900",children:C.price})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-1.5",children:[e.jsxs("p",{className:"text-[9px] font-bold text-neutral-300 uppercase tracking-widest flex items-center gap-1",children:[e.jsx(ps,{size:10})," ",C.date]}),e.jsxs("span",{className:`text-[9px] font-black uppercase tracking-widest flex items-center gap-1 ${C.status==="COMPLETED"?"text-emerald-600":"text-amber-500"}`,children:[C.status==="COMPLETED"?e.jsx(Ls,{size:10}):e.jsx(ps,{size:10}),C.status]})]})]})]},C.id)}):e.jsxs("div",{className:"py-20 flex flex-col items-center justify-center space-y-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-3xl bg-neutral-50 flex items-center justify-center border border-neutral-100 opacity-50",children:e.jsx(_t,{size:24,className:"text-neutral-300"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h4",{className:"text-sm font-black text-neutral-400 uppercase tracking-widest",children:"No transaction history"}),e.jsx("p",{className:"text-[9px] font-bold text-neutral-300 uppercase tracking-[0.2em] mt-1",children:"Activities will appear here"})]})]}),e.jsxs("button",{className:"w-full py-5 text-[10px] font-black text-neutral-300 uppercase tracking-[0.25em] mt-4 flex items-center justify-center gap-2",children:[e.jsx(_t,{size:14})," Request Transaction Export"]})]});default:return null}};return A&&!l?e.jsxs(V.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:ks,className:"w-full max-w-2xl mx-auto flex flex-col items-center justify-center pb-48 px-4 min-h-[400px]",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-[#830e4c] border-t-transparent rounded-full animate-spin"}),e.jsx("p",{className:"mt-4 text-sm font-black text-neutral-400 uppercase tracking-widest",children:"Loading profile..."})]}):e.jsx(V.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:ks,className:"w-full max-w-2xl mx-auto flex flex-col pb-48 px-4",children:e.jsx(xe,{mode:"wait",children:h==="main"?e.jsxs(V.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},className:"w-full",children:[e.jsxs("div",{className:"flex flex-col items-center pt-8 pb-10",children:[e.jsxs("div",{className:"relative mb-6",children:[e.jsx("div",{className:"w-28 h-28 rounded-[2.5rem] bg-[#830e4c1a] border-4 border-white shadow-xl overflow-hidden",children:l!=null&&l.profile_photo?e.jsx("img",{src:l.profile_photo,className:"w-full h-full object-cover",alt:"Profile",onError:C=>{const H=C.target;H.src=`https://i.pravatar.cc/300?u=${l.id||l.email||"user"}`}}):e.jsx("img",{src:`https://i.pravatar.cc/300?u=${(l==null?void 0:l.id)||(l==null?void 0:l.email)||(l==null?void 0:l.username)||"user"}`,className:"w-full h-full object-cover",alt:"Profile"})}),e.jsx("button",{onClick:()=>p("edit"),className:"absolute -bottom-1 -right-1 bg-white p-2.5 rounded-2xl shadow-lg border border-neutral-100 text-[#830e4c] active:scale-90 transition-all",children:e.jsx(at,{size:16,strokeWidth:2.5})})]}),e.jsxs("div",{className:"text-center space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("h2",{className:"text-2xl font-black text-neutral-900 tracking-tighter uppercase italic",children:A?"Loading...":(l==null?void 0:l.name)||(l==null?void 0:l.username)||"User"}),(l==null?void 0:l.email_verified_at)&&e.jsx(Is,{size:20,className:"text-[#29B3F0]",fill:"currentColor"})]}),e.jsxs("p",{className:"text-xs font-black text-neutral-400 uppercase tracking-[0.2em] flex items-center justify-center gap-1.5",children:[e.jsx(Pe,{size:12})," ",((ce=l==null?void 0:l.cityLocation)==null?void 0:ce.name)||(l==null?void 0:l.city)||"Location not set"]}),(l==null?void 0:l.bio)&&e.jsx("p",{className:"text-xs font-medium text-neutral-500 mt-2 max-w-xs",children:l.bio})]})]}),e.jsx("div",{className:"grid grid-cols-3 gap-3 mb-8",children:O.map(C=>e.jsxs("div",{className:"bg-white border border-neutral-100 rounded-3xl p-4 flex flex-col items-center text-center",children:[e.jsx(C.icon,{size:18,className:"text-neutral-400 mb-2"}),e.jsx("span",{className:"text-lg font-black text-neutral-900 leading-none",children:C.value}),e.jsx("span",{className:"text-[8px] font-black text-neutral-300 uppercase tracking-widest mt-1.5",children:C.label})]},C.label))}),e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsx("button",{onClick:()=>u("drops"),className:`relative px-8 py-2.5 rounded-full text-xs font-black uppercase tracking-widest transition-all ${d==="drops"?"bg-[#830e4c] text-white shadow-lg":"bg-white text-neutral-400 border border-neutral-100"}`,children:"My Listings"}),e.jsx("button",{onClick:()=>u("settings"),className:`relative px-8 py-2.5 rounded-full text-xs font-black uppercase tracking-widest transition-all ${d==="settings"?"bg-[#830e4c] text-white shadow-lg":"bg-white text-neutral-400 border border-neutral-100"}`,children:"Account"})]}),e.jsx(xe,{mode:"wait",children:d==="drops"?e.jsx(V.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},className:"space-y-3",children:me.length>0?e.jsxs(e.Fragment,{children:[me.map(C=>e.jsxs("div",{onClick:()=>k(`/upload?edit=${C.id}`),className:"bg-white border border-neutral-100 rounded-[2rem] p-3 flex items-center gap-4 group cursor-pointer hover:border-[#830e4c1a] hover:shadow-md transition-all",children:[e.jsx("div",{className:"w-20 h-20 rounded-2xl overflow-hidden border border-neutral-100",children:e.jsx("img",{src:C.image,className:"w-full h-full object-cover",alt:C.name,onError:H=>{const F=H.target;F.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="300" height="300"%3E%3Crect fill="%23f3f4f6" width="300" height="300"/%3E%3Ctext fill="%239ca3af" font-family="sans-serif" font-size="16" x="50%25" y="50%25" text-anchor="middle" dy=".3em"%3ENo Image%3C/text%3E%3C/svg%3E'}})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[e.jsx("span",{className:`text-[8px] font-black uppercase tracking-widest px-2 py-0.5 rounded-full ${C.status==="Active"?"bg-[#830e4c1a] text-[#830e4c]":"bg-neutral-100 text-neutral-400"}`,children:C.status}),e.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[e.jsxs("span",{className:"text-[9px] font-black text-neutral-500 uppercase tracking-widest flex items-center gap-1.5",children:[e.jsx(ot,{size:12,className:"text-neutral-400"})," ",C.views]}),e.jsxs("span",{className:"text-[9px] font-black text-neutral-500 uppercase tracking-widest flex items-center gap-1.5",children:[e.jsx(Ge,{size:12,className:"text-rose-400",fill:C.likes>0?"currentColor":"none"})," ",C.likes]}),e.jsxs("span",{className:"text-[9px] font-black text-neutral-500 uppercase tracking-widest flex items-center gap-1.5",children:[e.jsx(Ee,{size:12,className:"text-amber-400",fill:C.stars>0?"currentColor":"none"})," ",C.stars]})]})]}),e.jsx("h4",{className:"text-sm font-black text-neutral-900 truncate tracking-tight uppercase",children:C.name}),e.jsx("p",{className:"text-xs font-black text-[#830e4c] mt-0.5",children:C.price})]}),e.jsx("button",{className:"p-3 text-neutral-300 group-hover:text-[#830e4c] transition-colors",children:e.jsx(be,{size:22,strokeWidth:3.5})})]},C.id)),e.jsxs("button",{onClick:()=>{o&&o()},className:"w-full py-6 border-2 border-dashed border-neutral-100 rounded-[2rem] flex flex-col items-center justify-center gap-2 text-neutral-300 hover:border-[#830e4c1a] hover:text-[#830e4c] transition-all group",children:[e.jsx(je,{size:24,className:"group-hover:scale-110 transition-transform"}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Post a new drop"})]})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 space-y-4",children:[e.jsx("div",{className:"w-20 h-20 rounded-full bg-neutral-50 flex items-center justify-center border border-neutral-100",children:e.jsx(St,{size:32,className:"text-neutral-300"})}),e.jsxs("div",{className:"text-center space-y-1",children:[e.jsx("h4",{className:"text-base font-black text-neutral-900 uppercase tracking-tighter",children:"No drops yet"}),e.jsx("p",{className:"text-[10px] font-bold text-neutral-400 uppercase tracking-widest",children:"Start sharing your items with the community!"})]}),e.jsxs("button",{onClick:()=>{o&&o()},className:"w-full py-6 border-2 border-dashed border-neutral-100 rounded-[2rem] flex flex-col items-center justify-center gap-2 text-neutral-300 hover:border-[#830e4c1a] hover:text-[#830e4c] transition-all group",children:[e.jsx(je,{size:24,className:"group-hover:scale-110 transition-transform"}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Post a new drop"})]})]})},"drops-list"):e.jsxs(V.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},className:"space-y-2 pb-24",children:[K.map(C=>e.jsxs("button",{onClick:()=>p(C.id),className:"w-full flex items-center justify-between p-4 bg-white border border-neutral-100 rounded-[1.5rem] hover:bg-neutral-50 active:scale-[0.99] transition-all",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-2.5 bg-neutral-50 rounded-xl ${C.color}`,children:e.jsx(C.icon,{size:20,strokeWidth:2.5})}),e.jsx("span",{className:"text-sm font-black text-neutral-900 tracking-tight",children:C.label})]}),e.jsx(be,{size:18,className:"text-neutral-200",strokeWidth:3})]},C.label)),e.jsx("button",{onClick:()=>{i&&i()},className:"w-full flex items-center justify-between p-4 bg-rose-50 border border-rose-100 rounded-[1.5rem] mt-6 hover:bg-rose-100 active:scale-[0.98] transition-all",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2.5 bg-white rounded-xl text-rose-500 shadow-sm",children:e.jsx(ti,{size:20,strokeWidth:2.5})}),e.jsx("span",{className:"text-sm font-black text-rose-600 tracking-tight",children:"Sign Out"})]})})]},"settings-list")})]},"main-profile"):e.jsxs(V.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:-10},className:"w-full",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-8 pt-4",children:[e.jsx("button",{onClick:()=>p("main"),className:"p-3 bg-neutral-100 rounded-2xl text-neutral-900 active:scale-90 transition-all",children:e.jsx(Cs,{size:20,strokeWidth:3})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[9px] font-black text-[#830e4c] uppercase tracking-[0.2em] leading-none mb-1",children:"Account Setting"}),e.jsx("h3",{className:"text-xl font-black text-neutral-900 tracking-tighter uppercase italic",children:((he=K.find(C=>C.id===h))==null?void 0:he.label)||"Settings"})]})]}),e.jsx("div",{className:"pb-32",children:we()})]},"sub-page")})})},Ot=V.div,wa=({product:r,onSwipe:i,isTop:o,index:d,triggerDirection:u,onShowDetail:h})=>{const p=$t(),k=Ye(),l=We(0),A=We(0),N=Ie(l,[-200,200],[-10,10]),T=Ie(l,[-150,0,150],[.5,1,.5]),[_,E]=j.useState(0),x=j.useRef(null),v=j.useRef(null),m=j.useRef(!1),b=Ai(),P=b&&r.userId&&String(b.id)===String(r.userId),y=r.stats||{},f=Fe.useMemo(()=>{if(!r.createdAt)return!1;try{const z=typeof r.createdAt=="string"?r.createdAt.replace(" ","T"):r.createdAt,L=new Date(z).getTime();return isNaN(L)?!1:Date.now()-L<10080*60*1e3}catch{return!1}},[r.createdAt]),S=(y.views||0)>=10,U=(y.stars||0)>=5,R=j.useRef(!1);Fe.useEffect(()=>{if(o)u?(R.current=!0,u==="right"?p.start({x:800,opacity:0,transition:{duration:.2,ease:"easeOut"}}).then(()=>i("right")):u==="left"?p.start({x:-800,opacity:0,transition:{duration:.2,ease:"easeOut"}}).then(()=>i("left")):u==="up"&&p.start({y:-1e3,opacity:0,transition:{duration:.2,ease:"easeOut"}}).then(()=>i("up"))):R.current||p.start({scale:1,x:0,y:0,opacity:1,transition:{type:"spring",stiffness:500,damping:30}});else{const z=Math.min(d*8,16),L=1-Math.min(d*.04,.08);p.start({scale:L,y:z,x:0,opacity:d>2?0:1-d*.15,transition:{type:"spring",stiffness:500,damping:35}})}},[o,d,u,p,i]);const J=(z,L)=>{o&&(v.current={x:L.point.x,y:L.point.y},m.current=!1)},Z=(z,L)=>{if(!o||!v.current)return;const Q=Math.abs(L.point.x-v.current.x),X=Math.abs(L.point.y-v.current.y);if(Q>10&&Q>X*1.3)m.current||(m.current=!0,x.current&&(x.current.style.overflowY="hidden")),l.set(L.offset.x);else if(X>Q)return},ee=(z,L)=>{if(!o)return;if(x.current&&(x.current.style.overflowY="auto",x.current.style.touchAction=""),!m.current){v.current=null,m.current=!1,p.start({x:0,y:0,rotate:0,transition:{type:"spring",stiffness:500,damping:30}});return}const Q=Math.abs(L.offset.x),X=Math.abs(L.velocity.x);Q>100&&L.offset.x>0||X>500&&L.offset.x>0?p.start({x:800,opacity:0,transition:{duration:.2,ease:"easeOut"}}).then(()=>{l.set(0),A.set(0),i("right")}):Q>100&&L.offset.x<0||X>500&&L.offset.x<0?p.start({x:-800,opacity:0,transition:{duration:.2,ease:"easeOut"}}).then(()=>{l.set(0),A.set(0),i("left")}):p.start({x:0,y:0,rotate:0,transition:{type:"spring",stiffness:500,damping:30}}),v.current=null,m.current=!1},re=z=>{z.stopPropagation(),E(L=>(L+1)%r.images.length)},B=z=>{z.stopPropagation(),E(L=>(L-1+r.images.length)%r.images.length)};return e.jsx(Ot,{animate:p,style:{x:l,y:A,rotate:N,opacity:o?T:void 0,zIndex:o?50:50-d,position:"absolute",width:"100%",height:"100%",willChange:"transform"},drag:o?"x":!1,dragElastic:.1,dragConstraints:{left:-300,right:300},dragPropagation:!1,onDragStart:J,onDrag:Z,onDragEnd:ee,className:`${o?"cursor-grab active:cursor-grabbing":"pointer-events-none"}`,children:e.jsxs("div",{className:"relative w-full h-full bg-white rounded-[2.2rem] shadow-[0_10px_30px_rgba(0,0,0,0.08)] overflow-hidden flex flex-col border border-neutral-100/50",children:[e.jsxs("div",{ref:x,className:"flex-1 overflow-y-auto no-scrollbar pb-40",children:[e.jsxs("div",{className:"relative w-full aspect-[4/5] bg-neutral-100 group overflow-hidden",children:[e.jsx("img",{src:r.images[_],className:"w-full h-full object-cover pointer-events-none"},_),e.jsx("div",{className:"absolute top-2 left-4 right-4 flex gap-1 z-20",children:r.images.map((z,L)=>e.jsx("div",{className:`h-1 flex-1 rounded-full transition-all duration-300 ${L===_?"bg-white shadow-[0_1px_2px_rgba(0,0,0,0.2)]":"bg-white/30"}`},L))}),e.jsxs("div",{className:"absolute inset-0 flex z-10",children:[e.jsx("div",{className:"w-1/2 h-full cursor-pointer",onClick:B}),e.jsx("div",{className:"w-1/2 h-full cursor-pointer",onClick:re})]}),e.jsx("div",{className:"absolute inset-x-0 bottom-0 h-1/2 bg-gradient-to-t from-black/80 via-black/20 to-transparent pointer-events-none"}),e.jsxs("div",{className:"absolute top-6 left-6 right-6 flex justify-between items-start pointer-events-none z-20",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[r.vendor.verified&&e.jsx("div",{className:"bg-[#29B3F0] p-1 rounded-full text-white shadow-lg border border-white/20",children:e.jsx(Qe,{size:14,fill:"currentColor"})}),P&&e.jsxs("div",{className:"flex items-center gap-2 bg-black/40 backdrop-blur-md px-3 py-1.5 rounded-full border border-white/20",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ot,{size:12,className:"text-white"}),e.jsx("span",{className:"text-[10px] font-black text-white",children:y.views||0})]}),e.jsx("div",{className:"w-px h-3 bg-white/30"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ge,{size:12,className:"text-white",fill:"currentColor"}),e.jsx("span",{className:"text-[10px] font-black text-white",children:y.likes||0})]}),e.jsx("div",{className:"w-px h-3 bg-white/30"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ee,{size:12,className:"text-white",fill:"currentColor"}),e.jsx("span",{className:"text-[10px] font-black text-white",children:y.super_interest||y.stars||0})]})]})]}),e.jsx("button",{className:"text-white opacity-80 active:scale-90 transition-transform pointer-events-auto",children:e.jsx(ai,{size:24,strokeWidth:3})})]}),e.jsxs("div",{className:"absolute bottom-6 left-6 right-6 pointer-events-none z-20 space-y-3",children:[e.jsx("h2",{className:"text-2xl font-black text-white uppercase italic tracking-tighter leading-tight drop-shadow-[0_4px_8px_rgba(0,0,0,0.6)]",children:r.name}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[f&&e.jsxs("div",{className:"bg-white/95 backdrop-blur-md px-3 py-1.5 rounded-xl border border-white/20 shadow-xl flex items-center gap-2",children:[e.jsx(je,{size:14,className:"text-[#830e4c]",fill:"currentColor"}),e.jsx("span",{className:"text-[10px] font-black text-neutral-900 uppercase tracking-widest italic",children:"New Drop"})]}),S&&e.jsxs("div",{className:"bg-white/95 backdrop-blur-md px-3 py-1.5 rounded-xl border border-white/20 shadow-xl flex items-center gap-2",children:[e.jsx(Wt,{size:14,className:"text-indigo-600",strokeWidth:3}),e.jsx("span",{className:"text-[10px] font-black text-neutral-900 uppercase tracking-widest italic",children:"Most Viewed"})]}),U&&e.jsxs("div",{className:"bg-white/95 backdrop-blur-md px-3 py-1.5 rounded-xl border border-white/20 shadow-xl flex items-center gap-2",children:[e.jsx(Rs,{size:14,className:"text-orange-500",fill:"currentColor"}),e.jsx("span",{className:"text-[10px] font-black text-neutral-900 uppercase tracking-widest italic",children:"Popular"})]})]})]})]}),e.jsxs("div",{className:"p-6 space-y-8",children:[e.jsxs("div",{className:"bg-neutral-50 rounded-3xl p-5 border border-neutral-100 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-[#830e4c1a] flex items-center justify-center text-[#830e4c]",children:e.jsx(je,{size:20,fill:"currentColor"})}),e.jsx("h4",{className:"text-sm font-black text-neutral-900 uppercase tracking-tight",children:"Price Inquiry"})]}),e.jsx("span",{className:"text-xl font-black text-[#830e4c] tracking-tighter",children:r.price})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h5",{className:"text-[10px] font-black text-neutral-300 uppercase tracking-[0.2em]",children:"The Story"}),e.jsx("p",{className:"text-lg font-black text-neutral-900 leading-tight",children:r.description})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h5",{className:"text-[10px] font-black text-neutral-300 uppercase tracking-[0.2em]",children:"Item Gallery"}),e.jsxs("span",{className:"text-[9px] font-black text-neutral-400 uppercase tracking-widest",children:[r.images.length," Photos"]})]}),e.jsx("div",{className:"flex gap-3 overflow-x-auto no-scrollbar pb-2",children:r.images.map((z,L)=>e.jsx("button",{onClick:Q=>{Q.stopPropagation(),E(L)},className:`relative w-28 h-36 rounded-2xl overflow-hidden flex-shrink-0 border-2 transition-all ${L===_?"border-[#830e4c] scale-105 shadow-md":"border-transparent opacity-60"}`,children:e.jsx("img",{src:z,className:"w-full h-full object-cover"})},L))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h5",{className:"text-[10px] font-black text-neutral-300 uppercase tracking-[0.2em]",children:"Category & Style"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:e.jsxs("div",{className:"bg-rose-50 px-4 py-2.5 rounded-full flex items-center gap-2 border border-rose-100",children:[e.jsx(Ee,{size:12,className:"text-[#830e4c]",fill:"currentColor"}),e.jsx("span",{className:"text-[11px] font-black text-[#830e4c] uppercase tracking-widest",children:r.category})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h5",{className:"text-[10px] font-black text-neutral-300 uppercase tracking-[0.2em]",children:"Current location"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Pe,{size:16,className:"text-[#830e4c]"}),e.jsx("p",{className:"text-lg font-black text-neutral-900 tracking-tight",children:r.distance&&r.distance!=="Unknown"&&r.distance!=="UNKNOWN"?`${r.distance} away  ${r.vendor.location}`:r.vendor.location})]})]}),e.jsx("div",{className:"pt-4",children:e.jsxs("button",{onClick:z=>{z.stopPropagation();const L=r.vendor.id||r.userId;L&&k(`/seller/${L}`)},className:"w-full bg-neutral-50 rounded-[4rem] p-4 flex items-center gap-5 border border-neutral-100 shadow-sm transition-all active:scale-[0.98]",children:[e.jsxs("div",{className:"shrink-0 relative",children:[e.jsx("img",{src:r.vendor.avatar,className:"w-16 h-16 rounded-[1.5rem] object-cover shadow-md border-2 border-white"}),e.jsx("div",{className:"absolute -bottom-1 -right-1 bg-[#29B3F0] p-1 rounded-full text-white shadow-lg border border-white",children:e.jsx(Qe,{size:10,fill:"currentColor"})})]}),e.jsxs("div",{className:"flex-1 text-left flex flex-col gap-1",children:[e.jsx("h4",{className:"text-base font-black text-neutral-900 uppercase tracking-tight",children:r.vendor.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ee,{size:14,fill:"#FFD700",className:"text-[#FFD700]"}),e.jsx("span",{className:"text-xs font-black text-neutral-900",children:r.vendor.rating>0?r.vendor.rating.toFixed(1):"0.0"}),e.jsxs("span",{className:"text-[9px] font-black text-neutral-300 uppercase tracking-widest",children:[r.vendor.reviewCount," REVIEWS"]})]})]}),e.jsx(be,{size:20,className:"text-neutral-300 mr-2"})]})})]})]}),e.jsx(Ot,{style:{opacity:Ie(l,[-100,-50],[1,0])},className:"absolute top-24 right-10 border-4 border-rose-500 text-rose-500 font-black text-4xl px-4 py-2 rounded-xl rotate-12 pointer-events-none z-[110]",children:"PASS"}),e.jsx(Ot,{style:{opacity:Ie(l,[50,100],[0,1])},className:"absolute top-24 left-10 border-4 border-emerald-500 text-emerald-500 font-black text-4xl px-4 py-2 rounded-xl -rotate-12 pointer-events-none z-[110]",children:"LIKE"})]})})},Ns=V.div,ya=({onSwipe:r,isTop:i,index:o,onAction:d,triggerDirection:u})=>{const h=$t(),p=We(0),k=We(0),l=Ie(p,[-200,200],[-10,10]),A=Ie(p,[-150,0,150],[.5,1,.5]);Fe.useEffect(()=>{if(i)u?u==="right"?h.start({x:800,opacity:0,transition:{duration:.3}}).then(()=>r("right")):u==="left"?h.start({x:-800,opacity:0,transition:{duration:.3}}).then(()=>r("left")):u==="up"&&h.start({y:-1e3,opacity:0,transition:{duration:.3}}).then(()=>r("up")):h.start({scale:1,x:0,y:0,opacity:1,transition:{type:"spring",stiffness:300,damping:25}});else{const T=Math.min(o*8,16),_=1-Math.min(o*.04,.08);h.start({scale:_,y:T,x:0,opacity:o>2?0:1-o*.15,transition:{type:"spring",stiffness:300,damping:30}})}},[i,o,u,h,r]);const N=(T,_)=>{if(!i)return;const E=Math.abs(_.offset.x);Math.abs(_.offset.y);const x=Math.abs(_.velocity.x),v=Math.abs(_.velocity.y);if(E>100||x>500){const m=_.offset.x>0?"right":"left";h.start({x:_.offset.x>0?800:-800,opacity:0,transition:{duration:.3}}).then(()=>r(m))}else _.offset.y<-150||v>500?h.start({y:-1e3,opacity:0,transition:{duration:.3}}).then(()=>r("up")):h.start({x:0,y:0,rotate:0,transition:{type:"spring",stiffness:300,damping:25}})};return e.jsx(Ns,{animate:h,style:{x:p,y:k,rotate:l,opacity:i?A:void 0,zIndex:i?50:50-o,position:"absolute",width:"100%",height:"100%",willChange:"transform"},drag:i?"x":!1,dragElastic:.2,dragConstraints:{left:-300,right:300},onDragEnd:N,className:`touch-pan-y ${i?"cursor-grab active:cursor-grabbing":"pointer-events-none"}`,children:e.jsxs("div",{className:"relative w-full h-full bg-[#830e4c] rounded-[2.2rem] shadow-[0_20px_50px_rgba(131,14,76,0.3)] overflow-hidden flex flex-col border border-white/10",children:[e.jsx("div",{className:"absolute top-[-10%] right-[-10%] w-64 h-64 bg-white/10 rounded-full blur-3xl animate-pulse"}),e.jsx("div",{className:"absolute bottom-[-10%] left-[-10%] w-80 h-80 bg-black/20 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute inset-0 opacity-[0.03] pointer-events-none",style:{backgroundImage:"radial-gradient(circle at 2px 2px, white 1px, transparent 0)",backgroundSize:"24px 24px"}}),e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-8 text-center relative z-10",children:[e.jsxs("div",{className:"relative mb-8",children:[e.jsx(Ns,{initial:{scale:.8,rotate:-10},animate:{scale:1,rotate:0},transition:{type:"spring",repeat:1/0,repeatType:"reverse",duration:2},className:"w-24 h-24 bg-white rounded-[2.5rem] flex items-center justify-center shadow-2xl border-4 border-[#830e4c]/20",children:e.jsx(oi,{size:48,className:"text-[#830e4c]",strokeWidth:1.5})}),e.jsx("div",{className:"absolute -top-1 -right-1 bg-emerald-500 text-white p-2 rounded-xl shadow-lg z-20",children:e.jsx(Wt,{size:16,strokeWidth:3})})]}),e.jsxs("div",{className:"space-y-6 max-w-[300px]",children:[e.jsxs("h2",{className:"text-[2.8rem] font-black text-white uppercase italic tracking-tighter leading-[0.85]",children:["Own a ",e.jsx("br",{})," BUSINESS?"]}),e.jsxs("p",{className:"text-[12px] font-black text-white uppercase tracking-[0.15em] leading-relaxed max-w-[240px] mx-auto",children:["REACH THOUSANDS OF LOCAL BUYERS ",e.jsx("br",{})," IN YOUR COMMUNITY INSTANTLY."]})]}),e.jsxs("div",{className:"mt-14 w-full px-2",children:[e.jsxs("button",{onClick:T=>{T.stopPropagation(),d==null||d()},className:"w-full bg-white text-[#830e4c] py-5 rounded-[2rem] font-black uppercase tracking-[0.2em] text-[12px] shadow-2xl active:scale-95 transition-all flex items-center justify-center gap-3",children:["START DROPPING",e.jsx(je,{size:16,fill:"currentColor"})]}),e.jsxs("div",{className:"flex items-center justify-center gap-8 mt-6",children:[e.jsxs("div",{className:"flex items-center gap-2 opacity-80",children:[e.jsx(Je,{size:14,className:"text-white"}),e.jsx("span",{className:"text-[9px] font-black text-white uppercase tracking-widest",children:"FREE LISTING"})]}),e.jsxs("div",{className:"flex items-center gap-2 opacity-80",children:[e.jsx(Ts,{size:14,className:"text-white"}),e.jsx("span",{className:"text-[9px] font-black text-white uppercase tracking-widest",children:"VERIFIED TAGS"})]})]})]})]}),e.jsxs("div",{className:"bg-black/10 backdrop-blur-sm py-4 px-8 flex items-center justify-between border-t border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 bg-white/10 rounded-lg flex items-center justify-center",children:e.jsx(je,{size:12,className:"text-white",fill:"currentColor"})}),e.jsx("span",{className:"text-[9px] font-black text-white/60 uppercase tracking-widest",children:"Nyem For Business"})]}),e.jsx(ci,{size:16,className:"text-white/20"})]})]})})},ja=V.div,ka=({onSwipe:r,isTop:i,index:o,triggerDirection:d})=>{const u=$t(),h=We(0),p=We(0),k=Ie(h,[-200,200],[-10,10]),l=Ie(h,[-150,0,150],[.5,1,.5]);Fe.useEffect(()=>{if(i)d?d==="right"?u.start({x:800,opacity:0,transition:{duration:.3}}).then(()=>r("right")):d==="left"?u.start({x:-800,opacity:0,transition:{duration:.3}}).then(()=>r("left")):d==="up"&&u.start({y:-1e3,opacity:0,transition:{duration:.3}}).then(()=>r("up")):u.start({scale:1,x:0,y:0,opacity:1,transition:{type:"spring",stiffness:300,damping:25}});else{const N=Math.min(o*8,16),T=1-Math.min(o*.04,.08);u.start({scale:T,y:N,x:0,opacity:o>2?0:1-o*.15,transition:{type:"spring",stiffness:300,damping:30}})}},[i,o,d,u,r]);const A=(N,T)=>{i&&(T.offset.x>100?u.start({x:800,opacity:0}).then(()=>r("right")):T.offset.x<-100?u.start({x:-800,opacity:0}).then(()=>r("left")):T.offset.y<-150?u.start({y:-1e3,opacity:0}).then(()=>r("up")):u.start({x:0,y:0,rotate:0}))};return e.jsx(ja,{animate:u,style:{x:h,y:p,rotate:k,opacity:i?l:void 0,zIndex:i?50:50-o,position:"absolute",width:"100%",height:"100%",willChange:"transform"},drag:!!i,dragConstraints:{left:0,right:0,top:0,bottom:0},onDragEnd:A,className:`touch-pan-y ${i?"cursor-grab active:cursor-grabbing":"pointer-events-none"}`,children:e.jsxs("div",{className:"relative w-full h-full bg-white rounded-[2.8rem] shadow-[0_30px_70px_rgba(0,0,0,0.08)] overflow-hidden flex flex-col border border-neutral-100/50",children:[e.jsx("div",{className:"absolute top-[-20%] left-[-20%] w-full h-full bg-[#830e4c]/5 rounded-full blur-[100px] animate-pulse"}),e.jsx("div",{className:"absolute bottom-[-20%] right-[-20%] w-full h-full bg-indigo-500/5 rounded-full blur-[100px]"}),e.jsxs("div",{className:"flex-1 flex flex-col p-7 sm:p-9 relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-3.5 mb-8",children:[e.jsx("div",{className:"w-11 h-11 bg-[#830e4c] rounded-xl flex items-center justify-center text-white shadow-xl shadow-[#830e4c]/20",children:e.jsx(je,{size:22,fill:"currentColor"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h2",{className:"text-2xl font-black text-neutral-900 tracking-tight uppercase italic leading-none",children:"Welcome"}),e.jsx("p",{className:"text-[10px] font-black text-[#830e4c] uppercase tracking-[0.2em] mt-1.5 opacity-80",children:"To Nyem Marketplace"})]})]}),e.jsxs("div",{className:"space-y-8 flex-1",children:[e.jsxs("h1",{className:"text-[38px] font-black text-neutral-900 tracking-tighter uppercase italic leading-[0.85]",children:["Let's get you ",e.jsx("br",{})," ",e.jsx("span",{className:"text-[#830e4c]",children:"Started."})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-7",children:[e.jsx("div",{className:"w-11 h-11 rounded-full bg-rose-50 flex items-center justify-center text-rose-500 shrink-0 border border-rose-100 shadow-sm",children:e.jsx(Be,{size:22,strokeWidth:3})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h4",{className:"text-[13px] font-black text-neutral-900 uppercase tracking-tight",children:"Swipe Left"}),e.jsx("p",{className:"text-[11px] font-bold text-neutral-400 uppercase tracking-[0.1em] mt-0.5",children:"To pass on items you don't like"})]})]}),e.jsxs("div",{className:"flex items-center gap-7",children:[e.jsx("div",{className:"w-11 h-11 rounded-full bg-[#830e4c]/5 flex items-center justify-center text-[#830e4c] shrink-0 border border-[#830e4c]/10 shadow-sm",children:e.jsx(Ge,{size:20,fill:"currentColor",strokeWidth:0})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h4",{className:"text-[13px] font-black text-neutral-900 uppercase tracking-tight",children:"Swipe Right"}),e.jsx("p",{className:"text-[11px] font-bold text-neutral-400 uppercase tracking-[0.1em] mt-0.5",children:"LIKE AND SAVE ITEM TO WISHLIST"})]})]}),e.jsxs("div",{className:"flex items-center gap-7",children:[e.jsx("div",{className:"w-11 h-11 rounded-full bg-[#830e4c]/5 flex items-center justify-center text-[#830e4c] shrink-0 border border-[#830e4c]/10 shadow-sm",children:e.jsx(Ee,{size:20,fill:"currentColor",strokeWidth:0})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h4",{className:"text-[13px] font-black text-neutral-900 uppercase tracking-tight",children:"Swipe Up"}),e.jsx("p",{className:"text-[11px] font-bold text-neutral-400 uppercase tracking-[0.1em] mt-0.5",children:"To notify seller immediately"})]})]})]})]}),e.jsx("div",{className:"flex-1"}),e.jsxs("div",{className:"mt-auto space-y-6 pb-12",children:[e.jsxs("div",{className:"bg-neutral-50/80 backdrop-blur-sm rounded-3xl p-5 flex items-center justify-between border border-neutral-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-11 h-11 rounded-full bg-white flex items-center justify-center text-[#830e4c] shadow-md animate-bounce",children:e.jsx(li,{size:20,fill:"currentColor",className:"rotate-[25deg]"})}),e.jsx("span",{className:"text-[11px] font-black text-neutral-400 uppercase tracking-[0.2em]",children:"Try it now"})]}),e.jsxs("div",{className:"flex items-center gap-1.5 text-[#830e4c]",children:[e.jsx(be,{size:20,strokeWidth:4}),e.jsx(be,{size:20,strokeWidth:4,className:"opacity-40"}),e.jsx(be,{size:20,strokeWidth:4,className:"opacity-10"})]})]}),e.jsx("div",{className:"flex items-center justify-between px-2",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Je,{size:13,className:"text-[#830e4c]"}),e.jsx("span",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest italic opacity-80",children:"Happy Discovering"})]})})]})]})]})})},Na=V.div,Sa=({type:r})=>{const i=r==="services",o=i?di:ui;return e.jsxs(Na,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"w-full h-full flex flex-col items-center justify-center text-center p-8 bg-neutral-50 rounded-[2.5rem] border border-neutral-100 shadow-inner",children:[e.jsxs("div",{className:"relative mb-8",children:[e.jsx("div",{className:"w-24 h-24 bg-white rounded-[2rem] flex items-center justify-center shadow-sm border border-neutral-100 relative z-10",children:e.jsx(o,{size:40,className:"text-[#830e4c]",strokeWidth:1.5})}),e.jsx("div",{className:"absolute inset-0 bg-[#830e4c1a] rounded-[2rem] blur-2xl opacity-20 -z-10 scale-125"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-2xl font-black text-neutral-900 tracking-tighter uppercase leading-none",children:i?"Professional Services":"Smart Bartering"}),e.jsx("p",{className:"text-neutral-400 text-[10px] font-black uppercase tracking-widest max-w-[200px] mx-auto leading-relaxed",children:i?"Hire experts or offer your skills. Coming very soon.":"Trade items directly with neighbors. Coming very soon."})]}),e.jsx("div",{className:"mt-10 flex flex-col items-center gap-4",children:e.jsx("span",{className:"px-5 py-2.5 bg-[#830e4c] text-white text-[9px] font-black uppercase tracking-[0.2em] rounded-full shadow-lg shadow-[#830e4c1a]",children:"Stay Tuned"})})]})},_a=({rating:r})=>e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Ee,{size:16,fill:"#FFD700",className:"text-[#FFD700]"}),e.jsx("span",{className:"text-sm font-black text-neutral-900 leading-none",children:r.toFixed(1)})]}),ut=({isOpen:r,onClose:i,title:o,children:d,showBack:u,onBack:h,fullHeight:p})=>e.jsx(xe,{children:r&&e.jsxs(e.Fragment,{children:[e.jsx(V.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[200]",onClick:i}),e.jsxs(V.div,{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:200},className:`fixed bottom-0 left-0 right-0 bg-white rounded-t-[2.5rem] z-[210] p-6 pb-12 shadow-2xl ${p?"h-[92vh]":"max-h-[85vh]"} overflow-y-auto no-scrollbar max-w-[768px] mx-auto`,children:[e.jsx("div",{className:"w-10 h-1 bg-neutral-200 rounded-full mx-auto mb-6"}),e.jsxs("div",{className:"flex justify-between items-center mb-8 px-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[u&&e.jsx("button",{onClick:h,className:"p-2.5 bg-neutral-100 rounded-full text-neutral-900 active:scale-90 transition-all shadow-sm",children:e.jsx(hi,{size:20,strokeWidth:2.5})}),e.jsx("h3",{className:"text-xl font-black text-neutral-900 tracking-tighter uppercase leading-none",children:o})]}),e.jsx("button",{onClick:i,className:"p-2.5 bg-neutral-100 rounded-full text-neutral-400 active:scale-90 transition-all shadow-sm",children:e.jsx(Be,{size:20,strokeWidth:2.5})})]}),e.jsx("div",{className:"px-1 no-scrollbar",children:d})]})]})}),Ca=({product:r,onClose:i,onShare:o,onSellerClick:d,onSendRequest:u,hasValidToken:h,onLogin:p})=>{const[k,l]=j.useState(0);if(!r)return null;const A=r.stats||{},N=r.createdAt?Date.now()-new Date(r.createdAt.replace(" ","T")).getTime()<10080*60*1e3:!1,T=(A.views||0)>=10,_=(A.stars||0)>=5;return e.jsx(ut,{isOpen:!!r,onClose:i,title:"Item Details",fullHeight:!0,children:e.jsxs("div",{className:"flex flex-col gap-6 pb-32 no-scrollbar max-w-[390px] mx-auto",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(V.div,{initial:{opacity:.8},animate:{opacity:1},className:"w-full aspect-square rounded-[2rem] overflow-hidden bg-neutral-100 border border-neutral-100 shadow-sm",children:e.jsx("img",{src:r.images[k],className:"w-full h-full object-cover"})},r.images[k]),e.jsx("div",{className:"flex gap-3 overflow-x-auto no-scrollbar pb-2 px-1",children:r.images.map((E,x)=>e.jsx("button",{onClick:()=>l(x),className:`flex-shrink-0 w-16 h-16 rounded-2xl overflow-hidden border-2 transition-all ${k===x?"border-[#830e4c] scale-105 shadow-md shadow-[#830e4c]/20":"border-transparent opacity-50 hover:opacity-100"}`,children:e.jsx("img",{src:E,className:"w-full h-full object-cover"})},x))})]}),e.jsxs("div",{className:"px-1 space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("span",{className:"text-[10px] font-black text-[#830e4c] uppercase tracking-[0.2em] bg-[#830e4c1a] px-3 py-1.5 rounded-xl border border-[#830e4c33]",children:r.category}),N&&e.jsxs("span",{className:"text-[10px] font-black text-rose-600 uppercase tracking-[0.2em] bg-rose-50 px-3 py-1.5 rounded-xl border border-rose-100 flex items-center gap-1.5",children:[e.jsx(je,{size:10,fill:"currentColor"}),"New Drop"]}),T&&e.jsxs("span",{className:"text-[10px] font-black text-indigo-600 uppercase tracking-[0.2em] bg-indigo-50 px-3 py-1.5 rounded-xl border border-indigo-100 flex items-center gap-1.5",children:[e.jsx(Wt,{size:10,strokeWidth:3}),"Most Viewed"]}),_&&e.jsxs("span",{className:"text-[10px] font-black text-orange-600 uppercase tracking-[0.2em] bg-orange-50 px-3 py-1.5 rounded-xl border border-orange-100 flex items-center gap-1.5",children:[e.jsx(Rs,{size:10,fill:"currentColor"}),"Popular"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-[2.2rem] font-black text-neutral-900 tracking-tighter leading-[0.9] uppercase italic w-full",children:r.name}),e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("span",{className:"text-3xl font-black text-[#830e4c] tracking-tighter",children:r.price}),e.jsx("div",{className:"w-1 h-1 rounded-full bg-neutral-200"}),e.jsx("span",{className:"text-[9px] font-black text-neutral-400 uppercase tracking-widest italic",children:"Negotiable"})]}),e.jsx("button",{onClick:()=>o(r),className:"p-3.5 bg-neutral-900 text-white rounded-2xl active:scale-90 transition-all hover:bg-neutral-800",children:e.jsx(pi,{size:18,strokeWidth:2.5})})]})]})]}),e.jsx("div",{className:"h-px bg-neutral-100 w-full"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-[10px] font-black text-neutral-300 uppercase tracking-[0.25em]",children:"The Description"}),e.jsx("p",{className:"text-neutral-600 text-sm font-medium leading-relaxed",children:r.longDescription})]}),e.jsxs("div",{className:"space-y-4 pt-4",children:[e.jsx("h4",{className:"text-[10px] font-black text-neutral-300 uppercase tracking-[0.25em]",children:"Owner of Item"}),e.jsxs("div",{onClick:()=>d(r.vendor),className:"bg-white rounded-[3rem] p-5 flex items-center justify-between shadow-[0_12px_40px_rgba(0,0,0,0.04)] border border-neutral-50 cursor-pointer active:scale-[0.98] transition-all hover:bg-neutral-50 group",children:[e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsxs("div",{className:"relative shrink-0",children:[e.jsx("div",{className:"w-20 h-20 rounded-full overflow-hidden border-[6px] border-white shadow-lg ring-1 ring-neutral-100",children:e.jsx("img",{src:r.vendor.avatar,className:"w-full h-full object-cover"})}),e.jsx("div",{className:"absolute bottom-1 right-1 bg-white p-1 rounded-full shadow-md border border-neutral-100",children:e.jsx("div",{className:"w-3.5 h-3.5 bg-[#29B3F0] rounded-full shadow-inner"})})]}),e.jsxs("div",{className:"flex flex-col gap-2 min-w-0",children:[e.jsx("h4",{className:"text-xl font-black text-neutral-900 uppercase tracking-tighter italic leading-none truncate",children:r.vendor.name}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(_a,{rating:r.vendor.rating}),e.jsxs("div",{className:"flex items-center gap-1 text-neutral-400",children:[e.jsx(Pe,{size:10,strokeWidth:3}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-tight",children:r.distance&&r.distance!=="Unknown"&&r.distance!=="UNKNOWN"?`${r.distance} ${r.vendor.location}`:r.vendor.location})]})]})]})]}),e.jsx("div",{className:"w-14 h-14 bg-neutral-50/50 rounded-[1.5rem] flex items-center justify-center text-neutral-300 group-hover:text-neutral-900 group-hover:bg-white group-hover:shadow-lg transition-all border border-neutral-100/50 shrink-0",children:e.jsx(be,{size:28,strokeWidth:3})})]})]})]}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 p-6 bg-gradient-to-t from-white via-white/95 to-transparent pt-12 z-[250]",children:e.jsxs("button",{onClick:()=>{h?u():p()},className:"w-full max-w-[360px] mx-auto bg-[#830e4c] text-white py-6 rounded-[2.2rem] font-black uppercase text-[11px] tracking-[0.4em] shadow-[0_20px_60px_rgba(131,14,76,0.25)] active:scale-95 transition-all flex items-center justify-center gap-3 italic",children:[e.jsx(fi,{size:18,strokeWidth:3,className:"text-white/60"}),"SEND REQUEST TO SELLER"]})})]})})},Pa=({isOpen:r,onClose:i,likedItems:o,onItemClick:d,onRemove:u})=>e.jsx(ut,{isOpen:r,onClose:i,title:"Your Wishlist",fullHeight:!0,children:e.jsx("div",{className:"space-y-4 pb-10",children:o.length>0?o.map(h=>e.jsxs("div",{className:"flex items-center gap-4 p-3 bg-neutral-50 rounded-2xl border border-neutral-100 group",children:[e.jsx("div",{className:"w-20 h-20 rounded-xl overflow-hidden flex-shrink-0 border border-neutral-200",children:e.jsx("img",{src:h.images[0],className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-0.5",children:[h.isSuper&&e.jsx(je,{size:10,className:"text-[#29B3F0]",fill:"currentColor"}),e.jsx("span",{className:"text-[8px] font-black text-[#830e4c] uppercase tracking-widest",children:h.category})]}),e.jsx("h4",{className:"text-sm font-black text-neutral-900 truncate tracking-tight",children:h.name}),e.jsx("p",{className:"text-xs font-black text-[#830e4c] mt-0.5",children:h.price}),e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsx("button",{onClick:()=>{d(h),i()},className:"text-[9px] font-black uppercase tracking-widest text-neutral-400 hover:text-neutral-900 transition-colors",children:"Details"}),e.jsxs("button",{onClick:()=>u(h.id),className:"text-[9px] font-black uppercase tracking-widest text-rose-500 flex items-center gap-1",children:[e.jsx(_s,{size:10})," Remove"]})]})]}),e.jsx("button",{onClick:()=>{i(),d(h)},className:"p-3 bg-white rounded-xl shadow-sm border border-neutral-100 text-neutral-900 active:scale-90 transition-all",children:e.jsx(Mt,{size:18,strokeWidth:2.5})})]},h.id)):e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center space-y-4",children:[e.jsx("div",{className:"w-20 h-20 bg-neutral-50 rounded-full flex items-center justify-center border border-neutral-100",children:e.jsx(Ge,{size:32,className:"text-neutral-200"})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h4",{className:"text-base font-black text-neutral-900 uppercase tracking-tighter",children:"No items yet"}),e.jsx("p",{className:"text-[10px] font-bold text-neutral-400 uppercase tracking-widest",children:"Swipe right on items you want to buy!"})]})]})})}),Ea=r=>{const i=r.toLowerCase().trim(),o={all:Ft,accessories:Ee,electronics:mi,fashion:gs,clothing:gs,"home & decor":Lt,home:Lt,decor:Lt,"sports & fitness":At,sports:At,fitness:At,"beauty & care":Je,beauty:Je,care:Je,"toys & games":It,toys:It,games:It,"books & media":Tt,books:Tt,media:Tt,automotive:xs,vehicles:xs,"garden & outdoor":Et,garden:Et,outdoor:Et,"health & wellness":Pt,health:Pt,wellness:Pt,"pet supplies":ms,pets:ms};if(o[i])return o[i];for(const[d,u]of Object.entries(o))if(i.includes(d)||d.includes(i))return u;return Ft},Ta=r=>{switch(r){case"marketplace":return"Shop";case"services":return"Services";case"barter":return"Swap";default:return"Shop"}},Ia=({isOpen:r,onClose:i,activeCategory:o,onCategorySelect:d,activeTab:u})=>{const h=Ta(u),{data:p=[],isLoading:k,error:l}=Hs(h),A=Fe.useMemo(()=>[{id:0,name:"All"},...p],[p]);return e.jsx(ut,{isOpen:r,onClose:i,title:"DISCOVERY FILTER",children:k?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(xi,{size:32,className:"text-[#830e4c] animate-spin mb-4"}),e.jsx("p",{className:"text-sm font-bold text-neutral-400 uppercase tracking-wider",children:"Loading Categories..."})]}):l?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx("p",{className:"text-sm font-bold text-red-500 uppercase tracking-wider mb-2",children:"Failed to load categories"}),e.jsx("p",{className:"text-xs text-neutral-400 text-center",children:"Please try again later"})]}):e.jsx("div",{className:"space-y-2",children:A.map(N=>{const T=Ea(N.name);return e.jsxs("button",{onClick:()=>{d(N.name),i()},className:`w-full flex items-center justify-between p-3.5 rounded-2xl transition-all border-2 active:scale-[0.98] ${o===N.name?"bg-[#830e4c] border-[#830e4c] shadow-md text-white":"bg-white border-neutral-50 hover:border-neutral-100"}`,children:[e.jsxs("div",{className:"flex items-center gap-3.5",children:[e.jsx("div",{className:`w-11 h-11 rounded-xl flex items-center justify-center transition-all ${o===N.name?"bg-white/20 text-white":"bg-neutral-50 text-neutral-400"}`,children:e.jsx(T,{size:20})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h4",{className:`text-base font-black tracking-tight leading-tight uppercase italic ${o===N.name?"text-white":"text-neutral-900"}`,children:N.name}),e.jsx("p",{className:`text-[8px] font-black uppercase tracking-[0.15em] mt-0.5 ${o===N.name?"text-white/70":"text-neutral-300"}`,children:"EXPLORE COLLECTION"})]})]}),e.jsx("div",{className:"flex items-center justify-center",children:o===N.name?e.jsx("div",{className:"w-7 h-7 bg-white rounded-full flex items-center justify-center shadow-sm",children:e.jsx(Ue,{size:14,strokeWidth:4,className:"text-[#830e4c]"})}):e.jsx(be,{size:18,className:"text-neutral-200"})})]},N.id||N.name)})})})},Aa=[{city:"All Locations"},{city:"Abuja"},{city:"Lagos"},{city:"Port Harcourt"},{city:"Enugu"},{city:"Asaba"},{city:"Kano"},{city:"Ibadan"}],La=({isOpen:r,onClose:i,currentCity:o,cities:d,onCitySelect:u})=>e.jsx(ut,{isOpen:r,onClose:i,title:"SELECT CITY",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:()=>{u("All Locations"),i()},className:`w-full flex items-center justify-between p-3.5 rounded-2xl transition-all border-2 active:scale-[0.98] ${o==="All Locations"?"bg-[#830e4c1a] border-[#830e4c] shadow-sm":"bg-white border-neutral-50 hover:border-neutral-100"}`,children:[e.jsxs("div",{className:"flex items-center gap-3.5",children:[e.jsx("div",{className:`w-11 h-11 rounded-xl flex items-center justify-center transition-all ${o==="All Locations"?"bg-[#830e4c] text-white":"bg-neutral-50 text-neutral-400"}`,children:e.jsx(Ft,{size:20})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h4",{className:`text-base font-black tracking-tight leading-tight uppercase italic ${o==="All Locations"?"text-[#830e4c]":"text-neutral-900"}`,children:"All Locations"}),e.jsx("p",{className:"text-[8px] font-black text-neutral-300 uppercase tracking-[0.15em] mt-0.5",children:"NATIONWIDE COVERAGE"})]})]}),e.jsx("div",{className:"flex items-center justify-center",children:o==="All Locations"?e.jsx("div",{className:"w-7 h-7 bg-[#830e4c] rounded-full flex items-center justify-center shadow-sm",children:e.jsx(Ue,{size:14,strokeWidth:4,className:"text-white"})}):e.jsx(be,{size:18,className:"text-neutral-200"})})]},"all"),d&&d.length>0?d.map(h=>e.jsxs("button",{onClick:()=>{u(h.name),i()},className:`w-full flex items-center justify-between p-3.5 rounded-2xl transition-all border-2 active:scale-[0.98] ${o===h.name?"bg-[#830e4c1a] border-[#830e4c] shadow-sm":"bg-white border-neutral-50 hover:border-neutral-100"}`,children:[e.jsxs("div",{className:"flex items-center gap-3.5",children:[e.jsx("div",{className:`w-11 h-11 rounded-xl flex items-center justify-center transition-all ${o===h.name?"bg-[#830e4c] text-white":"bg-neutral-50 text-neutral-400"}`,children:e.jsx(Pe,{size:20})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h4",{className:`text-base font-black tracking-tight leading-tight uppercase italic ${o===h.name?"text-[#830e4c]":"text-neutral-900"}`,children:h.name}),e.jsx("p",{className:"text-[8px] font-black text-neutral-300 uppercase tracking-[0.15em] mt-0.5",children:"CITY-WIDE SEARCH"})]})]}),e.jsx("div",{className:"flex items-center justify-center",children:o===h.name?e.jsx("div",{className:"w-7 h-7 bg-[#830e4c] rounded-full flex items-center justify-center shadow-sm",children:e.jsx(Ue,{size:14,strokeWidth:4,className:"text-white"})}):e.jsx(be,{size:18,className:"text-neutral-200"})})]},h.id)):Aa.filter(h=>h.city!=="All Locations").map(h=>e.jsxs("button",{onClick:()=>{u(h.city),i()},className:`w-full flex items-center justify-between p-3.5 rounded-2xl transition-all border-2 active:scale-[0.98] ${o===h.city?"bg-[#830e4c1a] border-[#830e4c] shadow-sm":"bg-white border-neutral-50 hover:border-neutral-100"}`,children:[e.jsxs("div",{className:"flex items-center gap-3.5",children:[e.jsx("div",{className:`w-11 h-11 rounded-xl flex items-center justify-center transition-all ${o===h.city?"bg-[#830e4c] text-white":"bg-neutral-50 text-neutral-400"}`,children:e.jsx(Pe,{size:20})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h4",{className:`text-base font-black tracking-tight leading-tight uppercase italic ${o===h.city?"text-[#830e4c]":"text-neutral-900"}`,children:h.city}),e.jsx("p",{className:"text-[8px] font-black text-neutral-300 uppercase tracking-[0.15em] mt-0.5",children:"CITY-WIDE SEARCH"})]})]}),e.jsx("div",{className:"flex items-center justify-center",children:o===h.city?e.jsx("div",{className:"w-7 h-7 bg-[#830e4c] rounded-full flex items-center justify-center shadow-sm",children:e.jsx(Ue,{size:14,strokeWidth:4,className:"text-white"})}):e.jsx(be,{size:18,className:"text-neutral-200"})})]},h.city))]})}),Ss=(r,i,o)=>`discover_state_${r}_${i}_${o}`,Ra=(r,i,o)=>{const d=Ss(r,i,o),u=(()=>{try{const f=localStorage.getItem(d);if(f){const S=JSON.parse(f),U=Date.now()-S.timestamp>1440*60*1e3,R=S.filters.activeTab===r&&S.filters.activeCategory===i&&S.filters.currentCity===o;if(!U&&R&&S.items.length>0)return S}}catch(f){console.warn("Failed to restore discover state:",f)}return null})(),[h,p]=j.useState(()=>{if(!(u!=null&&u.items))return[];const f=new Map;return u.items.forEach(S=>f.set(S.id,S)),Array.from(f.values())}),[k,l]=j.useState((u==null?void 0:u.history)||[]),[A,N]=j.useState((u==null?void 0:u.swipeCount)||0),[T,_]=j.useState(0),E=j.useRef({activeTab:r,activeCategory:i,currentCity:o}),x=j.useRef(!!u);j.useEffect(()=>{const f={items:h,history:k,swipeCount:A,timestamp:Date.now(),filters:{activeTab:r,activeCategory:i,currentCity:o}};try{localStorage.setItem(d,JSON.stringify(f))}catch(S){console.warn("Failed to persist discover state:",S)}},[h,k,A,r,i,o,d]),j.useEffect(()=>{const f=E.current;if(f.activeTab!==r||f.activeCategory!==i||f.currentCity!==o){try{const U=Ss(f.activeTab,f.activeCategory,f.currentCity);localStorage.removeItem(U)}catch(U){console.warn("Failed to clear old discover state:",U)}p([]),l([]),N(0),x.current=!1,E.current={activeTab:r,activeCategory:i,currentCity:o}}},[r,i,o]);const{data:v,isLoading:m,refetch:b}=Bi({activeTab:r,activeCategory:i,currentCity:o});j.useEffect(()=>{if(v&&v.length>0&&h.length===0&&!x.current){let f=[...v].reverse();const S=new Map;f.forEach(R=>{S.set(R.id,R)}),f=Array.from(S.values()),localStorage.getItem("has_seen_welcome_card")==="true"||f.push(Mi()),p(f)}},[v,h.length,T]);const P=j.useCallback(()=>{if(k.length===0)return;const f=k[k.length-1];p(S=>[...S,f]),l(S=>S.slice(0,-1))},[k]),y=j.useCallback(f=>{if(f.isAd||f.isWelcome){f.isWelcome&&localStorage.setItem("has_seen_welcome_card","true"),p(U=>U.slice(0,-1));return}const S=A+1;N(S),l(U=>[...U,f]),p(U=>{const R=U.slice(0,-1);return S%3===0&&R.length>0?[...R,Di()]:R})},[A]);return{items:h,setItems:p,history:k,setHistory:l,loadingItems:m,swipeCount:A,setSwipeCount:N,fetchItems:j.useCallback(()=>(x.current=!1,_(f=>f+1),b()),[b]),undoLast:P,removeItem:y}},za=()=>ge({queryKey:["wishlist"],queryFn:()=>ne(G.swipes.wishlist),select:r=>r.items||[],enabled:!!localStorage.getItem("auth_token")}),Oa=()=>{const{data:r=[],refetch:i}=za();return{likedItems:r,fetchWishlist:i,removeFromWishlist:async d=>{}}},Ja=({activeTab:r,activeCategory:i,setActiveCategory:o,currentCity:d,setCurrentCity:u,cities:h,likedItems:p,onWishlistClick:k,onNavigateToUpload:l,hasValidToken:A,onLogin:N,triggerDir:T,setTriggerDir:_,showFilterDialog:E,setShowFilterDialog:x,showLocationDialog:v,setShowLocationDialog:m,showWishlist:b,setShowWishlist:P,onItemsChange:y,onModalStateChange:f})=>{const{items:S,history:U,loadingItems:R,fetchItems:J,undoLast:Z,removeItem:ee}=Ra(r,i,d),{fetchWishlist:re,removeFromWishlist:B}=Oa(),z=Ji(),L=Qi(),Q=j.useRef(new Set),[X,le]=j.useState(null),me=Ye();j.useEffect(()=>{X&&!X.isAd&&!X.isWelcome&&(Q.current.has(X.id)||(z.mutate(X.id),Q.current.add(X.id)))},[X,z]),j.useEffect(()=>{const F=S[S.length-1];if(F&&!F.isAd&&!F.isWelcome&&!Q.current.has(F.id)){const D=setTimeout(()=>{z.mutate(F.id),Q.current.add(F.id)},1500);return()=>clearTimeout(D)}},[S,z]);const[Ne,Se]=j.useState(!1),[O,K]=j.useState(null),ae=j.useRef(new Set),we=Hi();j.useEffect(()=>{y&&y(S,U,Z)},[S,U,Z,y]),j.useEffect(()=>{f&&f(!!X)},[X,f]),j.useEffect(()=>{S.length===0&&J()},[J,S.length]),j.useEffect(()=>{ke()&&re()},[re]);const w=Hr();j.useEffect(()=>{const D=new URLSearchParams(w.search).get("item");D&&(async()=>{try{const ie=S.find(de=>String(de.id)===String(D));if(ie)le(ie);else{const de=await ne(G.items.show(D));if(de&&de.data){const ye=Vs(de.data);le(ye)}}}catch(ie){console.error("Failed to load shared item",ie)}})()},[w.search,S]);const $=S.length-1,ce=j.useCallback(async(F,D)=>{const te=D||S[$];if(!te)return;const ie=()=>{ee(te),_(null)};if(te.isAd||te.isWelcome){ie();return}const de=localStorage.getItem("auth_token")!==null;if(F==="left"){ie();return}if(!de){N(),_(null);return}if(F==="right"||F==="up")try{await we.mutateAsync({target_listing_id:te.id,direction:F==="up"?"up":"right"})}catch(ye){console.error("Failed to send swipe:",ye)}F==="up"&&(K(te),Se(!0),ae.current.has(te.id)||(Wi("Request Sent!",`You've sent a Super Interest for "${te.name}".`,te.images[0]),ae.current.add(te.id)),setTimeout(()=>Se(!1),3500),setTimeout(()=>re(),500)),ie()},[S,$,ee,re,N,_]),he=async(F=null)=>{const D=F||S[$]||X;if(!D)return;!D.isAd&&!D.isWelcome&&L.mutate(D.id);const te=`${window.location.origin}/discover?item=${D.id}`;if(window.focus(),navigator.share)try{await navigator.share({title:D.name,text:`Check out this ${D.name} on Nyem! It's going for ${D.price}.`,url:te});return}catch(ie){if(ie.name==="AbortError")return}try{await navigator.clipboard.writeText(te),alert("Item link copied to clipboard!")}catch{const de=document.createElement("input");document.body.appendChild(de),de.value=te,de.select(),document.execCommand("copy"),document.body.removeChild(de),alert("Item link copied!")}},C=()=>{i==="All"&&d==="All Locations"?J():(o("All"),u("All Locations"))},H=F=>{const D=F.id||F.userId;D&&me(`/seller/${D}`)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center justify-center pt-0 pb-2 shrink-0",children:e.jsxs("div",{className:"flex items-center gap-2 px-4 py-1.5 bg-white rounded-full border border-neutral-100 shadow-sm mb-1",children:[e.jsx(Pe,{size:10,className:"text-[#830e4c]"}),e.jsxs("span",{className:"text-[9px] font-bold text-neutral-400 uppercase tracking-widest",children:["Discovery in ",e.jsx("span",{className:"text-[#830e4c] font-black italic",children:d}),i!=="All"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mx-1 text-neutral-300",children:""}),e.jsx("span",{className:"text-[#830e4c] font-black italic",children:i})]})]})]})}),e.jsx("div",{className:"relative flex-1 w-full mt-1 mb-[2px]",children:e.jsx(xe,{mode:"popLayout",children:r==="marketplace"?R?e.jsxs(V.div,{initial:{opacity:0},animate:{opacity:1},className:"h-full flex flex-col items-center justify-center text-center px-8",children:[e.jsx("div",{className:"w-20 h-20 bg-neutral-50 rounded-full flex items-center justify-center mb-6 border border-neutral-100 shadow-inner animate-pulse",children:e.jsx(gi,{size:32,className:"text-[#830e4c]"})}),e.jsx("h3",{className:"text-xl font-black text-neutral-900 uppercase tracking-tighter",children:"Loading drops..."}),e.jsx("p",{className:"text-[10px] font-bold text-neutral-400 uppercase tracking-[0.2em] mt-2",children:"Discovering amazing items"})]}):S.length>0?S.slice(-4).map((F,D,te)=>{const ie=te.length-1;return F.isWelcome?e.jsx(ka,{index:ie-D,isTop:D===ie,onSwipe:ce,triggerDirection:D===ie?T:null},F.id):F.isAd?e.jsx(ya,{index:ie-D,isTop:D===ie,onSwipe:ce,onAction:l,triggerDirection:D===ie?T:null},F.id):e.jsx(wa,{product:F,index:ie-D,isTop:D===ie,onSwipe:ce,triggerDirection:D===ie?T:null,onShowDetail:de=>{le(de)}},F.id)}):e.jsxs(V.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"h-full flex flex-col items-center justify-center text-center px-8",children:[e.jsx("div",{className:"w-20 h-20 bg-neutral-50 rounded-full flex items-center justify-center mb-6 border border-neutral-100 shadow-inner",children:e.jsx(bi,{size:32,className:"text-neutral-300"})}),e.jsx("h3",{className:"text-xl font-black text-neutral-900 uppercase tracking-tighter",children:"End of the line"}),e.jsx("p",{className:"text-[10px] font-bold text-neutral-400 uppercase tracking-[0.2em] mt-2 mb-8",children:"No more drops to show right now"}),e.jsx("button",{onClick:C,className:"px-10 py-5 bg-[#830e4c] hover:bg-[#830e4c]/90 text-white text-[10px] font-black uppercase tracking-[0.2em] rounded-2xl shadow-xl active:scale-95 transition-all",children:"Refresh Drops"})]}):e.jsx("div",{className:"h-full flex items-center justify-center px-2",children:e.jsx(Sa,{type:r==="services"?"services":"barter"})})})}),e.jsx(Ca,{product:X,onClose:()=>le(null),onShare:he,onSellerClick:H,onSendRequest:()=>{X&&(ce("up",X),le(null))},hasValidToken:A,onLogin:N}),e.jsx(Pa,{isOpen:b,onClose:()=>P(!1),likedItems:p,onItemClick:F=>{P(!1),le(F)},onRemove:B}),e.jsx(Ia,{isOpen:E,onClose:()=>x(!1),activeCategory:i,onCategorySelect:F=>{o(F),x(!1)},activeTab:r}),e.jsx(La,{isOpen:v,onClose:()=>m(!1),currentCity:d,cities:h,onCitySelect:F=>{u(F),m(!1)}}),e.jsx(xe,{children:Ne&&O&&e.jsxs(V.div,{initial:{opacity:0,y:50,x:"-50%",scale:.9},animate:{opacity:1,y:0,x:"-50%",scale:1},exit:{opacity:0,y:40,x:"-50%",scale:.9},className:"fixed bottom-36 left-1/2 -translate-x-1/2 w-[85%] max-w-[340px] bg-[#830e4c] px-5 py-4 rounded-[2.5rem] flex items-center gap-4 z-[200] shadow-[0_25px_60px_-12px_rgba(131,14,76,0.3)] border border-white/10",children:[e.jsx("div",{className:"w-12 h-12 rounded-2xl overflow-hidden shadow-sm flex-shrink-0 border border-white/20",children:e.jsx("img",{src:O.images[0],className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex flex-col flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-1.5",children:[e.jsx("div",{className:"bg-white/20 p-1.5 rounded-full",children:e.jsx(Ee,{size:12,className:"text-white",fill:"currentColor",strokeWidth:0})}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-white/80 leading-none",children:"Super Interest Sent"})]}),e.jsx("span",{className:"text-[11px] font-black uppercase tracking-tight text-white truncate",children:O.name})]})]})})]})};export{Ja as D,G as E,Ka as M,Xa as P,Va as U,Ha as W,Ze as a,Li as b,dt as c,ne as f,ke as g,Ba as r,Wa as s,Vs as t,Oa as u};
